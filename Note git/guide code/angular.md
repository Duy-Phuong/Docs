MUC LUC
https://www.academind.com/learn/javascript/understanding-rxjs/
http://phocode.com/javascript/
https://freetuts.net/template-trong-angular-4-1330.html
xuanthulap.com
https://www.youtube.com/channel/UCSJbGtTlrDami-tDGPUV9-w/playlists
      acdemind.com

C:\Users\phuong\AppData\Local\Programs\Python\Python37\python.exe D:/Source/Source_All/python/Test/readfile.py
======== name dir ========

---
- [Angular 8 (formerly Angular 2) - The Complete Guide](#angular-8-formerly-angular-2---the-complete-guide)
  - [1. Getting Started](#1-getting-started)
    - [1. Course Introduction](#1-course-introduction)
    - [2. What is Angular](#2-what-is-angular)
    - [3. Angular vs Angular 2 vs Angular 8](#3-angular-vs-angular-2-vs-angular-8)
    - [4. CLI Deep Dive & Troubleshooting.html](#4-cli-deep-dive--troubleshootinghtml)
    - [5. Project Setup and First App](#5-project-setup-and-first-app)
    - [6. Editing the First App](#6-editing-the-first-app)
    - [7. The Course Structure](#7-the-course-structure)
    - [9. What is TypeScript](#9-what-is-typescript)
    - [10. A Basic Project Setup using Bootstrap for Styling](#10-a-basic-project-setup-using-bootstrap-for-styling)
    - [11. Where to find the Course Source Code.html](#11-where-to-find-the-course-source-codehtml)
  - [2. The Basics](#2-the-basics)
    - [1. Module Introduction](#1-module-introduction)
    - [2. How an Angular App gets Loaded and Started](#2-how-an-angular-app-gets-loaded-and-started)
    - [4. Creating a New Component](#4-creating-a-new-component)
    - [5. Understanding the Role of AppModule and Component Declaration](#5-understanding-the-role-of-appmodule-and-component-declaration)
    - [6. Using Custom Components](#6-using-custom-components)
    - [7. Creating Components with the CLI & Nesting Components](#7-creating-components-with-the-cli--nesting-components)
    - [8. Working with Component Templates](#8-working-with-component-templates)
    - [9. Working with Component Styles](#9-working-with-component-styles)
    - [10. Fully Understanding the Component Selector](#10-fully-understanding-the-component-selector)
    - [11. Practicing Components.html](#11-practicing-componentshtml)
    - [12. [OPTIONAL] Assignment Solution](#12-optional-assignment-solution)
    - [13. What is Databinding](#13-what-is-databinding)
    - [14. String Interpolation](#14-string-interpolation)
    - [15. Property Binding](#15-property-binding)
    - [16. Property Binding vs String Interpolation](#16-property-binding-vs-string-interpolation)
    - [17. Event Binding](#17-event-binding)
    - [18. Bindable Properties and Events.html](#18-bindable-properties-and-eventshtml)
    - [19. Passing and Using Data with Event Binding](#19-passing-and-using-data-with-event-binding)
    - [20. Important FormsModule is Required for Two-Way-Binding!.html](#20-important-formsmodule-is-required-for-two-way-bindinghtml)
    - [21. Two-Way-Databinding](#21-two-way-databinding)
    - [22. Combining all Forms of Databinding](#22-combining-all-forms-of-databinding)
    - [23. Practicing Databinding.html](#23-practicing-databindinghtml)
    - [24. [OPTIONAL] Assignment Solution](#24-optional-assignment-solution)
    - [25. Understanding Directives](#25-understanding-directives)
    - [26. Using ngIf to Output Data Conditionally](#26-using-ngif-to-output-data-conditionally)
    - [27. Enhancing ngIf with an Else Condition](#27-enhancing-ngif-with-an-else-condition)
    - [28. Styling Elements Dynamically with ngStyle](#28-styling-elements-dynamically-with-ngstyle)
    - [29. Applying CSS Classes Dynamically with ngClass](#29-applying-css-classes-dynamically-with-ngclass)
    - [30. Outputting Lists with ngFor](#30-outputting-lists-with-ngfor)
    - [31. Practicing Directives.html](#31-practicing-directiveshtml)
    - [32. [OPTIONAL] Assignment Solution](#32-optional-assignment-solution)
    - [33. Getting the Index when using ngFor](#33-getting-the-index-when-using-ngfor)
  - [3. Course Project - The Basics](#3-course-project---the-basics)
    - [1. Project Introduction](#1-project-introduction)
    - [2. Planning the App](#2-planning-the-app)
    - [3. Installing Bootstrap Correctly.html](#3-installing-bootstrap-correctlyhtml)
    - [4. Setting up the Application](#4-setting-up-the-application)
    - [5. Creating the Components](#5-creating-the-components)
    - [6. Using the Components](#6-using-the-components)
    - [7. Adding a Navigation Bar](#7-adding-a-navigation-bar)
    - [8. Alternative Non-Collapsable Navigation Bar.html](#8-alternative-non-collapsable-navigation-barhtml)
    - [9. Creating a Recipe Model](#9-creating-a-recipe-model)
    - [10. Adding Content to the Recipes Components](#10-adding-content-to-the-recipes-components)
    - [11. Outputting a List of Recipes with ngFor](#11-outputting-a-list-of-recipes-with-ngfor)
    - [12. Displaying Recipe Details](#12-displaying-recipe-details)
    - [13. Working on the ShoppingListComponent](#13-working-on-the-shoppinglistcomponent)
    - [14. Creating an Ingredient Model](#14-creating-an-ingredient-model)
    - [15. Creating and Outputting the Shopping List](#15-creating-and-outputting-the-shopping-list)
    - [16. Adding a Shopping List Edit Section](#16-adding-a-shopping-list-edit-section)
    - [17. Wrap Up & Next Steps](#17-wrap-up--next-steps)
  - [4. Debugging](#4-debugging)
    - [1. Understanding Angular Error Messages](#1-understanding-angular-error-messages)
    - [2. Debugging Code in the Browser Using Sourcemaps](#2-debugging-code-in-the-browser-using-sourcemaps)
    - [3. Using Augury to Dive into Angular Apps](#3-using-augury-to-dive-into-angular-apps)
  - [5. Components & Databinding Deep Dive](#5-components--databinding-deep-dive)
    - [1. Module Introduction](#1-module-introduction-1)
    - [2. Splitting Apps into Components](#2-splitting-apps-into-components)
    - [3. Property & Event Binding Overview](#3-property--event-binding-overview)
    - [4. Binding to Custom Properties: @Input](#4-binding-to-custom-properties-input)
    - [5. Assigning an Alias to Custom Properties](#5-assigning-an-alias-to-custom-properties)
    - [6. Binding to Custom Events](#6-binding-to-custom-events)
    - [7. Assigning an Alias to Custom Events](#7-assigning-an-alias-to-custom-events)
    - [8. Custom Property and Event Binding Summary](#8-custom-property-and-event-binding-summary)
    - [9. Understanding View Encapsulation](#9-understanding-view-encapsulation)
    - [10. More on View Encapsulation](#10-more-on-view-encapsulation)
    - [11. Using Local References in Templates](#11-using-local-references-in-templates)
    - [12. @ViewChild() in Angular 8.html](#12-viewchild-in-angular-8html)
    - [13. Getting Access to the Template & DOM with @ViewChild](#13-getting-access-to-the-template--dom-with-viewchild)
    - [14. Projecting Content into Components with ng-content](#14-projecting-content-into-components-with-ng-content)
    - [15. Understanding the Component Lifecycle](#15-understanding-the-component-lifecycle)
    - [16. Seeing Lifecycle Hooks in Action](#16-seeing-lifecycle-hooks-in-action)
    - [17. Lifecycle Hooks and Template Access](#17-lifecycle-hooks-and-template-access)
    - [18. @ContentChild() in Angular 8.html](#18-contentchild-in-angular-8html)
    - [19. Getting Access to ng-content with @ContentChild](#19-getting-access-to-ng-content-with-contentchild)
    - [20. Wrap Up](#20-wrap-up)
    - [21. Practicing Property & Event Binding and View Encapsulation.html](#21-practicing-property--event-binding-and-view-encapsulationhtml)
    - [22. [OPTIONAL] Assignment Solution](#22-optional-assignment-solution)
  - [6. Course Project - Components & Databinding](#6-course-project---components--databinding)
    - [1. Introduction](#1-introduction)
    - [2. Adding Navigation with Event Binding and ngIf](#2-adding-navigation-with-event-binding-and-ngif)
    - [3. Passing Recipe Data with Property Binding](#3-passing-recipe-data-with-property-binding)
    - [4. Passing Data with Event and Property Binding (Combined)](#4-passing-data-with-event-and-property-binding-combined)
    - [5. Make sure you have FormsModule added!.html](#5-make-sure-you-have-formsmodule-addedhtml)
    - [6. Allowing the User to Add Ingredients to the Shopping List](#6-allowing-the-user-to-add-ingredients-to-the-shopping-list)
  - [7. Directives Deep Dive](#7-directives-deep-dive)
    - [1. Module Introduction](#1-module-introduction-2)
    - [2. ngFor and ngIf Recap](#2-ngfor-and-ngif-recap)
    - [3. ngClass and ngStyle Recap](#3-ngclass-and-ngstyle-recap)
    - [4. Creating a Basic Attribute Directive](#4-creating-a-basic-attribute-directive)
    - [5. Using the Renderer to build a Better Attribute Directive](#5-using-the-renderer-to-build-a-better-attribute-directive)
    - [6. More about the Renderer.html](#6-more-about-the-rendererhtml)
    - [7. Using HostListener to Listen to Host Events](#7-using-hostlistener-to-listen-to-host-events)
    - [8. Using HostBinding to Bind to Host Properties](#8-using-hostbinding-to-bind-to-host-properties)
    - [9. Binding to Directive Properties](#9-binding-to-directive-properties)
    - [10. What Happens behind the Scenes on Structural Directives](#10-what-happens-behind-the-scenes-on-structural-directives)
    - [11. Building a Structural Directive](#11-building-a-structural-directive)
    - [12. Understanding ngSwitch](#12-understanding-ngswitch)
  - [8. Course Project - Directives](#8-course-project---directives)
    - [1. Building and Using a Dropdown Directive](#1-building-and-using-a-dropdown-directive)
    - [2. Closing the Dropdown From Anywhere.html](#2-closing-the-dropdown-from-anywherehtml)
  - [9. Using Services & Dependency Injection](#9-using-services--dependency-injection)
    - [1. Module Introduction](#1-module-introduction-3)
    - [2. Why would you Need Services](#2-why-would-you-need-services)
    - [3. Creating a Logging Service](#3-creating-a-logging-service)
    - [4. Injecting the Logging Service into Components](#4-injecting-the-logging-service-into-components)
    - [5. Creating a Data Service](#5-creating-a-data-service)
    - [6. Understanding the Hierarchical Injector](#6-understanding-the-hierarchical-injector)
    - [7. How many Instances of Service Should It Be](#7-how-many-instances-of-service-should-it-be)
    - [8. Injecting Services into Services](#8-injecting-services-into-services)
    - [9. Using Services for Cross-Component Communication](#9-using-services-for-cross-component-communication)
    - [10. Practicing Services.html](#10-practicing-serviceshtml)
    - [11. [OPTIONAL] Assignment Solution](#11-optional-assignment-solution)
    - [12. Services in Angular 6+.html](#12-services-in-angular-6html)
  - [10. Course Project - Services & Dependency Injection](#10-course-project---services--dependency-injection)
    - [1. Introduction](#1-introduction-1)
    - [2. Setting up the Services](#2-setting-up-the-services)
    - [3. Managing Recipes in a Recipe Service](#3-managing-recipes-in-a-recipe-service)
    - [4. Using a Service for Cross-Component Communication](#4-using-a-service-for-cross-component-communication)
    - [5. Adding the Shopping List Service](#5-adding-the-shopping-list-service)
    - [6. Using Services for Pushing Data from A to B](#6-using-services-for-pushing-data-from-a-to-b)
    - [7. Adding Ingredients to Recipes](#7-adding-ingredients-to-recipes)
    - [8. Passing Ingredients from Recipes to the Shopping List (via a Service)](#8-passing-ingredients-from-recipes-to-the-shopping-list-via-a-service)
  - [11. Changing Pages with Routing](#11-changing-pages-with-routing)
    - [1. Module Introduction](#1-module-introduction-4)
    - [3. Understanding the Example Project.html](#3-understanding-the-example-projecthtml)
    - [4. Setting up and Loading Routes](#4-setting-up-and-loading-routes)
    - [5. Navigating with Router Links](#5-navigating-with-router-links)
    - [6. Understanding Navigation Paths](#6-understanding-navigation-paths)
    - [7. Styling Active Router Links](#7-styling-active-router-links)
    - [8. Navigating Programmatically](#8-navigating-programmatically)
    - [9. Using Relative Paths in Programmatic Navigation](#9-using-relative-paths-in-programmatic-navigation)
    - [10. Passing Parameters to Routes](#10-passing-parameters-to-routes)
    - [11. Fetching Route Parameters](#11-fetching-route-parameters)
    - [12. Fetching Route Parameters Reactively](#12-fetching-route-parameters-reactively)
    - [13. An Important Note about Route Observables](#13-an-important-note-about-route-observables)
    - [14. Passing Query Parameters and Fragments](#14-passing-query-parameters-and-fragments)
    - [15. Retrieving Query Parameters and Fragments](#15-retrieving-query-parameters-and-fragments)
    - [16. Practicing and some Common Gotchas](#16-practicing-and-some-common-gotchas)
    - [17. Setting up Child (Nested) Routes](#17-setting-up-child-nested-routes)
    - [18. Using Query Parameters - Practice](#18-using-query-parameters---practice)
    - [19. Configuring the Handling of Query Parameters](#19-configuring-the-handling-of-query-parameters)
    - [20. Redirecting and Wildcard Routes](#20-redirecting-and-wildcard-routes)
    - [21. Important Redirection Path Matching.html](#21-important-redirection-path-matchinghtml)
    - [22. Outsourcing the Route Configuration](#22-outsourcing-the-route-configuration)
    - [23. An Introduction to Guards](#23-an-introduction-to-guards)
    - [24. Protecting Routes with canActivate](#24-protecting-routes-with-canactivate)
    - [25. Protecting Child (Nested) Routes with canActivateChild](#25-protecting-child-nested-routes-with-canactivatechild)
    - [26. Using a Fake Auth Service](#26-using-a-fake-auth-service)
    - [27. Controlling Navigation with canDeactivate](#27-controlling-navigation-with-candeactivate)
    - [28. Passing Static Data to a Route](#28-passing-static-data-to-a-route)
    - [29. Resolving Dynamic Data with the resolve Guard](#29-resolving-dynamic-data-with-the-resolve-guard)
    - [30. Understanding Location Strategies](#30-understanding-location-strategies)
    - [31. Wrap Up](#31-wrap-up)
  - [12. Course Project - Routing](#12-course-project---routing)
    - [1. Planning the General Structure](#1-planning-the-general-structure)
    - [2. Setting Up Routes](#2-setting-up-routes)
    - [3. Adding Navigation to the App](#3-adding-navigation-to-the-app)
    - [4. Marking Active Routes](#4-marking-active-routes)
    - [5. Fixing Page Reload Issues](#5-fixing-page-reload-issues)
    - [6. Child Routes Challenge](#6-child-routes-challenge)
    - [7. Adding Child Routing Together](#7-adding-child-routing-together)
    - [8. Configuring Route Parameters](#8-configuring-route-parameters)
    - [9. Passing Dynamic Parameters to Links](#9-passing-dynamic-parameters-to-links)
    - [10. Styling Active Recipe Items](#10-styling-active-recipe-items)
    - [11. Adding Editing Routes](#11-adding-editing-routes)
    - [12. Retrieving Route Parameters](#12-retrieving-route-parameters)
    - [13. Programmatic Navigation to the Edit Page](#13-programmatic-navigation-to-the-edit-page)
    - [14. One Note about Route Observables](#14-one-note-about-route-observables)
    - [15. Project Cleanup.html](#15-project-cleanuphtml)
  - [13. Understanding Observables](#13-understanding-observables)
    - [1. Module Introduction](#1-module-introduction-5)
    - [10. Useful Resources & Links.html](#10-useful-resources--linkshtml)
    - [2. Analyzing Angular Observables](#2-analyzing-angular-observables)
    - [3. Getting Closer to the Core of Observables](#3-getting-closer-to-the-core-of-observables)
    - [4. Building a Custom Observable](#4-building-a-custom-observable)
    - [5. Errors & Completion](#5-errors--completion)
    - [6. Observables & You!](#6-observables--you)
    - [7. Understanding Operators](#7-understanding-operators)
    - [8. Subjects](#8-subjects)
    - [9. Wrap Up](#9-wrap-up)
  - [14. Course Project - Observables](#14-course-project---observables)
    - [1. Improving the Reactive Service with Observables (Subjects)](#1-improving-the-reactive-service-with-observables-subjects)
    - [2. Changed the Subscription Name.html](#2-changed-the-subscription-namehtml)
  - [15. Handling Forms in Angular Apps](#15-handling-forms-in-angular-apps)
    - [1. Module Introduction](#1-module-introduction-6)
    - [2. Why do we Need Angular's Help](#2-why-do-we-need-angulars-help)
    - [3. Template-Driven (TD) vs Reactive Approach](#3-template-driven-td-vs-reactive-approach)
    - [4. An Example Form](#4-an-example-form)
    - [5. TD Creating the Form and Registering the Controls](#5-td-creating-the-form-and-registering-the-controls)
    - [6. TD Submitting and Using the Form](#6-td-submitting-and-using-the-form)
    - [7. TD Understanding Form State](#7-td-understanding-form-state)
    - [8. TD Accessing the Form with @ViewChild](#8-td-accessing-the-form-with-viewchild)
    - [9. TD Adding Validation to check User Input](#9-td-adding-validation-to-check-user-input)
    - [10. Built-in Validators & Using HTML5 Validation.html](#10-built-in-validators--using-html5-validationhtml)
    - [11. TD Using the Form State](#11-td-using-the-form-state)
    - [12. TD Outputting Validation Error Messages](#12-td-outputting-validation-error-messages)
    - [13. TD Set Default Values with ngModel Property Binding](#13-td-set-default-values-with-ngmodel-property-binding)
    - [14. TD Using ngModel with Two-Way-Binding](#14-td-using-ngmodel-with-two-way-binding)
    - [15. TD Grouping Form Controls](#15-td-grouping-form-controls)
    - [16. TD Handling Radio Buttons](#16-td-handling-radio-buttons)
    - [17. TD Setting and Patching Form Values](#17-td-setting-and-patching-form-values)
    - [18. TD Using Form Data](#18-td-using-form-data)
    - [19. TD Resetting Forms](#19-td-resetting-forms)
    - [20. Practicing Template-Driven Forms.html](#20-practicing-template-driven-formshtml)
    - [21. Introduction to the Reactive Approach](#21-introduction-to-the-reactive-approach)
    - [22. Reactive Setup](#22-reactive-setup)
    - [23. Reactive Creating a Form in Code](#23-reactive-creating-a-form-in-code)
    - [24. Reactive Syncing HTML and Form](#24-reactive-syncing-html-and-form)
    - [25. Reactive Submitting the Form](#25-reactive-submitting-the-form)
    - [26. Reactive Adding Validation](#26-reactive-adding-validation)
    - [27. Reactive Getting Access to Controls](#27-reactive-getting-access-to-controls)
    - [28. Reactive Grouping Controls](#28-reactive-grouping-controls)
    - [Fixing a Bug](#fixing-a-bug)
    - [29. Reactive Arrays of Form Controls (FormArray)](#29-reactive-arrays-of-form-controls-formarray)
    - [30. Reactive Creating Custom Validators](#30-reactive-creating-custom-validators)
    - [31. Reactive Using Error Codes](#31-reactive-using-error-codes)
    - [32. Reactive Creating a Custom Async Validator](#32-reactive-creating-a-custom-async-validator)
    - [33. Reactive Reacting to Status or Value Changes](#33-reactive-reacting-to-status-or-value-changes)
    - [34. Reactive Setting and Patching Values](#34-reactive-setting-and-patching-values)
    - [35. Practicing Reactive Forms.html](#35-practicing-reactive-formshtml)
    - [36. [OPTIONAL] Assignment Solution](#36-optional-assignment-solution)
  - [16. Course Project - Forms](#16-course-project---forms)
    - [1. Introduction](#1-introduction-2)
    - [2. TD Adding the Shopping List Form](#2-td-adding-the-shopping-list-form)
    - [3. Adding Validation to the Form](#3-adding-validation-to-the-form)
    - [4. Allowing the Selection of Items in the List](#4-allowing-the-selection-of-items-in-the-list)
    - [5. Loading the Shopping List Items into the Form](#5-loading-the-shopping-list-items-into-the-form)
    - [6. Updating existing Items](#6-updating-existing-items)
    - [7. Resetting the Form](#7-resetting-the-form)
    - [8. Allowing the the User to Clear (Cancel) the Form](#8-allowing-the-the-user-to-clear-cancel-the-form)
    - [9. Allowing the Deletion of Shopping List Items](#9-allowing-the-deletion-of-shopping-list-items)
    - [10. Creating the Template for the (Reactive) Recipe Edit Form](#10-creating-the-template-for-the-reactive-recipe-edit-form)
    - [11. Creating the Form For Editing Recipes](#11-creating-the-form-for-editing-recipes)
    - [12. Syncing HTML with the Form](#12-syncing-html-with-the-form)
    - [13. Adding Ingredient Controls to a Form Array](#13-adding-ingredient-controls-to-a-form-array)
    - [14. Fixing a Bug.html](#14-fixing-a-bughtml)
    - [15. Adding new Ingredient Controls](#15-adding-new-ingredient-controls)
    - [16. Validating User Input](#16-validating-user-input)
    - [17. Submitting the Recipe Edit Form](#17-submitting-the-recipe-edit-form)
    - [18. Adding a Delete and Clear (Cancel) Functionality](#18-adding-a-delete-and-clear-cancel-functionality)
    - [19. Redirecting the User (after Deleting a Recipe)](#19-redirecting-the-user-after-deleting-a-recipe)
    - [20. Adding an Image Preview](#20-adding-an-image-preview)
    - [21. Providing the Recipe Service Correctly](#21-providing-the-recipe-service-correctly)
    - [22. Deleting Ingredients and Some Finishing Touches](#22-deleting-ingredients-and-some-finishing-touches)
    - [23. Deleting all Items in a FormArray.html](#23-deleting-all-items-in-a-formarrayhtml)
  - [17. Using Pipes to Transform Output](#17-using-pipes-to-transform-output)
    - [1. Introduction & Why Pipes are Useful](#1-introduction--why-pipes-are-useful)
    - [2. Using Pipes](#2-using-pipes)
    - [3. Parametrizing Pipes](#3-parametrizing-pipes)
    - [4. Where to learn more about Pipes](#4-where-to-learn-more-about-pipes)
    - [5. Chaining Multiple Pipes](#5-chaining-multiple-pipes)
    - [6. Creating a Custom Pipe](#6-creating-a-custom-pipe)
    - [7. Parametrizing a Custom Pipe](#7-parametrizing-a-custom-pipe)
    - [8. Example Creating a Filter Pipe](#8-example-creating-a-filter-pipe)
    - [9. Pure and Impure Pipes (or How to fix the Filter Pipe)](#9-pure-and-impure-pipes-or-how-to-fix-the-filter-pipe)
    - [10. Understanding the async Pipe](#10-understanding-the-async-pipe)
    - [11. Practicing Pipes.html](#11-practicing-pipeshtml)
  - [18. Making Http Requests](#18-making-http-requests)
    - [1. A New IDE](#1-a-new-ide)
    - [3. How Does Angular Interact With Backends](#3-how-does-angular-interact-with-backends)
    - [3.1 Securing JS Code.html](#31-securing-js-codehtml)
    - [3.2 Building a REST API.html](#32-building-a-rest-apihtml)
    - [4. The Anatomy of a Http Request](#4-the-anatomy-of-a-http-request)
    - [5. Backend (Firebase) Setup](#5-backend-firebase-setup)
    - [6. Sending a POST Request](#6-sending-a-post-request)
    - [7. GETting Data](#7-getting-data)
    - [8. Using RxJS Operators to Transform Response Data](#8-using-rxjs-operators-to-transform-response-data)
    - [9. Using Types with the HttpClient](#9-using-types-with-the-httpclient)
    - [10. Outputting Posts](#10-outputting-posts)
    - [11. Showing a Loading Indicator](#11-showing-a-loading-indicator)
    - [12. Using a Service for Http Requests](#12-using-a-service-for-http-requests)
    - [13. Services & Components Working Together](#13-services--components-working-together)
    - [14. Sending a DELETE Request](#14-sending-a-delete-request)
    - [15. Handling Errors](#15-handling-errors)
    - [16. Using Subjects for Error Handling](#16-using-subjects-for-error-handling)
    - [17. Using the catchError Operator](#17-using-the-catcherror-operator)
    - [18. Error Handling & UX](#18-error-handling--ux)
    - [19. Setting Headers](#19-setting-headers)
    - [20. Adding Query Params](#20-adding-query-params)
    - [21. Observing Different Types of Responses](#21-observing-different-types-of-responses)
    - [22. Changing the Response Body Type](#22-changing-the-response-body-type)
    - [23. Introducing Interceptors](#23-introducing-interceptors)
    - [24. Manipulating Request Objects](#24-manipulating-request-objects)
    - [25. Response Interceptors](#25-response-interceptors)
    - [26. Multiple Interceptors](#26-multiple-interceptors)
    - [27. Wrap Up](#27-wrap-up)
    - [28. Useful Resources & Links.html](#28-useful-resources--linkshtml)
  - [19. Course Project - Http](#19-course-project---http)
    - [1. Module Introduction](#1-module-introduction-7)
    - [2. Backend (Firebase) Setup](#2-backend-firebase-setup)
    - [3. Setting Up the DataStorage Service](#3-setting-up-the-datastorage-service)
    - [4. Storing Recipes](#4-storing-recipes)
    - [5. Fetching Recipes](#5-fetching-recipes)
    - [6. Transforming Response Data](#6-transforming-response-data)
    - [7. Resolving Data Before Loading](#7-resolving-data-before-loading)
    - [8. Fixing a Bug with the Resolver](#8-fixing-a-bug-with-the-resolver)
  - [20. Authentication & Route Protection in Angular](#20-authentication--route-protection-in-angular)
    - [1. Module Introduction](#1-module-introduction-8)
    - [2. How Authentication Works](#2-how-authentication-works)
    - [3. Adding the Auth Page](#3-adding-the-auth-page)
    - [4. Switching Between Auth Modes](#4-switching-between-auth-modes)
    - [5. Handling Form Input](#5-handling-form-input)
    - [6. Preparing the Backend](#6-preparing-the-backend)
    - [7. Make sure you got Recipes in your backend!.html](#7-make-sure-you-got-recipes-in-your-backendhtml)
    - [8. Preparing the Signup Request](#8-preparing-the-signup-request)
    - [9. Sending the Signup Request](#9-sending-the-signup-request)
    - [10. Adding a Loading Spinner & Error Handling Logic](#10-adding-a-loading-spinner--error-handling-logic)
    - [11. Improving Error Handling](#11-improving-error-handling)
    - [12. Sending Login Requests](#12-sending-login-requests)
    - [13. Login Error Handling](#13-login-error-handling)
    - [14. Creating & Storing the User Data](#14-creating--storing-the-user-data)
    - [15. Reflecting the Auth State in the UI](#15-reflecting-the-auth-state-in-the-ui)
    - [16. Adding the Token to Outgoing Requests](#16-adding-the-token-to-outgoing-requests)
    - [17. Attaching the Token with an Interceptor](#17-attaching-the-token-with-an-interceptor)
    - [18. Adding Logout](#18-adding-logout)
    - [19. Adding Auto-Login](#19-adding-auto-login)
    - [20. Adding Auto-Logout](#20-adding-auto-logout)
    - [21. Adding an Auth Guard](#21-adding-an-auth-guard)
    - [22. Wrap Up](#22-wrap-up)
    - [23. Useful Resources & Links.html](#23-useful-resources--linkshtml)
  - [21. Dynamic Components](#21-dynamic-components)
    - [1. Module Introduction](#1-module-introduction-9)
    - [10. Useful Resources & Links.html](#10-useful-resources--linkshtml-1)
    - [2. Adding an Alert Modal Component](#2-adding-an-alert-modal-component)
    - [3. Understanding the Different Approaches](#3-understanding-the-different-approaches)
    - [4. Using ngIf](#4-using-ngif)
    - [5. Preparing Programmatic Creation](#5-preparing-programmatic-creation)
    - [6. Creating a Component Programmatically](#6-creating-a-component-programmatically)
    - [7. Understanding entryComponents](#7-understanding-entrycomponents)
    - [8. Data Binding & Event Binding](#8-data-binding--event-binding)
    - [9. Wrap Up](#9-wrap-up-1)
  - [22. Angular Modules & Optimizing Angular Apps](#22-angular-modules--optimizing-angular-apps)
    - [1. Module Introduction](#1-module-introduction-10)
    - [2. What are Modules](#2-what-are-modules)
    - [3. Analyzing the AppModule](#3-analyzing-the-appmodule)
    - [4. Getting Started with Feature Modules](#4-getting-started-with-feature-modules)
    - [5. Splitting Modules Correctly](#5-splitting-modules-correctly)
    - [6. Adding Routes to Feature Modules](#6-adding-routes-to-feature-modules)
    - [7. Component Declarations](#7-component-declarations)
    - [8. The ShoppingList Feature Module](#8-the-shoppinglist-feature-module)
    - [9. Understanding Shared Modules](#9-understanding-shared-modules)
    - [10. Understanding the Core Module](#10-understanding-the-core-module)
    - [11. Adding an Auth Feature Module](#11-adding-an-auth-feature-module)
    - [12. Understanding Lazy Loading](#12-understanding-lazy-loading)
    - [13. Implementing Lazy Loading](#13-implementing-lazy-loading)
    - [14. Alternative Lazy Loading Syntax.html](#14-alternative-lazy-loading-syntaxhtml)
    - [15. More Lazy Loading](#15-more-lazy-loading)
    - [16. Preloading Lazy-Loaded Code](#16-preloading-lazy-loaded-code)
    - [17. Modules & Services](#17-modules--services)
    - [18. Loading Services Differently](#18-loading-services-differently)
    - [19. Ahead-of-Time Compilation](#19-ahead-of-time-compilation)
    - [21. Useful Resources & Links.html](#21-useful-resources--linkshtml)
  - [23. Deploying an Angular App](#23-deploying-an-angular-app)
    - [1. Module Introduction](#1-module-introduction-11)
    - [2. Deployment Preparation & Steps](#2-deployment-preparation--steps)
    - [3. Using Environment Variables](#3-using-environment-variables)
    - [4. Deployment Example Firebase Hosting](#4-deployment-example-firebase-hosting)
    - [5. Server Routing vs Browser Routing.html](#5-server-routing-vs-browser-routinghtml)
  - [24. Bonus Working with NgRx in our Project](#24-bonus-working-with-ngrx-in-our-project)
    - [1. Module Introduction](#1-module-introduction-12)
    - [10. Multiple Actions](#10-multiple-actions)
    - [11. Preparing Update & Delete Actions](#11-preparing-update--delete-actions)
    - [12. Updating & Deleting Ingredients](#12-updating--deleting-ingredients)
    - [13. Expanding the State](#13-expanding-the-state)
    - [14. Managing More State via NgRx](#14-managing-more-state-via-ngrx)
    - [15. Removing Redundant Component State Management](#15-removing-redundant-component-state-management)
    - [16. First Summary & Clean Up](#16-first-summary--clean-up)
    - [17. One Root State](#17-one-root-state)
    - [18. Setting Up Auth Reducer & Actions](#18-setting-up-auth-reducer--actions)
    - [19. Dispatching Auth Actions](#19-dispatching-auth-actions)
    - [2. What is Application State](#2-what-is-application-state)
    - [20. Auth Finished (For Now...)](#20-auth-finished-for-now)
    - [21. And Important Note on Actions](#21-and-important-note-on-actions)
    - [22. Exploring NgRx Effects](#22-exploring-ngrx-effects)
    - [23. Defining the First Effect](#23-defining-the-first-effect)
    - [24. Effects & Error Handling](#24-effects--error-handling)
    - [25. Login via NgRx Effects](#25-login-via-ngrx-effects)
    - [26. Managing UI State in NgRx](#26-managing-ui-state-in-ngrx)
    - [27. Finishing the Login Effect](#27-finishing-the-login-effect)
    - [28. Preparing Other Auth Actions](#28-preparing-other-auth-actions)
    - [29. Adding Signup](#29-adding-signup)
    - [3. What is NgRx](#3-what-is-ngrx)
    - [30. Further Auth Effects](#30-further-auth-effects)
    - [31. Adding Auto-Login with NgRx](#31-adding-auto-login-with-ngrx)
    - [32. Adding Auto-Logout](#32-adding-auto-logout)
    - [33. Finishing the Auth Effects](#33-finishing-the-auth-effects)
    - [34. Using the Store Devtools](#34-using-the-store-devtools)
    - [35. The Router Store](#35-the-router-store)
    - [36. Getting Started with NgRx for Recipes](#36-getting-started-with-ngrx-for-recipes)
    - [37. Fetching Recipe Detail Data](#37-fetching-recipe-detail-data)
    - [38. Fetching Recipes & Using the Resolver](#38-fetching-recipes--using-the-resolver)
    - [39. Fixing the Auth Redirect](#39-fixing-the-auth-redirect)
    - [4. Getting Started with Reducers](#4-getting-started-with-reducers)
    - [40. Update, Delete and Add Recipes](#40-update-delete-and-add-recipes)
    - [41. Storing Recipes via Effects](#41-storing-recipes-via-effects)
    - [42. Cleanup Work](#42-cleanup-work)
    - [43. Wrap Up](#43-wrap-up)
    - [44. Useful Resources & Links.html](#44-useful-resources--linkshtml)
    - [45. MUST READ The [LEGACY] Lectures.html](#45-must-read-the-legacy-lectureshtml)
    - [46. [LEGACY] Module Introduction](#46-legacy-module-introduction)
    - [47. [LEGACY] Important Angular 6, RxJS 6 and this section!.html](#47-legacy-important-angular-6-rxjs-6-and-this-sectionhtml)
    - [48. [LEGACY] State Challenges](#48-legacy-state-challenges)
    - [49. [LEGACY] Getting Started with Reducers](#49-legacy-getting-started-with-reducers)
    - [5. Adding Logic to the Reducer](#5-adding-logic-to-the-reducer)
    - [50. [LEGACY] Adding Actions](#50-legacy-adding-actions)
    - [51. [LEGACY] Finishing the First Reducer](#51-legacy-finishing-the-first-reducer)
    - [52. [LEGACY] Registering the Application Store](#52-legacy-registering-the-application-store)
    - [53. [LEGACY] Selecting Data from State](#53-legacy-selecting-data-from-state)
    - [54. [LEGACY] Dispatch Actions](#54-legacy-dispatch-actions)
    - [55. [LEGACY] More Actions and Adding Ingredients](#55-legacy-more-actions-and-adding-ingredients)
    - [56. [LEGACY] Dispatching Update and Deleting Shopping List Actions](#56-legacy-dispatching-update-and-deleting-shopping-list-actions)
    - [57. [LEGACY] Expanding App State](#57-legacy-expanding-app-state)
    - [58. [LEGACY] Editing the Shopping-List via NgRx](#58-legacy-editing-the-shopping-list-via-ngrx)
    - [59. [LEGACY] Managing all Relevant State](#59-legacy-managing-all-relevant-state)
    - [6. Understanding & Adding Actions](#6-understanding--adding-actions)
    - [60. [LEGACY] Authentication and Side Effects - Introduction](#60-legacy-authentication-and-side-effects---introduction)
    - [61. [LEGACY] Setting up the Auth Store Files](#61-legacy-setting-up-the-auth-store-files)
    - [62. [LEGACY] The Reducer](#62-legacy-the-reducer)
    - [63. [LEGACY] Adding Reducer Logic & Actions](#63-legacy-adding-reducer-logic--actions)
    - [64. [LEGACY] Adjusting the App Module Setup](#64-legacy-adjusting-the-app-module-setup)
    - [65. [LEGACY] Using Authentication](#65-legacy-using-authentication)
    - [66. [LEGACY] Dispatch Actions](#66-legacy-dispatch-actions)
    - [67. [LEGACY] Getting State Access in Http Interceptor](#67-legacy-getting-state-access-in-http-interceptor)
    - [68. [LEGACY] Handling the Auth Token](#68-legacy-handling-the-auth-token)
    - [69. [LEGACY] Only React to Actions Once via take(1)](#69-legacy-only-react-to-actions-once-via-take1)
    - [7. Setting Up the NgRx Store](#7-setting-up-the-ngrx-store)
    - [70. [LEGACY] A Closer Look at Effects](#70-legacy-a-closer-look-at-effects)
    - [71. [LEGACY] Auth Effects and Actions](#71-legacy-auth-effects-and-actions)
    - [72. [LEGACY] Using NgRx Effects with NgRx = 7.html](#72-legacy-using-ngrx-effects-with-ngrx--7html)
    - [73. [LEGACY] Effects - How they Work](#73-legacy-effects---how-they-work)
    - [74. [LEGACY] Adding Auth Signup](#74-legacy-adding-auth-signup)
    - [75. [LEGACY] Adding Auth Signin](#75-legacy-adding-auth-signin)
    - [76. [LEGACY] Navigation as a Side Effect](#76-legacy-navigation-as-a-side-effect)
    - [77. [LEGACY] Handling Logout via NgRx](#77-legacy-handling-logout-via-ngrx)
    - [78. [LEGACY] Additional Fixes](#78-legacy-additional-fixes)
    - [79. [LEGACY] Redirecting Upon Logout](#79-legacy-redirecting-upon-logout)
    - [8. Selecting State](#8-selecting-state)
    - [80. [LEGACY] What's Next](#80-legacy-whats-next)
    - [81. [LEGACY] The Router Store Package](#81-legacy-the-router-store-package)
    - [82. [LEGACY] Store Devtools](#82-legacy-store-devtools)
    - [83. [LEGACY] Lazy Load and Dynamic Injection](#83-legacy-lazy-load-and-dynamic-injection)
    - [84. [LEGACY] Adding Recipe Actions](#84-legacy-adding-recipe-actions)
    - [85. [LEGACY] Adding Recipe Reducers](#85-legacy-adding-recipe-reducers)
    - [86. [LEGACY] Dispatching and Selecting State](#86-legacy-dispatching-and-selecting-state)
    - [87. [LEGACY] Viewing and Deleting Recipes via NgRx](#87-legacy-viewing-and-deleting-recipes-via-ngrx)
    - [88. [LEGACY] Editing and Updating Recipes via NgRx](#88-legacy-editing-and-updating-recipes-via-ngrx)
    - [89. [LEGACY] Recipes Side Effects - Fetching from Server](#89-legacy-recipes-side-effects---fetching-from-server)
    - [9. Dispatching Actions](#9-dispatching-actions)
    - [90. [LEGACY] Recipes Side Effects - Storing Recipes on Server](#90-legacy-recipes-side-effects---storing-recipes-on-server)
    - [91. [LEGACY] Cleaning Up](#91-legacy-cleaning-up)
    - [92. [LEGACY] Updating to RxJS 6+](#92-legacy-updating-to-rxjs-6)
    - [93. [LEGACY] Wrap Up](#93-legacy-wrap-up)
    - [94. [LEGACY] Useful Resources & Links.html](#94-legacy-useful-resources--linkshtml)
  - [25. Bonus Angular Universal](#25-bonus-angular-universal)
    - [1. Module Introduction](#1-module-introduction-13)
    - [2. Important Official Docs & Starting Project.html](#2-important-official-docs--starting-projecthtml)
    - [3. Getting Started with Angular Universal](#3-getting-started-with-angular-universal)
    - [4. Working on the App Module](#4-working-on-the-app-module)
    - [5. Adding a Server-Side Build Workflow](#5-adding-a-server-side-build-workflow)
    - [6. Adding a NodeJS Server](#6-adding-a-nodejs-server)
    - [7. Pre-Rendering the App on the Server](#7-pre-rendering-the-app-on-the-server)
    - [8. Next Steps](#8-next-steps)
    - [9. Angular Universal Gotchas.html](#9-angular-universal-gotchashtml)
  - [26. Angular Animations](#26-angular-animations)
    - [1. Making Animations Work with Angular 4+.html](#1-making-animations-work-with-angular-4html)
    - [10. Using Keyframes for Animations](#10-using-keyframes-for-animations)
    - [11. Grouping Transitions](#11-grouping-transitions)
    - [12. Using Animation Callbacks](#12-using-animation-callbacks)
    - [2. Introduction](#2-introduction)
    - [3. Setting up the Starting Project](#3-setting-up-the-starting-project)
    - [4. Animations Triggers and State](#4-animations-triggers-and-state)
    - [5. Switching between States](#5-switching-between-states)
    - [6. Transitions](#6-transitions)
    - [7. Advanced Transitions](#7-advanced-transitions)
    - [8. Transition Phases](#8-transition-phases)
    - [9. The void State](#9-the-void-state)
  - [27. Adding Offline Capabilities with Service Workers](#27-adding-offline-capabilities-with-service-workers)
    - [1. Module Introduction](#1-module-introduction-14)
    - [2. Adding Service Workers](#2-adding-service-workers)
    - [3. Caching Assets for Offline Use](#3-caching-assets-for-offline-use)
    - [4. Caching Dynamic Assets & URLs](#4-caching-dynamic-assets--urls)
    - [5. Further Links & Resources.html](#5-further-links--resourceshtml)
  - [28. A Basic Introduction to Unit Testing in Angular Apps](#28-a-basic-introduction-to-unit-testing-in-angular-apps)
    - [1. About this Section.html](#1-about-this-sectionhtml)
    - [10. Isolated vs Non-Isolated Tests](#10-isolated-vs-non-isolated-tests)
    - [11. Further Resources & Where to Go Next.html](#11-further-resources--where-to-go-nexthtml)
    - [2. Introduction](#2-introduction-1)
    - [3. Why Unit Tests](#3-why-unit-tests)
    - [4. Analyzing the Testing Setup (as created by the CLI)](#4-analyzing-the-testing-setup-as-created-by-the-cli)
    - [5. Running Tests (with the CLI)](#5-running-tests-with-the-cli)
    - [6. Adding a Component and some fitting Tests](#6-adding-a-component-and-some-fitting-tests)
    - [7. Testing Dependencies Components and Services](#7-testing-dependencies-components-and-services)
    - [8. Simulating Async Tasks](#8-simulating-async-tasks)
    - [9. Using fakeAsync and tick](#9-using-fakeasync-and-tick)
  - [29. Angular Changes & New Features](#29-angular-changes--new-features)
    - [1. What's New with Angular 8](#1-whats-new-with-angular-8)
    - [2. What's New & How to Update.html](#2-whats-new--how-to-updatehtml)
  - [30. Course Roundup](#30-course-roundup)
    - [1. Course Roundup](#1-course-roundup)
    - [2. Bonus More Content!.html](#2-bonus-more-contenthtml)
  - [31. Custom Project & Workflow Setup](#31-custom-project--workflow-setup)
    - [1. Introduction](#1-introduction-3)
    - [10. Finishing & Using the Development Workflow](#10-finishing--using-the-development-workflow)
    - [11. Setting up a Production Workflow](#11-setting-up-a-production-workflow)
    - [12. Adding Types & Fixing Bugs](#12-adding-types--fixing-bugs)
    - [13. Finishing Touches](#13-finishing-touches)
    - [2. Initializing the Project](#2-initializing-the-project)
    - [3. Setting up the Basic Project Files](#3-setting-up-the-basic-project-files)
    - [4. Installing the Core Dependencies](#4-installing-the-core-dependencies)
    - [5. Filling the Project Files with Some Life](#5-filling-the-project-files-with-some-life)
    - [6. index.html & Polyfills](#6-indexhtml--polyfills)
    - [6. index.html & Polyfills.vtt](#6-indexhtml--polyfillsvtt)
    - [7. Installing Development Dependencies](#7-installing-development-dependencies)
    - [8. Setting up a Development Workflow](#8-setting-up-a-development-workflow)
    - [9. Updating to Angular 6 + Webpack 4.html](#9-updating-to-angular-6--webpack-4html)
  - [32. Bonus TypeScript Introduction (for Angular 2 Usage)](#32-bonus-typescript-introduction-for-angular-2-usage)
    - [1. Introduction](#1-introduction-4)
    - [2. Using Types](#2-using-types)
    - [3. Classes](#3-classes)
    - [4. Interfaces](#4-interfaces)
    - [5. Generics](#5-generics)
    - [6. Wrap up & Modules](#6-wrap-up--modules)
    - [7. Deep dive into TypeScript.html](#7-deep-dive-into-typescripthtml)
---

# Angular 8 (formerly Angular 2) - The Complete Guide
https://www.udemy.com/course/the-complete-guide-to-angular-2/
## 1. Getting Started

### 1. Course Introduction

### 2. What is Angular

- is a javascript framework to create a reactive SPA
- SPA la khi navigate thì chỉ có 1 file HTML, page sẽ không reload lại

### 3. Angular vs Angular 2 vs Angular 8

Angular JS
Angular 2
Angular 8

### 4. CLI Deep Dive & Troubleshooting.html

In the next lecture, we're going to build our first little app!

If the CLI prompts you to **answer some questions** (some versions do that), you can simply hit ENTER for all questions. This will accept the default settings which are fine for this course.

The CLI generates a different welcome screen than you're going to see in my video though. No worries, you'll still be able to follow along without issues! Just make sure to code along so that your code equals mine - Angular itself didn't change a bit :)

Depending on the CLI version you're using, you might also need to add the FormsModule to the imports[] array in your app.module.ts file (add it if you don't see it there). You might not fully understand what that all means but we're going to cover that in this course, no worries.

If you don't have **FormsModule** in imports[] in AppModule , please do add it and also add an import at the top of that file:

```ts
import { FormsModule } from "@angular/forms";
```

---

If you want to dive deeper into the CLI and learn more about its usage, have a look at its official documentation: https://github.com/angular/angular-cli/wiki

You encountered issues during the installation of the CLI or setup of a new Angular project?

A lot of problems are solved by making sure you're using the latest version of NodeJS, npm and the CLI itself.

Updating NodeJS:

Go to nodejs.org and download the latest version - uninstall (all) installed versions on your machine first.

Updating npm:

Run [sudo] npm install -g npm (sudo is only required on Mac/ Linux)

Updating the CLI

```js
[sudo] npm uninstall -g angular-cli @angular/cli

npm cache clean

[sudo] npm install -g @angular/cli

```

Here are some common issues & solutions:

Creation of a new project takes forever (longer than 3 minutes)
That happens on Windows from time to time => Try running the command line as administrator

You get an EADDR error (Address already in use)
You might already have another ng serve process running - make sure to quit that or use

```ts
ng serve --port ANOTHERPORT

```

to serve your project on a new port

My changes are not reflected in the browser (App is not compiling)
Check if the window running ng serve displays an error. If that's not the case, make sure you're using the latest CLI version and try restarting your CLI

### 5. Project Setup and First App

https://angular.io/guide/setup-local
To install the Angular CLI:
https://github.com/angular/angular-cli/wiki

```js
node -v
npm -v
npm install -g typescript
npm install -g @angular/clilatest

```

Generating and serving an Angular project via a development server Create and run a new project:

```js
ng new my-project
cd my-project
ng serve

ng serve --port 3000

```

C:\Users\phuong\AppData\Roaming\npm\node_modules\@angular\cli\bin
C:\Users\phuong\AppData\Roaming\npm
Vào Path thêm rồi restart

```js
npm uninstall -g angular-cli

npm uninstall --save-dev angular-cli

npm cache clean

npm install -g @angular/cli@latest

```

I followed below steps for resolution for this issue in Windows 10:

First make sure you have installed Angular CLI . You can use below to install same.
npm install -g @angular/cli@latest

Make sure that AppData is visible and navigate to path below.
C:\Users\rkota\AppData\Roaming\npm

Same path can be found by running below too:

npm config get prefix

Add the above path i.e. " C:\Users\rkota\AppData\Roaming\npm" in Environment variable PATH and make sure it got added by running path in command prompt.
Close command prompt and now try to run below:
ng --version

you will be able to see CLI version.

---

Component includes: html, css, file ts

```ts
import { Component } from "@angular/core";

@Component({
  selector: "app-root",
  templateUrl: "./app.component.html",
  styleUrls: ["./app.component.css"]
})
export class AppComponent {
  title = "app";
}

// @Component duoc goi la decorator
```

Sau do vao file module.ts them Component moi duoc tao ra:

```ts
import { BrowserModule } from "@angular/platform-browser";
import { NgModule } from "@angular/core";

import { AppComponent } from "./app.component";

@NgModule({
  declarations: [AppComponent],
  imports: [BrowserModule],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule {}
```

### 6. Editing the First App

### 7. The Course Structure

![img](../root/img/2019-11-16-12-15-30.png)

### 9. What is TypeScript

TypeScript is compile to JS

### 10. A Basic Project Setup using Bootstrap for Styling

```ts
Npm install --save bootstrap@3

```

=> install locally
Tại file angular.json sửa lại :

```js
"styles": [
              "node_modules/bootstrap/dist/css/bootstrap.min.css",
              "src/styles.css"
            ],

```

### 11. Where to find the Course Source Code.html

In the next lecture, we set up the course project. For that, we'll install the Bootstrap CSS Framework.
In this course, we use version 3 of the framework, install it via npm install --save bootstrap@3 => The @3 is important!
Additionally, when using a project created with Angular CLI 6+ (check via ng -v ), you'll have an angular.json file instead of an .angular-cli.json file. In that file, you still need to add Bootstrap to the styles[] array as shown in the next video, but the path should be node_modules/bootstrap/dist/css/bootstrap.min.css , NOT ../node_modules/bootstrap/dist/css/bootstrap.min.css . The leading ../ must not be included.
Also see this lecture - I do show the complete setup process there: https://www.udemy.com/the-complete-guide-to-angular-2/learn/v4/t/lecture/6655614/

app.components.html

```html
<div class="container">
  <div class="form-group">
    <label for="usr">Name:</label>
    <input type="text" class="form-control" id="usr" [(ngModel)]="name" />
  </div>
  <div class="form-group">
    <label for="pwd">Password:</label>
    <input type="password" class="form-control" id="pwd" [(ngModel)]="pwd" />
  </div>

  <div class="alert alert-info">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">
      &times;
    </button>
    <strong>{{ name }}</strong>
  </div>
</div>
```

app.component.ts

```ts
import { Component } from "@angular/core";

@Component({
  selector: "app-root",
  templateUrl: "./app.component.html",
  styleUrls: ["./app.component.css"]
})
export class AppComponent {
  name = "first-app-chap1";
  pwd = "123";
}
```

app.module.ts

```ts
import { BrowserModule } from "@angular/platform-browser";
import { NgModule } from "@angular/core";
import { FormsModule } from "@angular/forms";
import { AppComponent } from "./app.component";

@NgModule({
  declarations: [AppComponent],
  imports: [BrowserModule, FormsModule],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule {}
```

**Must inport FormsModule**
angular.json

```js
"styles": [
              "node_modules/bootstrap/dist/css/bootstrap.min.css",
              "src/styles.css"
            ],

```

---

## 2. The Basics

### 1. Module Introduction

Angular is a js framework, change your DOM(‘html’) at runtime
Component: divide your application into many components => chia thành các phần có thể tái SD

### 2. How an Angular App gets Loaded and Started

### 4. Creating a New Component

- Create server folder
- Create server component
  Add decorater @component in typescript class
  **Source**: basics-components.zip
  Add in modules

### 5. Understanding the Role of AppModule and Component Declaration

Angular doesn't scan all class so yout must tell angular component exist in AppModule
Go to declarations to add new **ServerComponent**

```ts
import { BrowserModule } from "@angular/platform-browser";
import { NgModule } from "@angular/core";
import { FormsModule } from "@angular/forms";

import { AppComponent } from "./app.component";
import { ServerComponent } from "./server/server.component";
import { ServersComponent } from "./servers/servers.component";

@NgModule({
  // add new
  declarations: [AppComponent, ServerComponent, ServersComponent],
  imports: [BrowserModule, FormsModule],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule {}
```

### 6. Using Custom Components

declare in html file

### 7. Creating Components with the CLI & Nesting Components

```ts
Ng generate component servers
Ng g c servers
Ng g c servers –-spec false
=> tạo ra k có file test .spec
Ng g c servers/child –-spec false
=> tạo ở trong folder servers
Angular will auto add in app.module.ts
```

### 8. Working with Component Templates

Nếu định nghĩa template trong 1 file thì sử dụng dấu `` nếu viết trên nhiều dòng:

```ts
@Component({
  selector: 'server-root',
  // selector: '[server-root]', là 1 thuộc tính
  // selector: '.server-root', là 1 class

  template: `code in here mutiple lines…`,
  styles: [`code in here…`]
})

```

Change templateUrl => template to write code

```ts
@Component({
  // selector: '[app-servers]',
  // selector: '.app-servers',
  selector: "app-servers",
  template: `
    <app-server></app-server>
    <app-server></app-server>
  `,
  styleUrls: ["./servers.component.css"]
})
export class ServersComponent implements OnInit {
  constructor() {}

  ngOnInit() {}
}
```

### 9. Working with Component Styles

Change styleUrls => styles

```ts
import { Component } from "@angular/core";

@Component({
  selector: "app-root",
  templateUrl: "./app.component.html",
  // styleUrls: ['./app.component.css']
  styles: [
    `
      h3 {
        color: dodgerblue;
      }
    `
  ]
})
export class AppComponent {}
```

### 10. Fully Understanding the Component Selector

```ts
  selector: 'server-root',
  // selector: '[server-root]', là 1 thuộc tính
  // selector: '.server-root', là 1 class

app.component.html
        <!--<div app-servers></div>-->
      <!--<div class="app-servers"></div>-->
```

### 11. Practicing Components.html

### 12. [OPTIONAL] Assignment Solution

### 13. What is Databinding

![](../root/img/2019-11-17-02-20-04.png)

### 14. String Interpolation

server

```html
<p>{{ 'Server' }} with ID {{ serverId }} is {{ getServerStatus() }}</p>
```

server.component.ts

```ts
@Component({
  selector: "app-server",
  templateUrl: "./server.component.html"
})
export class ServerComponent {
  serverId: number = 10;
  serverStatus: string = "offline";

  getServerStatus() {
    return this.serverStatus;
  }
}
```

### 15. Property Binding

use by []
servers.component.html

```html
<button
  class="btn btn-primary"
  [disabled]="!allowNewServer"">Add Server</button>
```

servers.component.ts

```ts
constructor() {
    setTimeout(() => {
      this.allowNewServer = true;
    }, 2000);
  }
```

### 16. Property Binding vs String Interpolation

servers.component.html
Print value of `allowNewServer`

```html
<p [innerText]="allowNewServer"></p>
```

### 17. Event Binding

servers.component.html

```html
<button
  class="btn btn-primary"
  [disabled]="!allowNewServer"
  (click)="onCreateServer()"
>
  Add Server
</button>
```

### 18. Bindable Properties and Events.html

How do you know to which Properties or Events of HTML Elements you may bind? You can basically bind to all Properties and Events - a good idea is to console.log() the element you're interested in to see which properties and events it offers.

Important: For events, you don't bind to onclick but only to click (=> (click)).

The MDN (Mozilla Developer Network) offers nice lists of all properties and events of the element you're interested in. Googling for YOUR_ELEMENT properties or YOUR_ELEMENT events should yield nice results.

### 19. Passing and Using Data with Event Binding

send data with event
servers.component.html

```html
<input /> type="text" class="form-control" (input)="onUpdateServerName($event)">
```

servers.component.ts

```ts
  onUpdateServerName(event: any) {
    console.log(event);
  }
  ---
  onUpdateServerName(event: Event) {
    this.serverName = (<HTMLInputElement>event.target).value;
  }
```

### 20. Important FormsModule is Required for Two-Way-Binding!.html

Important: For Two-Way-Binding (covered in the next lecture) to work, you need to enable the ngModel directive. This is done by adding the FormsModule to the imports[] array in the AppModule.

You then also need to add the import from @angular/forms in the app.module.ts file:

```ts
import { FormsModule } from "@angular/forms";
```

### 21. Two-Way-Databinding

servers.component.ts

```html
<input type="text" class="form-control" [(ngModel)]="serverName" />
<!--<p>{{ serverName }}</p>-->
```

click button => create sever

### 22. Combining all Forms of Databinding

### 23. Practicing Databinding.html

### 24. [OPTIONAL] Assignment Solution

```html
<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <ol>
        <li>
          Add a Input field which updates a property ('username') via
          Two-Way-Binding
        </li>
        <li>
          Output the username property via String Interpolation (in a paragraph
          below the input)
        </li>
        <li>
          Add a button which may only be clicked if the username is NOT an empty
          string
        </li>
        <li>
          Upon clicking the button, the username should be reset to an empty
          string
        </li>
      </ol>
      <hr />
      <label>Username</label>
      <input type="text" class="form-control" [(ngModel)]="username" />
      <p>{{ username }}</p>
      <button
        class="btn btn-primary"
        [disabled]="username === ''"
        (click)="username = ''"
      >
        Reset User
      </button>
    </div>
  </div>
</div>
```

### 25. Understanding Directives

![](../root/img/2019-11-17-10-03-21.png)

### 26. Using ngIf to Output Data Conditionally

basics-final.zip
servers.component.html

```html
<p *ngIf="serverCreated">Server was created, server name is {{ serverName }}</p>
```

servers.component.ts

```ts
onCreateServer() {
    this.serverCreated = true;
    this.serverCreationStatus = 'Server was created! Name is ' + this.serverName;
  }
```

### 27. Enhancing ngIf with an Else Condition

Use local references to mark else **#condition**

```html
<p *ngIf="is_available; else false_condition">Điểu kiện đúng trong thẻ ngIf</p>
<ng-template #false_condition><p>Điều kiện sai trong template</p></ng-template>
```

### 28. Styling Elements Dynamically with ngStyle

Attribute directive
server.component.html

```html
<p
  [ngStyle]="{backgroundColor: getColor()}"
  [ngClass]="{online: serverStatus === 'online'}"
>
  {{ 'Server' }} with ID {{ serverId }} is {{ getServerStatus() }}
</p>

--- can write [ngStyle]="{'font-style': this.canSave}"
```

server.component.ts

```ts
@Component({
  selector: 'app-server',
  templateUrl: './server.component.html',
  // add styles
  styles: [`
    .online {
      color: white;
    }
  `]
})
.....
 constructor() {
    this.serverStatus = Math.random() > 0.5 ? 'online' : 'offline';
  }

  getServerStatus() {
    return this.serverStatus;
  }

  getColor() {
    return this.serverStatus === 'online' ? 'green' : 'red';
  }
```

### 29. Applying CSS Classes Dynamically with ngClass

### 30. Outputting Lists with ngFor

```html
<app-server *ngFor="let server of servers"></app-server>
```

### 31. Practicing Directives.html

### 32. [OPTIONAL] Assignment Solution

```html
<button class="btn btn-primary" (click)="onToggleDetails()">Display Details</button>
      <p *ngIf="showSecret">Secret Password = tuna</p>
      <div
        *ngFor="let logItem of log"
        [ngStyle]="{backgroundColor: logItem >= 5 ? 'blue' : 'transparent'}"
        [ngClass]="{'white-text': logItem >= 5}"
      >{{ logItem }}</div>
    </div>
```

```ts
import { Component } from "@angular/core";

@Component({
  selector: "app-root",
  templateUrl: "./app.component.html",
  styleUrls: ["./app.component.css"]
})
export class AppComponent {
  showSecret = false;
  log = [];

  onToggleDetails() {
    this.showSecret = !this.showSecret;
    this.log.push(this.log.length + 1);
  }
}
```

### 33. Getting the Index when using ngFor

33.1 basics-ngfor-addition.zip

```html
<button class="btn btn-primary" (click)="onToggleDetails()">Display Details</button>
      <p *ngIf="showSecret">Secret Password = tuna</p>
      <div
        *ngFor="let logItem of log; let i = index"
        [ngStyle]="{backgroundColor: i >= 5 ? 'blue' : 'transparent'}"
        [ngClass]="{'white-text': i >= 5}"
      >{{ logItem }}</div>
    </div>
```

## 3. Course Project - The Basics

### 1. Project Introduction

### 2. Planning the App

![](../root/img/2019-11-17-12-27-06.png)

### 3. Installing Bootstrap Correctly.html

In the next lecture, we set up the course project. For that, we'll install the Bootstrap CSS Framework.

In this course, we use version 3 of the framework, install it via npm install --save bootstrap@3 => The @3 is important!

Additionally, when using a project created with Angular CLI 6+ (check via ng -v ), you'll have an angular.json file instead of an .angular-cli.json file. In that file, you still need to add Bootstrap to the styles[] array as shown in the next video, but the path should be node_modules/bootstrap/dist/css/bootstrap.min.css , NOT ../node_modules/bootstrap/dist/css/bootstrap.min.css . The leading ../ must not be included.

Also see this lecture - I do show the complete setup process there: https://www.udemy.com/the-complete-guide-to-angular-2/learn/v4/t/lecture/6655614/

### 4. Setting up the Application

install bs3

### 5. Creating the Components

Create header and Add new Component in modules

```ts
ng g c header --spec false
ng g c recepies --spec false
ng g c recepies/recepie-list --spec false
ng g c shopping-list --spec false
```

Tại file app.component.html:

```html
<app-header></app-header>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <app-recipes></app-recipes>
      <app-shopping-list></app-shopping-list>
    </div>
  </div>
</div>
```

Tại file recipes.component.html;

```html
<div class="row">
  <div class="col-md-5">
    <app-recipe-list></app-recipe-list>
  </div>
  <div class="col-md-7">
    <app-recipe-detail></app-recipe-detail>
  </div>
</div>
```

Tại file recipe-list.component.html :

```html
<div class="row">
  <div class="col-xs-12">
    <button class="btn btn-success">New Recipe</button>
  </div>
</div>
<hr />
<div class="row">
  <div class="col-xs-12">
    <app-recipe-item></app-recipe-item>
  </div>
</div>
```

Tại file shopping-list.component.html

```html
<div class="row">
  <div class="col-xs-10">
    <app-shopping-edit></app-shopping-edit>
    <hr />
    <ul class="list-group"></ul>
  </div>
</div>
```

### 6. Using the Components

### 7. Adding a Navigation Bar

```html
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="#" class="navbar-brand">Recipe Book</a>
    </div>

    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="#">Recipes</a></li>
        <li><a href="#">Shopping List</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" role="button"
            >Manage <span class="caret"></span
          ></a>
          <ul class="dropdown-menu">
            <li><a href="#">Save Data</a></li>
            <li><a href="#">Fetch Data</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
```

### 8. Alternative Non-Collapsable Navigation Bar.html

The way we added it, the Navbar will collapse on smaller screens. Since we didn't implement a Hamburger menu, that means that there's no way of accessing our links on smaller screens.

You can either add such a menu on your own (see below), or you replace collapse navbar-collapse with just navbar-default.

Adding a Hamburger Menu:

Alternatively, if you want to make the navigation bar responsive, please replace these lines in header.component.html:

```html
<div class="navbar-header">
  <a routerLink="/" class="navbar-brand">Recipe Book</a>
</div>
<div class="collapse navbar-collapse"></div>
```

with these lines:

```html

<div class="navbar-header">
    <button
      type="button"
      class="navbar-toggle"
      (click)="collapsed = !collapsed"
    >
      <span class="icon-bar" *ngFor="let iconBar of [1, 2, 3]"></span>
    </button>
    <a routerLink="/" class="navbar-brand">Recipe Book</a>
  </div>
  <div
    class="navbar-collapse"
    [class.collapse]="collapsed"
    (window:resize)="collapsed = true"
  ></div>
</div>
```

and add this line to header.component.ts:

collapsed = true;

### 9. Creating a Recipe Model

```ts
export class Recipe {
  public name: string;
  public description: string;
  public imagePath: string;

  constructor(name: string, desc: string, imagePath: string) {
    this.name = name;
    this.description = desc;
    this.imagePath = imagePath;
  }
}
```

### 10. Adding Content to the Recipes Components

### 11. Outputting a List of Recipes with ngFor

recipe-list.component.ts

```ts
export class RecipeListComponent implements OnInit {
  recipes: Recipe[] = [
    new Recipe(
      "A Test Recipe",
      "This is simply a test",
      "https://upload.wikimedia.org/wikipedia/commons/1/15/Recipe_logo.jpeg"
    ),
    new Recipe(
      "A Test Recipe",
      "This is simply a test",
      "https://upload.wikimedia.org/wikipedia/commons/1/15/Recipe_logo.jpeg"
    )
  ];

  constructor() {}

  ngOnInit() {}
}
```

Tại file recipe-list.component.html sửa lại để đổ data:

```html
<div class="row">
  <div class="col-xs-12">
    <button class="btn btn-success">New Recipe</button>
  </div>
</div>
<hr />
<div class="row">
  <div class="col-xs-12">
    <a href="#" class="list-group-item clearfix" *ngFor="let recipe of recipes">
      <div class="pull-left">
        <h4 class="list-group-item-heading">{{ recipe.name }}</h4>
        <p class="list-group-item-text">{{ recipe.description }}</p>
      </div>
      <span class="pull-right">
        <img
          [src]="recipe.imagePath"
          alt="{{ recipe.name }}"
          class="img-responsive"
          style="max-height: 50px;"
        />
      </span>
    </a>
    <app-recipe-item></app-recipe-item>
  </div>
</div>
```

Can write src="{{recipe.imagePath}}"

### 12. Displaying Recipe Details

recipe-detail.component.html

```html
<div class="row">
  <div class="col-xs-12">
    <img src="" alt="" class="img-responsive" />
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <h1>Recipe Name</h1>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <div class="btn-group">
      <button type="button" class="btn btn-primary dropdown-toggle">
        Manage Recipe <span class="caret"></span>
      </button>
      <ul class="dropdown-menu">
        <li><a href="#">To Shopping List</a></li>
        <li><a href="#">Edit Recipe</a></li>
        <li><a href="#">Delete Recipe</a></li>
      </ul>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    Description
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    Ingredients
  </div>
</div>
```

### 13. Working on the ShoppingListComponent

### 14. Creating an Ingredient Model

```ts
export class Ingredient {
  constructor(public name: string, public amount: number) {}
}
```

Co the viet gon lai ntn thay vi gan value cho prop da khai bao trong typescripts

### 15. Creating and Outputting the Shopping List

### 16. Adding a Shopping List Edit Section

shopping-edit

```html
<div class="row">
  <div class="col-xs-12">
    <form>
      <div class="row">
        <div class="col-sm-5 form-group">
          <label for="name">Name</label>
          <input type="text" id="name" class="form-control" />
        </div>
        <div class="col-sm-2 form-group">
          <label for="amount">Amount</label>
          <input type="number" id="amount" class="form-control" />
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <button class="btn btn-success" type="submit">Add</button>
          <button class="btn btn-danger" type="button">Delete</button>
          <button class="btn btn-primary" type="button">Clear</button>
        </div>
      </div>
    </form>
  </div>
</div>
```

### 17. Wrap Up & Next Steps

## 4. Debugging

### 1. Understanding Angular Error Messages

### 2. Debugging Code in the Browser Using Sourcemaps

Delete the last intem is not work
=> Use chrome
Vao folder webpack/./src

### 3. Using Augury to Dive into Angular Apps

install Augury extensions

## 5. Components & Databinding Deep Dive

### 1. Module Introduction

### 2. Splitting Apps into Components

```ts
ng g c cockpit –-spec false
ng g c server-element –-spec false
```

App tạo server và blue print server(khi hiển thị sẽ in nghiêng và có màu khác): get server được tạo ra bởi cockpit và thêm vào list server ở app component

### 3. Property & Event Binding Overview

![](../root/img/2019-11-18-23-49-15.png)

### 4. Binding to Custom Properties: @Input

Cách bắt dữ liệu từ Component khác
server-element.component.ts

```ts
// alias
@Input('srvElement') element: {type: string, name: string, content: string};
@Input() name: string;
```

app.component.html

```html
<app-server-element
  *ngFor="let serverElement of serverElements"
  [srvElement]="serverElement"
  [name]="serverElement.name"
>
</app-server-element>
```

### 5. Assigning an Alias to Custom Properties

### 6. Binding to Custom Events

How to inform app-component event emitted from cockpit
File app-component.html listen

```html
<app-cockpit
  (serverCreated)="onServerAdded($event)"
  (bpCreated)="onBlueprintAdded($event)"
></app-cockpit>
```

File app-component.ts

```ts
onServerAdded(serverData: {serverName: string, serverContent: string}) {
    this.serverElements.push({
      type: 'server',
      name: serverData.serverName,
      content: serverData.serverContent
    });
  }

  onBlueprintAdded(blueprintData: {serverName: string, serverContent: string}) {
    this.serverElements.push({
      type: 'blueprint',
      name: blueprintData.serverName,
      content: blueprintData.serverContent
    });
  }

```

Tại file cockpit.ts

```ts
@Output() serverCreated = new EventEmitter<{serverName: string, serverContent: string}>();
  @Output('bpCreated') blueprintCreated = new EventEmitter<{serverName: string, serverContent: string}>();

onAddServer() {
    this.serverCreated.emit({
      serverName: this. newServerName,
      serverContent: this.newServerCOntent
    });
  }

  onAddBlueprint() {
    this.blueprintCreated.emit({
      serverName: this. newServerName,
      serverContent: this.newServerCOntent
    });
  }

```

![](../root/img/2019-11-19-00-45-54.png)

### 7. Assigning an Alias to Custom Events

### 8. Custom Property and Event Binding Summary

### 9. Understanding View Encapsulation

app.component.css

```css
.container {
  margin-top: 30px;
}

p {
  color: blue;
}
```

**Only apply for elements of that component**
Shallow DOM is a technology that is not supported by all browsers where each element has own shallow DOM behind it, where you can assign styles to each element and that is the default behavior of view encapsulation in angular

### 10. More on View Encapsulation

serrer-element.ts

```ts
@Component({
  selector: 'app-server-element',
  templateUrl: './server-element.component.html',
  styleUrls: ['./server-element.component.css'],
  // add new
  encapsulation: ViewEncapsulation.Emulated // None, Native
})
export class ServerElementComponent
```

- Emulated là default nên bạn không cần add
- None có nghĩ là không sử dụng View encapsulation => effect all similar tag
- Native cũng như emaulated…

### 11. Using Local References in Templates

có thể sử dụng reference chỉ trong template
cockpit.component.html

```html
<div class="row">
  <div class="col-xs-12">
    <p>Add new Servers or blueprints!</p>
    <label>Server Name</label>
    <!--<input type="text" class="form-control" [(ngModel)]="newServerName">-->
    <input type="text" class="form-control" #serverNameInput />
    <label>Server Content</label>
    <!--<input type="text" class="form-control" [(ngModel)]="newServerContent">-->
    <input type="text" class="form-control" #serverContentInput />
    <br />
    <button class="btn btn-primary" (click)="onAddServer(serverNameInput)">
      Add Server
    </button>
    <button class="btn btn-primary" (click)="onAddBlueprint(serverNameInput)">
      Add Server Blueprint
    </button>
  </div>
</div>
```

cockpit.component.ts

```ts
  onAddServer(nameInput: HTMLInputElement) {
    this.serverCreated.emit({
      serverName: nameInput.value,
      serverContent: this.serverContentInput.nativeElement.value
    });
  }

  onAddBlueprint(nameInput: HTMLInputElement) {
    this.blueprintCreated.emit({
      serverName: nameInput.value,
      serverContent: this.serverContentInput.nativeElement.value
    });
  }
```

### 12. @ViewChild() in Angular 8.html

In Angular 8, the @ViewChild() syntax which you'll see in the next lecture needs to be changed slightly:

Instead of:

```ts
@ViewChild('serverContentInput') serverContentInput: ElementRef;

```

use

```ts
@ViewChild('serverContentInput', {static: true}) serverContentInput: ElementRef;

```

The same change (add { static: true } as a second argument) needs to be applied to ALL usages of @ViewChild() (and also @ContentChild() which you'll learn about later) IF you plan on accessing the selected element inside of ngOnInit().

If you DON'T access the selected element in ngOnInit (but anywhere else in your component), set static: false instead!

This is a temporary adjustment which will NOT be required anymore once Angular 9 is released!

### 13. Getting Access to the Template & DOM with @ViewChild

```ts
@ViewChild('serverContentInput', { static: false }) serverContentInput: ElementRef;
```

True neu chúng ta sẽ sử dụng trong ngOnInit
Nên sử dụng string interpolation hay pro binding thay vì this.serverContentInput.nativeElement.value để gán giá trị output

### 14. Projecting Content into Components with ng-content

Khi muốn chuyển đoạn html bên dưới từ server-element ra ngoài

```html
<strong *ngIf="serverElement.type === 'server'" style="color: red"
  >{{ serverElement.content }}</strong
>
<em *ngIf="serverElement.type === 'blueprint'">{{ serverElement.content }}</em>
```

Thay bằng

```html
<ng-content></ng-content>
```

### 15. Understanding the Component Lifecycle

![img](../root/img/2019-11-19-01-54-30.png)

### 16. Seeing Lifecycle Hooks in Action

app.component.ts

```ts
onChangeFirst() {
    this.serverElements[0].name = 'Changed!';
  }
// O file server
console.log(changes);
In change have previous value
```

app.component.html

```html
<!--Add button-->
<button class="btn btn-primary" (click)="onChangeFirst()">
  Change first Element
</button>
<!--Add name-->
<button class="btn btn-danger" (click)="onDestroyFirst()">
  Destroy first Component
</button>
<app-server-element
  *ngFor="let serverElement of serverElements"
  [srvElement]="serverElement"
  [name]="serverElement.name"
></app-server-element>
```

Constructor được gọi đầu tiên => change => onInit => do Check => @AfterContentInit

### 17. Lifecycle Hooks and Template Access

server
Add #heading

```html
<div class="panel-heading" #heading>{{ name }}</div>
```

server

```ts
@ViewChild('heading', {static: true}) header: ElementRef;

  constructor() {
    console.log('constructor called!');
  }


  ngOnInit() {
    console.log('ngOnInit called!');
    // Add
    console.log('Text Content: ' + this.header.nativeElement.textContent);
  }


  ngAfterViewInit() {
    console.log('ngAfterViewInit called!');
    console.log('Text Content: ' + this.header.nativeElement.textContent);
  }
```

print value of Heading name

### 18. @ContentChild() in Angular 8.html

In Angular 8, the @ContentChild() syntax which you'll see in the next lecture needs to be changed slightly:

Instead of:

```ts
@ContentChild('contentParagraph') paragraph: ElementRef;
```

use

```ts
@ContentChild('contentParagraph', {static: true}) paragraph: ElementRef;

```

The same change (add { static: true } as a second argument) needs to be applied to ALL usages of @ContentChild() if you use the selected element inside of ngOnInit (as we do it in the lectures).

If you DON'T use the selected element in ngOnInit, set static: false instead.

### 19. Getting Access to ng-content with @ContentChild

Add contentParagraph
app.component.html

```html
<p #contentParagraph>
  <strong *ngIf="serverElement.type === 'server'" style="color: red"
    >{{ serverElement.content }}</strong
  >
  <em *ngIf="serverElement.type === 'blueprint'"
    >{{ serverElement.content }}</em
  >
</p>
```

server

```ts
  @ContentChild('contentParagraph', {static: true}) paragraph: ElementRef;

  ngOnInit() {
    console.log('ngOnInit called!');
    // Add
    console.log('Text Content: ' + this.header.nativeElement.textContent);
    console.log('Text Content of paragraph: ' + this.paragraph.nativeElement.textContent);
  }
```

Sau AfterContentInit

### 20. Wrap Up

### 21. Practicing Property & Event Binding and View Encapsulation.html

### 22. [OPTIONAL] Assignment Solution

## 6. Course Project - Components & Databinding

### 1. Introduction

### 2. Adding Navigation with Event Binding and ngIf

App shopping list and recipe hiển thị tùy loại khi bấm vào nav bar header
header.component.html bắt event click

```html
<ul class="nav navbar-nav">
  <li><a href="#" (click)="onSelect('recipe')">Recipes</a></li>
  <li><a href="#" (click)="onSelect('shopping-list')">Shopping List</a></li>
</ul>
```

header.component.ts

```ts
import { Component, EventEmitter, Output } from "@angular/core";

@Component({
  selector: "app-header",
  templateUrl: "./header.component.html"
})
export class HeaderComponent {
  @Output() featureSelected = new EventEmitter<string>();

  onSelect(feature: string) {
    this.featureSelected.emit(feature);
  }
}
```

app.component.html

```html
<app-header (featureSelected)="onNavigate($event)"></app-header>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <app-recipes *ngIf="loadedFeature === 'recipe'"></app-recipes>
      <app-shopping-list *ngIf="loadedFeature !== 'recipe'"></app-shopping-list>
    </div>
  </div>
</div>
```

app.component.ts

```ts
import { Component } from "@angular/core";

@Component({
  selector: "app-root",
  templateUrl: "./app.component.html",
  styleUrls: ["./app.component.css"]
})
export class AppComponent {
  loadedFeature = "recipe";

  onNavigate(feature: string) {
    this.loadedFeature = feature;
  }
}
```

### 3. Passing Recipe Data with Property Binding

Copy từ recipe-list sang recipe-item

```html
<a href="#" class="list-group-item clearfix" (click)="onSelected()">
  <div class="pull-left">
    <h4 class="list-group-item-heading">{{ recipe.name }}</h4>
    <p class="list-group-item-text">{{ recipe.description }}</p>
  </div>
  <span class="pull-right">
    <img
      [src]="recipe.imagePath"
      alt="{{ recipe.name }}"
      class="img-responsive"
      style="max-height: 50px;"
    />
  </span>
</a>
```

recipe-list.component.html

```html
<div class="col-xs-12">
  <app-recipe-item
    *ngFor="let recipeEl of recipes"
    [recipe]="recipeEl"
  ></app-recipe-item>
</div>
```

recipe-item.component.ts

```ts
 @Input() recipe: Recipe;

```

### 4. Passing Data with Event and Property Binding (Combined)

Khi click vào list thì recipe detail tương ứng sẽ được load
recipe-item.component.ts

```ts
  @Output() recipeSelected = new EventEmitter<void>();

  constructor() { }

  ngOnInit() {
  }

  onSelected() {
    this.recipeSelected.emit();
  }

```

recipe-list.component.html

```ts
<div class="col-xs-12">
    <app-recipe-item
      *ngFor="let recipeEl of recipes"
      [recipe]="recipeEl"
      (recipeSelected)="onRecipeSelected(recipeEl)"></app-recipe-item>
  </div>

```

recipe-list.component.ts

```ts
@Output() recipeWasSelected = new EventEmitter<Recipe>();


  onRecipeSelected(recipe: Recipe) {
   this.recipeWasSelected.emit(recipe);
  }


```

recipes.component.html

```html
<app-recipe-list
  (recipeWasSelected)="selectedRecipe = $event"
></app-recipe-list>
```

recipes.component.ts

```ts
export class RecipesComponent implements OnInit {
  selectedRecipe: Recipe;

  constructor() {}

  ngOnInit() {}
}
```

recipes.component.html

```html
<div class="col-md-7">
  <app-recipe-detail
    *ngIf="selectedRecipe; else infoText"
    [recipe]="selectedRecipe"
  ></app-recipe-detail>
  <ng-template #infoText>
    <p>Please select a Recipe!</p>
  </ng-template>
</div>
```

recipe-detail.component.ts

```ts
export class RecipeDetailComponent implements OnInit {
  @Input() recipe: Recipe;

  constructor() {}

  ngOnInit() {}
}
```

recipe-detail.component.html

```html
<div class="col-xs-12">
  <img
    [src]="recipe.imagePath"
    alt="{{ recipe.name }}"
    class="img-responsive"
    style="max-height: 300px;"
  />
</div>
```

### 5. Make sure you have FormsModule added!.html

In case you're hitting an error in the next lecture, make sure you have FormsModule added to your imports[] in the AppModule.

```ts
@NgModule({
  declarations: [
    AppComponent,
    HeaderComponent,
    RecipesComponent,
    RecipeListComponent,
    RecipeDetailComponent,
    RecipeItemComponent,
    ShoppingListComponent,
    ShoppingEditComponent
  ],
  imports: [BrowserModule, FormsModule],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule {}
```

### 6. Allowing the User to Add Ingredients to the Shopping List

shopping-edit.component.html thêm local ref

```html
<div class="col-sm-5 form-group">
  <label for="name">Name</label>
  <input type="text" id="name" class="form-control" // add #nameInput>
</div>
<div class="col-sm-2 form-group">
  <label for="amount">Amount</label>
  <input type="number" id="amount" class="form-control" #amountInput />
</div>

<button class="btn btn-success" type="submit" (click)="onAddItem()">Add</button>
```

shopping-edit.component.ts

```ts
export class ShoppingEditComponent implements OnInit {
  @ViewChild("nameInput", { static: false }) nameInputRef: ElementRef;
  @ViewChild("amountInput", { static: false }) amountInputRef: ElementRef;
  @Output() ingredientAdded = new EventEmitter<Ingredient>();

  constructor() {}

  ngOnInit() {}

  onAddItem() {
    const ingName = this.nameInputRef.nativeElement.value;
    const ingAmount = this.amountInputRef.nativeElement.value;
    const newIngredient = new Ingredient(ingName, ingAmount);
    this.ingredientAdded.emit(newIngredient);
  }
}
```

shopping-list.component.html

```html
<app-shopping-edit
  (ingredientAdded)="onIngredientAdded($event)"
></app-shopping-edit>
<hr />
```

shopping-list.component.ts

```ts
onIngredientAdded(ingredient: Ingredient) {
    this.ingredients.push(ingredient);
  }
```

## 7. Directives Deep Dive

### 1. Module Introduction

![](../root/img/2019-11-19-23-54-31.png)

### 2. ngFor and ngIf Recap

Chia làm 2 mảng số chẵn và số lẻ nếu true thì hiển thị mảng chẵn và ngược lại, dùng ngIf để kiểm tra điều kiện

```ts
export class AppComponent {
  // numbers = [1, 2, 3, 4, 5];
  oddNumbers = [1, 3, 5];
  evenNumbers = [2, 4];
  onlyOdd = false;
  value = 5;
}
```

```html
<!--<div *ngIf="!onlyOdd">-->
<!--<li-->
<!--class="list-group-item"-->
<!--[ngClass]="{odd: even % 2 !== 0}"-->
<!--[ngStyle]="{backgroundColor: even % 2 !== 0 ? 'yellow' : 'transparent'}"-->
<!--*ngFor="let even of evenNumbers">-->
<!--{{ even }}-->
<!--</li>-->
<!--</div>-->
```

### 3. ngClass and ngStyle Recap

### 4. Creating a Basic Attribute Directive

basic-highlight.directive.ts

```ts
import { Directive, ElementRef, OnInit } from "@angular/core";

@Directive({
  selector: "[appBasicHighlight]"
})
export class BasicHighlightDirective implements OnInit {
  // Auto inject value
  constructor(private elementRef: ElementRef) {}

  ngOnInit() {
    this.elementRef.nativeElement.style.backgroundColor = "green";
  }
}
```

**Add to Module**

```ts
@NgModule({
  declarations: [
    AppComponent,
    // Add
    BasicHighlightDirective,
    BetterHighlightDirective,
    UnlessDirective
  ],
  imports: [BrowserModule, FormsModule],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule {}
```

file html

```html
<p appBasicHighlight>Style me with basic directive!</p>
```

Nhưng cách trên k tốt - access direct element is not good

### 5. Using the Renderer to build a Better Attribute Directive

```ts
ng g d better-highlight

```

Vào module khai báo BetterHighlightDirective

```ts
constructor(private elRef: ElementRef, private renderer: Renderer2){ }

ngOnInit() {
    this.renderer.setStyle(this.elRef.nativeElement, 'background-color', 'blue');
  }

```

Sau đó sửa lại html như phần 4

### 6. More about the Renderer.html

In the last lecture, we used the Angular Renderer class to change the style of a HTML element. As explained in that lecture, you should use the Renderer for any DOM manipulations.

Of course, you can do more than simply change the styling of an element via setStyle(). Learn more about the available Renderer methods here.
https://angular.io/api/core/Renderer2

### 7. Using HostListener to Listen to Host Events

```ts
  @HostListener('mouseenter') mouseover(eventData: Event) {
    // this.renderer.setStyle(this.elRef.nativeElement, 'background-color', 'blue');
    this.backgroundColor = this.highlightColor;
  }

  @HostListener('mouseleave') mouseleave(eventData: Event) {
    // this.renderer.setStyle(this.elRef.nativeElement, 'background-color', 'transparent');
    this.backgroundColor = this.defaultColor;
  }

```

### 8. Using HostBinding to Bind to Host Properties

```ts
  @HostBinding('style.backgroundColor') backgroundColor: string;

```

### 9. Binding to Directive Properties

```ts
@Input() defaultColor: string = 'transparent';
  @Input('appBetterHighlight') highlightColor: string = 'blue';

```

File html

```html
<p [appBetterHighlight]="'red'" defaultColor="yellow">
  ---
</p>

<p [appBetterHighlight]="'red'" [defaultColor]="'yellow'"></p>
```

Luu y: dau [], ''

### 10. What Happens behind the Scenes on Structural Directives

`*` => strutural directive
Dấu \* đại diện cho structural directive
Behind the scene

```html
<!--<ng-template [ngIf]="!onlyOdd">-->
<!--<div>-->
<!--<li-->
<!--class="list-group-item"-->
<!--[ngClass]="{odd: even % 2 !== 0}"-->
<!--[ngStyle]="{backgroundColor: even % 2 !== 0 ? 'yellow' : 'transparent'}"-->
<!--*ngFor="let even of evenNumbers">-->
<!--{{ even }}-->
<!--</li>-->
<!--</div>-->
<!--</ng-template>-->
```

### 11. Building a Structural Directive

```ts
ng g d unless
----
import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';

@Directive({
  selector: '[appUnless]'
})
export class UnlessDirective {
  @Input() set appUnless(condition: boolean) {
    if (!condition) {
      this.vcRef.createEmbeddedView(this.templateRef);
    } else {
      this.vcRef.clear();
    }
  }

  constructor(private templateRef: TemplateRef<any>, private vcRef: ViewContainerRef) { }

}

```

Phương thức setter của prop sẽ execute khi prop co bất kì thay đổi: `set appUnless`

Vào module khai báo **UnlessDirective**

File html

```html
<div *appUnless="onlyOdd">
  <li
    class="list-group-item"
    [ngClass]="{ odd: even % 2 !== 0 }"
    [ngStyle]="{
              backgroundColor: even % 2 !== 0 ? 'yellow' : 'transparent'
            }"
    *ngFor="let even of evenNumbers"
  >
    {{ even }}
  </li>
</div>
```

### 12. Understanding ngSwitch

```html
<div [ngSwitch]="value">
  <p *ngSwitchCase="5">Value is 5</p>
  <p *ngSwitchCase="10">Value is 10</p>
  <p *ngSwitchCase="100">Value is 100</p>
  <p *ngSwitchDefault>Value is Default</p>
</div>
```

## 8. Course Project - Directives

### 1. Building and Using a Dropdown Directive

Recipe book app
Vào folder share tạo file dropdown.directive.ts

```ts
import { Directive, HostListener, HostBinding } from "@angular/core";

@Directive({
  selector: "[appDropdown]"
})
export class DropdownDirective {
  @HostBinding("class.open") isOpen = false;

  @HostListener("click") toggleOpen() {
    this.isOpen = !this.isOpen;
  }
}
```

recipe-detail.component.html

```html
<div class="btn-group" appDropdown>
  <button type="button" class="btn btn-primary dropdown-toggle">
    Manage Recipe <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="#">To Shopping List</a></li>
    <li><a href="#">Edit Recipe</a></li>
    <li><a href="#">Delete Recipe</a></li>
  </ul>
</div>
```

Nếu k dùng directive class="btn-group open" nó sẽ có khung bao và hiện lên

```ts
declarations: [
    DropdownDirective
  ],

```

Vào header thêm để show như recipe-detail

```html
<li class="dropdown" appDropdown></li>
```

thay open = appDropdown

### 2. Closing the Dropdown From Anywhere.html

If you want that a dropdown can also be closed by a click anywhere outside (which also means that a click on one dropdown closes any other one, btw.), replace the code of dropdown.directive.ts by this one (placing the listener not on the dropdown, but on the document):

import {Directive, ElementRef, HostBinding, HostListener} from '@angular/core';

```ts
@Directive({
  selector: "[appDropdown]"
})
export class DropdownDirective {
  @HostBinding("class.open") isOpen = false;
  @HostListener("document:click", ["$event"]) toggleOpen(event: Event) {
    this.isOpen = this.elRef.nativeElement.contains(event.target)
      ? !this.isOpen
      : false;
  }
  constructor(private elRef: ElementRef) {}
}
```

## 9. Using Services & Dependency Injection

### 1. Module Introduction

![](../root/img/2019-11-20-22-57-59.png)

### 2. Why would you Need Services

App create account and log => not duplicate
Tạo file logging.service.ts

```ts
export class LoggingService {
  logStatusChange(status: string) {
    console.log("A server status changed, new status: " + status);
  }
}
```

// sau đó import vào tạo instance bằng new sử dụng bt => cách sai

### 3. Creating a Logging Service

Inform angular to require an instance => inject an instance to component

```ts
// Inject service
  constructor(private loggingService: LoggingService) {}

```

Khai báo để inform angular how to create

```ts
@Component({
  selector: 'app-account',
  templateUrl: './account.component.html',
  styleUrls: ['./account.component.css'],
  providers: [LoggingService]
})

```

Và gọi bằng cách

```ts
onCreateAccount(accountName: string, accountStatus: string) {
    this.loggingService.logStatusChange(accountStatus);
  }
```

### 4. Injecting the Logging Service into Components

### 5. Creating a Data Service

accounts.service.ts

```ts
export class AccountsService {
  accounts = [
    {
      name: "Master Account",
      status: "active"
    },
    {
      name: "Testaccount",
      status: "inactive"
    },
    {
      name: "Hidden Account",
      status: "unknown"
    }
  ];
  constructor(private loggingService: LoggingService) {}

  addAccount(name: string, status: string) {
    this.accounts.push({ name: name, status: status });
    this.loggingService.logStatusChange(status);
  }

  updateStatus(id: number, status: string) {
    this.accounts[id].status = status;
    this.loggingService.logStatusChange(status);
  }
}
```

App.component.ts

```ts
import { Component, OnInit } from "@angular/core";

import { AccountsService } from "./accounts.service";

@Component({
  selector: "app-root",
  templateUrl: "./app.component.html",
  styleUrls: ["./app.component.css"],
  providers: [AccountsService]
})
export class AppComponent implements OnInit {
  accounts: { name: string; status: string }[] = [];

  constructor(private accountsService: AccountsService) {}

  ngOnInit() {
    this.accounts = this.accountsService.accounts;
  }
}
```

app.component.html

```html
<div class="container">
  <div class="row">
    <div class="col-xs-12 col-md-8 col-md-offset-2">
      <app-new-account></app-new-account>
      <hr />
      <app-account
        *ngFor="let acc of accounts; let i = index"
        [account]="acc"
        [id]="i"
      ></app-account>
    </div>
  </div>
</div>
```

new-account.component.ts

```ts
@Component({
  selector: "app-new-account",
  templateUrl: "./new-account.component.html",
  styleUrls: ["./new-account.component.css"],
  providers: [LoggingService]
})
export class NewAccountComponent {
  constructor(
    private loggingService: LoggingService,
    private accountsService: AccountsService
  ) {}

  onCreateAccount(accountName: string, accountStatus: string) {
    this.accountsService.addAccount(accountName, accountStatus);
    // this.loggingService.logStatusChange(accountStatus);
  }
}
```

File account.component.ts

```ts
export class AccountComponent {
  @Input() account: { name: string; status: string };
  @Input() id: number;

  constructor(
    private loggingService: LoggingService,
    private accountsService: AccountsService
  ) {}

  onSetTo(status: string) {
    this.accountsService.updateStatus(this.id, status);
    this.loggingService.logStatusChange(status);
  }
}
```

### 6. Understanding the Hierarchical Injector

Service được cung cấp cho 1 component và tất cả các con của nó => the same instance
![](../root/img/2019-11-21-00-06-50.png)

### 7. How many Instances of Service Should It Be

Khi sử dụng providers thì nó sẽ k hoạt động như mong muốn => many instance
Nếu new-account component khai báo instance mới nó sẽ override instance được khai báo trong app-component => muốn có 1 instance thì chỉ cần khai báo trong app-component

### 8. Injecting Services into Services

app.module.ts

```ts
@NgModule({
  declarations: [
    AppComponent,
    AccountComponent,
    NewAccountComponent
  ],
  imports: [
    BrowserModule,
    FormsModule,
  ],
  // Add
  providers: [AccountsService, LoggingService],
  bootstrap: [AppComponent]
})

```

accounts.service.ts thêm:

```ts
  constructor(private loggingService: LoggingService) {}

// ADD
@Injectable()
export class AccountsService

```

Thông báo service is injectable or something is can be injected in there => inject service into another service

### 9. Using Services for Cross-Component Communication

app.component.html

```html
<app-new-account></app-new-account>
<hr />
<app-account
  *ngFor="let acc of accounts; let i = index"
  [account]="acc"
  [id]="i"
></app-account>
```

account.service.ts

```ts
statusUpdated = new EventEmitter<string>();
```

account.component.ts

```ts
onSetTo(status: string) {
    this.accountsService.updateStatus(this.id, status);
    // this.loggingService.logStatusChange(status);
    this.accountsService.statusUpdated.emit(status);
  }

```

new-account.component.ts

```ts
constructor(private loggingService: LoggingService,
              private accountsService: AccountsService) {
    this.accountsService.statusUpdated.subscribe(
      (status: string) => alert('New Status: ' + status)
    );
  }

```

### 10. Practicing Services.html

### 11. [OPTIONAL] Assignment Solution

### 12. Services in Angular 6+.html

If you're using Angular 6+ (check your package.json to find out), you can provide application-wide services in a different way.

Instead of adding a service class to the providers[] array in AppModule , you can set the following config in @Injectable() :

```ts
@Injectable({providedIn: 'root'})
export class MyService { ... }

// This is exactly the same as:

export class MyService { ... }
and

import { MyService } from './path/to/my.service';

@NgModule({
    ...
    providers: [MyService]
})
export class AppModule { ... }

```

Using this new syntax is completely optional, the traditional syntax (using providers[] ) will still work. The "new syntax" does offer one advantage though: Services can be loaded lazily by Angular (behind the scenes) and redundant code can be removed automatically. This can lead to a better performance and loading speed - though this really only kicks in for bigger services and apps in general.

## 10. Course Project - Services & Dependency Injection

### 1. Introduction

### 2. Setting up the Services

Tạo file recipe.service.ts và shopping-list.service.ts trong folder tương ứng

### 3. Managing Recipes in a Recipe Service

recipe.service.ts

```ts
import { EventEmitter, Injectable } from "@angular/core";

import { Recipe } from "./recipe.model";
import { Ingredient } from "../shared/ingredient.model";
import { ShoppingListService } from "../shopping-list/shopping-list.service";

@Injectable()
export class RecipeService {
  private recipes: Recipe[] = [
    new Recipe(
      "A Test Recipe",
      "This is simply a test",
      "https://upload.wikimedia.org/wikipedia/commons/1/15/Recipe_logo.jpeg"
    ),
    new Recipe(
      "Another Test Recipe",
      "This is simply a test",
      "https://upload.wikimedia.org/wikipedia/commons/1/15/Recipe_logo.jpeg"
    )
  ];

  getRecipes() {
    return this.recipes.slice(); // trả về mảng mới copy lại
  }
}
```

recipes.component.ts vì truy cập service chỉ trong phần này

```ts
@Component({
  selector: "app-recipes",
  templateUrl: "./recipes.component.html",
  styleUrls: ["./recipes.component.css"],
  providers: [RecipeService]
})
```

---

recipe-list.component.ts

```ts
// thêm constructor và vào hàm init thêm
export class RecipeListComponent implements OnInit {
  recipes: Recipe[];

  constructor(private recipeService: RecipeService) {}

  ngOnInit() {
    this.recipes = this.recipeService.getRecipes();
  }
}
```

### 4. Using a Service for Cross-Component Communication

Khi nhấn vào item ở trong list thì detail được update
recipe.service.ts

```ts
recipeSelected = new EventEmitter<Recipe>();
```

recipe-item.component.ts

```ts
export class RecipeItemComponent implements OnInit {
  @Input() recipe: Recipe;

  constructor(private recipeService: RecipeService) {} // add

  ngOnInit() {}

  onSelected() {
    this.recipeService.recipeSelected.emit(this.recipe); // add
  }
}
```

Xóa hàm onRecipeSelected ở file recipe-list.component.html

```html
<app-recipe-item
  *ngFor="let recipeEl of recipes"
  [recipe]="recipeEl"
  (recipeSelected)="onRecipeSelected(recipeEl)"
></app-recipe-item>
```

recipe-list.component.ts xóa những thứ k cần thiết

```ts
export class RecipeListComponent implements OnInit {
  recipes: Recipe[];

  constructor(private recipeService: RecipeService) {}

  ngOnInit() {
    this.recipes = this.recipeService.getRecipes();
  }
}
```

Xóa event tròn file recipeWasSelected ở recipes.component.html

```html
<app-recipe-list
  (recipeWasSelected)="selectedRecipe = $event"
></app-recipe-list>
```

recipes.component.ts

```ts
export class RecipesComponent implements OnInit {
  selectedRecipe: Recipe;

  constructor(private recipeService: RecipeService) {} // add

  ngOnInit() {
    this.recipeService.recipeSelected.subscribe((recipe: Recipe) => {
      this.selectedRecipe = recipe;
    });
  }
}
```

### 5. Adding the Shopping List Service

shopping-list.service.ts

```ts
import { Ingredient } from "../shared/ingredient.model";
import { EventEmitter } from "@angular/core";

export class ShoppingListService {
  ingredientsChanged = new EventEmitter<Ingredient[]>();
  private ingredients: Ingredient[] = [
    new Ingredient("Apples", 5),
    new Ingredient("Tomatoes", 10)
  ];

  getIngredients() {
    return this.ingredients.slice();
  }
}
```

Vào app-modules khai báo service

```ts
providers: [ShoppingListService],

```

shopping-list.component.ts

```ts
export class ShoppingListComponent implements OnInit {
  ingredients: Ingredient[];

  constructor(private slService: ShoppingListService) {} // inject

  ngOnInit() {
    this.ingredients = this.slService.getIngredients();
  }
}
```

Vào service thêm

```ts
addIngredient(ingredient: Ingredient) {
    this.ingredients.push(ingredient);
    this.ingredientsChanged.emit(this.ingredients.slice());
  }

```

Vào xóa sự kiện emit trong file shopping-edit.component.ts

```ts
// Xóa
 // @Output() ingredientAdded = new EventEmitter<Ingredient>();

 // chuyển thành
  constructor(private slService: ShoppingListService) { }

  onAddItem() {
    const ingName = this.nameInputRef.nativeElement.value;
    const ingAmount = this.amountInputRef.nativeElement.value;
    const newIngredient = new Ingredient(ingName, ingAmount);
    this.slService.addIngredient(newIngredient);
   // this.ingredientAdded.emit(newIngredient); // xóa
  }

```

Vào file shopping-list xóa hàm onIngredientAdded

```html
// Xóa (ingredientAdded)="onIngredientAdded($event)"
<app-shopping-edit
  (ingredientAdded)="onIngredientAdded($event)"
></app-shopping-edit>
```

### 6. Using Services for Pushing Data from A to B

Khi ấn vào k add được vì lúc trả về là array copy
Vào service tạo

```ts
  ingredientsChanged = new EventEmitter<Ingredient[]>();

addIngredient(ingredients: Ingredient[]) {
    this.ingredients.push(...ingredients);
    this.ingredientsChanged.emit(this.ingredients.slice());
  }

```

Sửa lại hàm trong file shopping-list.component.ts

```ts
ngOnInit() {
    this.ingredients = this.slService.getIngredients();
    this.slService.ingredientsChanged
      .subscribe(
        (ingredients: Ingredient[]) => {
          this.ingredients = ingredients;
        }
      );
  }

```

### 7. Adding Ingredients to Recipes

Make To shopping list work
Cập nhật model Recipe

```ts
export class Recipe {
  public name: string;
  public description: string;
  public imagePath: string;
  // add
  public ingredients: Ingredient[];
}
```

Cập nhật lại service

```ts
private recipes: Recipe[] = [
    new Recipe(
      'Tasty Schnitzel',
      'A super-tasty Schnitzel - just awesome!',
      'https://upload.wikimedia.org/wikipedia/commons/7/72/Schnitzel.JPG',
      [
        new Ingredient('Meat', 1),
        new Ingredient('French Fries', 20)
      ]),
    new Recipe('Big Fat Burger',
      'What else you need to say?',
      'https://upload.wikimedia.org/wikipedia/commons/b/be/Burger_King_Angus_Bacon_%26_Cheese_Steak_Burger.jpg',
      [
        new Ingredient('Buns', 2),
        new Ingredient('Meat', 1)
      ])
  ];

```

recipe-detail.component.html thêm đoạn output ingredients

```html
<div class="row">
  <div class="col-xs-12">
    // Add
    <ul class="list-group">
      <li class="list-group-item" *ngFor="let ingredient of recipe.ingredients">
        {{ ingredient.name }} - {{ ingredient.amount }}
      </li>
    </ul>
  </div>
</div>
```

### 8. Passing Ingredients from Recipes to the Shopping List (via a Service)

modify button To shopping list

```html
<li>
  <a (click)="onAddToShoppingList()" style="cursor: pointer;"
    >To Shopping List</a
  >
</li>
```

recipe-detail.component.ts

```ts
constructor(private recipeService: RecipeService) { }

onAddToShoppingList() {
    this.recipeService.addIngredientsToShoppingList(this.recipe.ingredients);
  }

```

recipe.service.ts

```ts
constructor(private slService: ShoppingListService) {}

  addIngredientsToShoppingList(ingredients: Ingredient[]) {
    this.slService.addIngredients(ingredients);
  }

```

Nhớ thêm @Injectable()
shopping-list.service.ts

```ts
addIngredients(ingredients: Ingredient[]) {
    // for (let ingredient of ingredients) {
    //   this.addIngredient(ingredient);
    // }
    // es6
    this.ingredients.push(...ingredients);
    this.ingredientsChanged.emit(this.ingredients.slice());
  }

```

## 11. Changing Pages with Routing

### 1. Module Introduction

![](../root/img/2019-11-22-00-33-37.png)

### 3. Understanding the Example Project.html

In our app, we got three sections:

- Home
- Servers
  - View and Edit Servers
  - A Service is used to load and update Servers
- Users
- View Users
  This app will be improved by adding routing but definitely feel free to play around with it - besides routing, everything should be working fine.

### 4. Setting up and Loading Routes

App.module.ts

```ts
const appRoutes: Routes = [
  { path: "", component: HomeComponent },
  { path: "users", component: UsersComponent },
  { path: "servers", component: ServersComponent }
];

// và phải khai báo
imports: [
  BrowserModule,
  FormsModule,
  // add
  RouterModule.forRoot(appRoutes)
];
```

app.component.html

```html
<div class="row">
  <div class="col-xs-12 col-sm-10 col-md-8 col-sm-offset-1 col-md-offset-2">
    <router-outlet></router-outlet>
  </div>
</div>
```

### 5. Navigating with Router Links

Khi thay /servers sẽ load lại => issue

```html
<li role="presentation"><a href="/servers">Servers</a></li>
```

App.component.html sử dụng routerLink

```html
<li role="presentation"
          <a routerLink="/">Home</a>
        </li>
        <li role="presentation">
          <a routerLink="servers">Servers</a>
        </li>
        <li role="presentation"\>
          <a [routerLink]="['users']">Users</a>
        </li>

```

### 6. Understanding Navigation Paths

Tại file servers.component.html

```ts
routerLink="/servers" // phải có dấu / mới load được vì nó là absolute path
./servers currently path
../servers go up a level

```

Khi muon o page servers load lai trang bang cach nam button Reload => error /servers/servers path

### 7. Styling Active Router Links

active is a class
app.component.html

```html
<ul class="nav nav-tabs">
  <li
    role="presentation"
    routerLinkActive="active"
    [routerLinkActiveOptions]="{exact: true}"
  >
    <a routerLink="/">Home</a>
  </li>
  <li role="presentation" routerLinkActive="active">
    <a routerLink="servers">Servers</a>
  </li>
  <li role="presentation" routerLinkActive="active">
    <a [routerLink]="['users']">Users</a>
  </li>
</ul>

[routerLinkActiveOptions]="{exact: true} tránh lúc nào cũng được active ở tab
HOME vì nó kiểm tra nếu url có chứa thì sẽ active nên cần them cái này
```

### 8. Navigating Programmatically

home.component.html

```html
<button class="btn btn-primary" (click)="onLoadServer(1)">Load Server 1</button>
```

File home.component.ts

```ts
export class HomeComponent implements OnInit {
  constructor(private router: Router) {} // inject

  onLoadServer(id: number) {
    // complex calculation
    this.router.navigate(["/servers"]);
  }
}
```

### 9. Using Relative Paths in Programmatic Navigation

servers.component.html

```html
<!--<button class="btn btn-primary" (click)="onReload()">Reload Page</button>-->
```

Servers.component.ts

```ts
constructor(private serversService: ServersService,
              private router: Router
) { }

  onReload() {
    this.router.navigate(['servers']);
  }

```

Navigate method doesn’t know route you are currently on is different routerLink
Nếu muốn biết route mà bạn đang ở đó thì SD:

```ts
constructor(private serversService: ServersService,
              private router: Router,
              private route: ActivatedRoute) {
  }

// this.router.navigate(['servers'], {relativeTo: this.route}); // /servers/servers => error
this.router.navigate(['servers']);
```

### 10. Passing Parameters to Routes

app.modules.ts

```ts
{ path: "users/:id", component: UsersComponent },
```

### 11. Fetching Route Parameters

user.component.ts

```ts
constructor(private route: ActivatedRoute) { } // inject

  ngOnInit() {
    this.user = {
      id: this.route.snapshot.params['id']
    };
  }

```

### 12. Fetching Route Parameters Reactively

user.component.html

```html
<p>User with ID {{ user.id }} loaded.</p>
<p>User name is {{ user.name }}</p>
<hr />
<a [routerLink]="['/users', 10, 'Anna']">Load Anna (10)</a>
```

Khi ở trang này bấm vào sẽ không cập nhật được data, Bởi vì ta đang ở trên component mà mình định load nên angular sẽ k tạo ra instance mới

user.component.ts

```ts
ngOnInit() {
    this.user = {
      id: this.route.snapshot.params['id'],
      name: this.route.snapshot.params['name']
    };
    this.route.params
      .subscribe(
        (params: Params) => {
          this.user.id = params['id'];
          this.user.name = params['name'];
        }
      );
  }

```

Observable is an easy way to subscribe to some event may happen in the future, async => should wait
Param is an observable

### 13. An Important Note about Route Observables
Must unsubscribe when destroy Component
```ts
// Add
paramsSubscription: Subscription;

ngOnInit() {
    this.user = {
      id: this.route.snapshot.params['id'],
      name: this.route.snapshot.params['name']
    };
    this.paramsSubscription = this.route.params
      .subscribe(
        (params: Params) => {
          this.user.id = params['id'];
          this.user.name = params['name'];
        }
      );
  }
// Add
ngOnDestroy() {
    this.paramsSubscription.unsubscribe();
  }

```

### 14. Passing Query Parameters and Fragments
```ts
  { path: "servers/:id/edit", component: EditServersComponent }

```
servers.component.html
```html
<a
        [routerLink]="['/servers', 5, 'edit']"
        [queryParams]="{allowEdit: server.id === 3 ? '1' : '0'}"
        fragment="loading"
        href="#"
        class="list-group-item"
        *ngFor="let server of servers">
        {{ server.name }}
      </a>

```

Modify button Load server
```html
<button (click)="onLoadServer(1)">Load server 1<button>
```
home.component.ts
```ts
onLoadServer(id: number) {
    // complex calculation
    this.router.navigate(['/servers', id, 'edit'], {queryParams: {allowEdit: '1'}, fragment: 'loading'});
  }

```
Localhost:4200/servers/5/edit?allowEdit=3#loading

### 15. Retrieving Query Parameters and Fragments
edit-server.component.ts
```ts
constructor(private serversService: ServersService,
              private route: ActivatedRoute,
              private router: Router) {
  }

  ngOnInit() {
    // 2 cách để access query params, only access when component create
    console.log(this.route.snapshot.queryParams);
    console.log(this.route.snapshot.fragment);
    this.route.queryParams
      .subscribe(
        (queryParams: Params) => {
          this.allowEdit = queryParams['allowEdit'] === '1' ? true : false;
        }
      );
    this.route.fragment.subscribe();
    const id = +this.route.snapshot.params['id'];
    this.server = this.serversService.getServer(id);
    // Subscribe route params to update the id if params change
    this.serverName = this.server.name;
    this.serverStatus = this.server.status;
  }

```
### 16. Practicing and some Common Gotchas
users.component.html thêm
```html
<a
        [routerLink]="['/users', user.id, user.name]"
        href="#"
        class="list-group-item"
        *ngFor="let user of users">
        {{ user.name }}
      </a>

```
fix to only load **ServerComponent**
servers.component.html
```html
<a
        [routerLink]="['/servers', server.id]"
        [queryParams]="{allowEdit: server.id === 3 ? '1' : '0'}"
        fragment="loading"
        href="#"
        class="list-group-item"
        *ngFor="let server of servers">
        {{ server.name }}
      </a>

```
Server.component.ts
```ts
  constructor(private serversService: ServersService,
              private route: ActivatedRoute,
              private router: Router) {
  }

  ngOnInit() {
    // lấy tham số từ /user/:id khi click
    const id = +this.route.snapshot.params['id'];
     this.server = this.serversService.getServer(id);
     this.route.params
       .subscribe(
         (params: Params) => {
           this.server = this.serversService.getServer(+params['id']);
         }
       );
  }

```

Comment servers.component.html because of error
```html
<!-- <app-server></app-server> -->

```
### 17. Setting up Child (Nested) Routes
servers.component.html
```html
<div class="col-xs-12 col-sm-4">
    <router-outlet></router-outlet>
    <!--<button class="btn btn-primary" (click)="onReload()">Reload Page</button>-->
    <!--<app-edit-server></app-edit-server>-->
    <!--<hr>-->
    <!--&lt;!&ndash;<app-server></app-server>&ndash;&gt;-->
  </div>

```
```ts
const appRoutes: Routes = [
  { path: "", component: HomeComponent },
  { path: "users", component: UsersComponent },
  { path: "users/:id/:name", component: UserComponent },
  { path: "servers", component: ServersComponent, children: [
    { path: ":id", component: ServerComponent },
    { path: ":id/edit", component: EditServerComponent }
  ] }
];

```
users.component.html
```html
<div class="col-xs-12 col-sm-4">
    <!--<app-user></app-user>-->
    <router-outlet></router-outlet>
  </div>

```
### 18. Using Query Parameters - Practice
server.component.html
```html
<h5>{{ server.name }}</h5>
<p>Server status is {{ server.status }}</p>
<button class="btn btn-primary" (click)="onEdit()">Edit Server</button>

```

server.component.ts
```ts
onEdit() {
    this.router.navigate(['edit'], {relativeTo: this.route, queryParamsHandling: 'preserve'});
  }

```
relativeTo: this.route load đường dẫn hiện tại thêm /edit vào
edit-server.component.ts
```ts
this.route.queryParams
      .subscribe(
        (queryParams: Params) => {
          this.allowEdit = queryParams['allowEdit'] === '1' ? true : false;
        }
      );

```
edit-server.component.html
```html
<h4 *ngIf="!allowEdit">You're not allowed to edit!</h4>
<div *ngIf="allowEdit">

```
### 19. Configuring the Handling of Query Parameters
server.component.ts
Fix params bị mất khi ấn vào Link ở list server rồi ấn vào button Edit server thêm queryParamsHandling: 'preserve'
queryParamsHandling : 'merge'
### 20. Redirecting and Wildcard Routes
Tạo component page not found để url sai sẽ vào đây
{ path: ":not-found", component: PageNotFoundComponent },
{ path: "**", relativeTo: 'not-found'  } // phải để cuối cùng

### 21. Important Redirection Path Matching.html
In our example, we didn't encounter any issues when we tried to redirect the user. But that's not always the case when adding redirections.

By default, Angular matches paths by prefix. That means, that the following route will match both /recipes  and just / 

```ts
{ path: '', redirectTo: '/somewhere-else' } 

```
Actually, Angular will give you an error here, because that's a common gotcha: This route will now ALWAYS redirect you! Why?

Since the default matching strategy is "prefix" , Angular checks if the path you entered in the URL does start with the path specified in the route. Of course every path starts with ''  (Important: That's no whitespace, it's simply "nothing").

To fix this behavior, you need to change the matching strategy to "full" :

```ts
{ path: '', redirectTo: '/somewhere-else', pathMatch: 'full' } 

```
Now, you only get redirected, if the full path is ''  (so only if you got NO other content in your path in this example).
### 22. Outsourcing the Route Configuration
Tạo file app-routing.module.ts
```ts
import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';

import { PageNotFoundComponent } from './page-not-found/page-not-found.component';
import { EditServerComponent } from './servers/edit-server/edit-server.component';
import { ServerComponent } from './servers/server/server.component';
import { ServersComponent } from './servers/servers.component';
import { UserComponent } from './users/user/user.component';
import { UsersComponent } from './users/users.component';
import { HomeComponent } from './home/home.component';
import { AuthGuard } from './auth-guard.service';
import { CanDeactivateGuard } from './servers/edit-server/can-deactivate-guard.service';
import { ErrorPageComponent } from './error-page/error-page.component';
import { ServerResolver } from './servers/server/server-resolver.service';

const appRoutes: Routes = [
  { path: '', component: HomeComponent },
  { path: 'users', component: UsersComponent, children: [
    { path: ':id/:name', component: UserComponent }
  ] },
  {
    path: 'servers',
    // canActivate: [AuthGuard],
    canActivateChild: [AuthGuard],
    component: ServersComponent,
    children: [
    { path: ':id', component: ServerComponent, resolve: {server: ServerResolver} },
    { path: ':id/edit', component: EditServerComponent, canDeactivate: [CanDeactivateGuard] }
  ] },
  // { path: 'not-found', component: PageNotFoundComponent },
  { path: 'not-found', component: ErrorPageComponent, data: {message: 'Page not found!'} },
  { path: '**', redirectTo: '/not-found' }
];

@NgModule({
  imports: [
    // RouterModule.forRoot(appRoutes, {useHash: true})
    RouterModule.forRoot(appRoutes)
  ],
  exports: [RouterModule]
})
export class AppRoutingModule {

}

```

Module
```ts
imports: [
    BrowserModule,
    FormsModule,
    AppRoutingModule
  ],


```
### 23. An Introduction to Guards

### 24. Protecting Routes with canActivate
Tạo file auth-guard.service.ts
we will define that angular will execute this code before a route is loaded
```ts
canActivate(route: ActivatedRouteSnapshot,
              state: RouterStateSnapshot): Observable<boolean> | Promise<boolean> | boolean 

```
return về Observable, run asynchronously
auth.service.ts
```ts
export class AuthService {
  loggedIn = false;

  isAuthenticated() {
    const promise = new Promise(
      (resolve, reject) => {
        setTimeout(() => {
          resolve(this.loggedIn);
        }, 800);
      }
    );
    return promise;
  }

  login() {
    this.loggedIn = true;
  }

  logout() {
    this.loggedIn = false;
  }
}

```

Thêm Injectable và constructor
```ts
@Injectable()
export class AuthGuard implements CanActivate, CanActivateChild {
  constructor(private authService: AuthService, private router: Router) {}

canActivate(route: ActivatedRouteSnapshot,
              state: RouterStateSnapshot): Observable<boolean> | Promise<boolean> | boolean {
    return this.authService.isAuthenticated()
      .then(
        (authenticated: boolean) => {
          if (authenticated) {
            return true;
          } else {

            // return false
            this.router.navigate(['/']);
          }
        }
      );
  }


```
Vào app-routing.module  thêm canActivate
```ts
{
    path: 'servers',
    // Add
    canActivate: [AuthGuard],
    // canActivateChild: [AuthGuard],
    component: ServersComponent,
    children: [
    { path: ':id', component: ServerComponent, resolve: {server: ServerResolver} },
    { path: ':id/edit', component: EditServerComponent, canDeactivate: [CanDeactivateGuard] }
  ] },

Nhớ khai báo
  providers: [ServersService, AuthService, AuthGuard],

```

Chi co tab server k load, back to home after 800s
Declare new service in module 
### 25. Protecting Child (Nested) Routes with canActivateChild
Khi bạn đang edit muốn leave page => ask for confirmation
Implement thêm CanActivateChild 
```ts
@Injectable()
export class AuthGuard implements CanActivate, CanActivateChild {
  constructor(private authService: AuthService, private router: Router) {}

  // add for child routes
  canActivateChild(route: ActivatedRouteSnapshot,
                   state: RouterStateSnapshot): Observable<boolean> | Promise<boolean> | boolean {
    return this.canActivate(route, state);
  }
}

```
Thêm canActivateChild: [AuthGuard],
khi click vào link child routes ở tab server thì redirect to home page

### 26. Using a Fake Auth Service
Vào home tạo btn login và log out
### 27. Controlling Navigation with canDeactivate
edit-server.component.ts
Thêm thuộc tính changesSaved = false;
```ts
onUpdateServer() {
    this.serversService.updateServer(this.server.id, {name: this.serverName, status: this.serverStatus});
    this.changesSaved = true;
    this.router.navigate(['../'], {relativeTo: this.route});
  }

```
Tạo file edit-server/ can-deactivate-guard.service.ts
```ts
import { Observable } from 'rxjs/Observable';
import { CanDeactivate, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';

export interface CanComponentDeactivate {
  canDeactivate: () => Observable<boolean> | Promise<boolean> | boolean;
}

export class CanDeactivateGuard implements CanDeactivate<CanComponentDeactivate> {

  canDeactivate(component: CanComponentDeactivate,
                currentRoute: ActivatedRouteSnapshot,
                currentState: RouterStateSnapshot,
                // ?: is optional
                nextState?: RouterStateSnapshot): Observable<boolean> | Promise<boolean> | boolean {
    return component.canDeactivate();
  }
}

```

app-routing.module.ts
```ts
    { path: ':id/edit', component: EditServerComponent, canDeactivate: [CanDeactivateGuard] }

```
app.module.ts
```ts
providers:[ServersService, AuthService, AuthGuard, CanDeactivateGuard]

```

edit-server.component.ts
```ts
implements CanComponentDeactivate
canDeactivate(): Observable<boolean> | Promise<boolean> | boolean {
    if (!this.allowEdit) {
      return true;
    }
    if ((this.serverName !== this.server.name || this.serverStatus !== this.server.status) && !this.changesSaved) {
      return confirm('Do you want to discard the changes?');
    } else {
      return true;
    }
  }

// thêm in onInit
const id = +this.route.snapshot.params['id'];
    this.server = this.serversService.getServer(id); // thay vì update id = 1
    // Subscribe route params to update the id if params change

```
### 28. Passing Static Data to a Route
Tạo component error page and declare
```ts
import { Component, OnInit } from '@angular/core';
import { ActivatedRoute, Data } from '@angular/router';

@Component({
  selector: 'app-error-page',
  templateUrl: './error-page.component.html',
  styleUrls: ['./error-page.component.css']
})
export class ErrorPageComponent implements OnInit {
  errorMessage: string;

  constructor(private route: ActivatedRoute) { }

  ngOnInit() {
    // this.errorMessage = this.route.snapshot.data['message'];
    this.route.data.subscribe(
      (data: Data) => {
        this.errorMessage = data['message'];
      }
    );
  }

}

```

app-routing.module.ts
```ts
// { path: 'not-found', component: PageNotFoundComponent },
  { path: 'not-found', component: ErrorPageComponent, data: {message: 'Page not found!'} },

```
Khai báo ErrorPageComponent

### 29. Resolving Dynamic Data with the resolve Guard
Tạo file server-resolver.service.ts
```ts
import { Resolve, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';
import { Observable } from 'rxjs/Observable';
import { Injectable } from '@angular/core';

import { ServersService } from '../servers.service';

interface Server {
  id: number;
  name: string;
  status: string;
}

@Injectable()
export class ServerResolver implements Resolve<Server> {
  constructor(private serversService: ServersService) {}

  resolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<Server> | Promise<Server> | Server {
    return this.serversService.getServer(+route.params['id']);
  }
}

```

Khai báo module
```ts
providers: [ServersService, AuthService, AuthGuard, CanDeactivateGuard, ServerResolver],

```
file routing
```ts
    { path: ':id', component: ServerComponent, resolve: {server: ServerResolver} },

```
server.component.ts
```ts
ngOnInit() {
    this.route.data
      .subscribe(
        (data: Data) => {
          this.server = data['server'];
        }
      );
    // const id = +this.route.snapshot.params['id'];
    // this.server = this.serversService.getServer(id);
    // this.route.params
    //   .subscribe(
    //     (params: Params) => {
    //       this.server = this.serversService.getServer(+params['id']);
    //     }
    //   );
  }

```
Sử dụng cho asyn data before component render

### 30. Understanding Location Strategies
URL will be parses by the server first not angular =>care about localhost:4200/# and ignore the rest don't return 404 error
RouterModule.forRoot(appRoutes, {useHash: true})
### 31. Wrap Up

## 12. Course Project - Routing

### 1. Planning the General Structure
![](../root/img/2019-11-23-10-29-39.png)

### 2. Setting Up Routes

Tạo file app-routing.module.ts
```ts
import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';

import { RecipesComponent } from './recipes/recipes.component';
import { ShoppingListComponent } from './shopping-list/shopping-list.component';
import { RecipeStartComponent } from './recipes/recipe-start/recipe-start.component';
import { RecipeDetailComponent } from './recipes/recipe-detail/recipe-detail.component';
import { RecipeEditComponent } from './recipes/recipe-edit/recipe-edit.component';

const appRoutes: Routes = [
  { path: '', redirectTo: '/recipes', pathMatch: 'full' },
  { path: 'recipes', component: RecipesComponent},
  { path: 'shopping-list', component: ShoppingListComponent },
];

@NgModule({
  imports: [RouterModule.forRoot(appRoutes)],
  exports: [RouterModule]
})
export class AppRoutingModule {

}

```

pathMatch: 'full' nếu không bất kì path nào cũng redirect nên báo lỗi
Khai báo module
```ts
imports: [
    BrowserModule,
    FormsModule,
    AppRoutingModule
  ],

```
app.component.html
```html
<app-header (featureSelected)="onNavigate($event)"></app-header>
<div class="container">
  <div class="row">
    <div class="col-md-12">
    <!-- thay cho if-->
      <router-outlet></router-outlet>
    </div>
  </div>
</div>


<router-outlet></router-outlet> component được render

```

### 3. Adding Navigation to the App
header.component.html
```html
<li routerLinkActive ="active"><a routerLink="/recipes">Recipes</a>
</li>
        <li routerLinkActive="active"><a routerLink="/shopping-list">Shopping List</a></li>

```
header.component.ts sửa thành
```ts
import { Component } from '@angular/core';

@Component({
  selector: 'app-header',
  templateUrl: './header.component.html'
})
export class HeaderComponent {
}

```

### 4. Marking Active Routes
Thêm routerLinkActive
### 5. Fixing Page Reload Issues
Khi bấm vào list recipe thì page sẽ bị load lại
Vào file recipe-item.component.html, recipe-detail.component.html, header.component.html xóa `href=#`
```html
<a
  style="cursor: pointer;"
  [routerLink]="[index]"
  routerLinkActive="active"
  class="list-group-item clearfix">
  <div class="pull-left">
    <h4 class="list-group-item-heading">{{ recipe.name }}</h4>
    <p class="list-group-item-text">{{ recipe.description }}</p>
  </div>
  <span class="pull-right">
        <img
          [src]="recipe.imagePath"
          alt="{{ recipe.name }}"
          class="img-responsive"
          style="max-height: 50px;">
      </span>
</a>

```

Thêm style="cursor: pointer;"

### 6. Child Routes Challenge
```ts
const appRoutes: Routes = [
  { path: '', redirectTo: '/recipes', pathMatch: 'full' },
  { path: 'recipes', component: RecipesComponent, children: [
    { path: '', component: RecipeStartComponent },
    { path: 'new', component: RecipeEditComponent },
    { path: ':id', component: RecipeDetailComponent },
    { path: ':id/edit', component: RecipeEditComponent },
  ] },
  { path: 'shopping-list', component: ShoppingListComponent },
];

```
### 7. Adding Child Routing Together
```ts
ng g c recipes/recipe-start
```

Nội dung file html
<h3>Please select a Recipe!</h3>

Khai báo RecipeStartComponent trong module
recipes.component.html
```html
<div class="row">
  <div class="col-md-5">
    <app-recipe-list></app-recipe-list>
  </div>
  <div class="col-md-7">
    <router-outlet></router-outlet>
  </div>
</div>

```
now canot run app load detail recepie
### 8. Configuring Route Parameters
Remove event select item in recpie-item.component.html
recipe-detail.component.ts
```ts
export class RecipeDetailComponent implements OnInit {
  recipe: Recipe;
  id: number;

  constructor(private recipeService: RecipeService,
              private route: ActivatedRoute,
              private router: Router) {
  }

  ngOnInit() {
    this.route.params
      .subscribe(
        (params: Params) => {
          this.id = +params['id'];
          this.recipe = this.recipeService.getRecipe(this.id);
        }
      );
  }

}

```
Vào recipe xóa các event không cần thiết
Service
```ts
getRecipe(index: number) {
    return this.recipes[index];
  }

```
### 9. Passing Dynamic Parameters to Links
recipe-item.component.html
```html
<a
  style="cursor: pointer;"
  // Add
  [routerLink]="[index]"
  routerLinkActive="active"
  class="list-group-item clearfix">
  <div class="pull-left">
    <h4 class="list-group-item-heading">{{ recipe.name }}</h4>
    <p class="list-group-item-text">{{ recipe.description }}</p>
  </div>
  <span class="pull-right">
        <img
          [src]="recipe.imagePath"
          alt="{{ recipe.name }}"
          class="img-responsive"
          style="max-height: 50px;">
      </span>
</a>

```

Thêm ở file .ts:  @Input() index: number;

recipe-list.component.html
```html
<div class="col-xs-12">
    <app-recipe-item
      *ngFor="let recipeEl of recipes; let i = index"
      // ADD
      [recipe]="recipeEl"
      [index]="i"></app-recipe-item>
  </div>

```
### 10. Styling Active Recipe Items
### 11. Adding Editing Routes
Tạo component recipe-edit
```ts
ng g c recepies/recipe-edit --spec false

```
Vào recipe-list thêm
```html
 <div class="col-xs-12">
    <button class="btn btn-success" (click)="onNewRecipe()">New Recipe</button>
  </div>

```
```ts
export class RecipeListComponent implements OnInit {
  recipes: Recipe[];

  constructor(private recipeService: RecipeService,
              private router: Router,
              private route: ActivatedRoute) {
  }

  ngOnInit() {
    this.recipes = this.recipeService.getRecipes();
  }

  onNewRecipe() {
    this.router.navigate(['new'], {relativeTo: this.route}); // current route
  }
}

```
Để new lên trước nếu không nó sẽ nhận new là id mà parse => err
```ts
{ path: 'new', component: RecipeEditComponent },
    { path: ':id', component: RecipeDetailComponent },
    { path: ':id/edit', component: RecipeEditComponent },

```
### 12. Retrieving Route Parameters
recipe-edit.component.ts
```ts
export class RecipeEditComponent implements OnInit {
  id: number;
  editMode = false;

  constructor(private route: ActivatedRoute) { }

  ngOnInit() {
    this.route.params
      .subscribe(
        (params: Params) => {
          this.id = +params['id'];
          this.editMode = params['id'] != null; // pb với new
        }
      );
  }
}

```
### 13. Programmatic Navigation to the Edit Page
recipe-detail.component.html
```html
<li><a style="cursor: pointer;" (click)="onEditRecipe()">Edit
 Recipe</a></li>

```
recipe-detail.component.ts
```ts
constructor(private recipeService: RecipeService,
              private route: ActivatedRoute,
              private router: Router) {
  }

onEditRecipe() {
    this.router.navigate(['edit'], {relativeTo: this.route});
    // this.router.navigate(['../', this.id, 'edit'], {relativeTo: this.route}); cách 2
  }


```
### 14. One Note about Route Observables

### 15. Project Cleanup.html
There's one thing I forgot to clean up here (will be cleaned up later in the course). Feel free to do the cleanup right now though.

Our app.component.html file looks like that:

```html
<app-header (featureSelected)="onNavigate($event)"></app-header>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
The (featureSelected)="..."  event listener is a relict of our "old" navigation approach using ngIf. We no longer need it, so feel free to change this template to:

<app-header></app-header>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>

```
## 13. Understanding Observables

### 1. Module Introduction
![](../root/img/2019-11-23-15-33-46.png)
### 10. Useful Resources & Links.html
Useful Resources:
•	Official Docs: https://rxjs-dev.firebaseapp.com/
•	RxJS Series: https://academind.com/learn/javascript/understanding-rxjs/
•	Updating to RxJS 6: https://academind.com/learn/javascript/rxjs-6-what-changed/

### 2. Analyzing Angular Observables
user.component.ts
```ts
export class UserComponent implements OnInit {
  id: number;

  constructor(private route: ActivatedRoute) {
  }

  ngOnInit() {
    this.route.params.subscribe((params: Params) => {
      this.id = +params.id;
    });
  }
}

```
### 3. Getting Closer to the Core of Observables
Observables nằm trong rxjs
2.1 obs-01-start.zip.zip
home.component.ts
```ts
import { Component, OnDestroy, OnInit } from '@angular/core';

import { interval, Subscription } from 'rxjs';

@Component({
  selector: 'app-home',
  templateUrl: './home.component.html',
  styleUrls: ['./home.component.css']
})
export class HomeComponent implements OnInit, OnDestroy {

  private firstObsSubscription: Subscription;

  constructor() {
  }

  ngOnInit() {
    this.firstObsSubscription = interval(1000).subscribe(count => {
      console.log(count);
    });
  }

  ngOnDestroy(): void {
    this.firstObsSubscription.unsubscribe();
  }

}


```
memory leak
Hàm interval sau 1s sẽ emit event, khi vào trang chủ sẽ tự động tăng biến count nếu quay lại thì sẽ có thêm 1 biến đếm bắt đầu từ 0 và tang song song => destroy

Param k cần unsubscribe bởi vì nó được cung cấp bởi angular nên không cần làm thủ công

### 4. Building a Custom Observable
home.component.ts
```ts
ngOnInit() {
    // this.firstObsSubscription = interval(1000).subscribe(count => {
    //   console.log(count);
    // });
    const customIntervalObservable = Observable.create(observer => {
      let count = 0;
      setInterval(() => {
        observer.next(count); // emit
        if (count === 5) {
          observer.complete();
        }
        if (count > 3) {
          observer.error(new Error('Count is greater 3!'));
        }
        count++;
      }, 1000);
    });

    this.firstObsSubscription = customIntervalObservable.subscribe(data => {
      console.log(data);
    }, error => {
      console.log(error);
      alert(error.message);
    }, () => {
      console.log('Completed!');
    });
  }

  ngOnDestroy(): void {
    this.firstObsSubscription.unsubscribe();
  }

```
### 5. Errors & Completion

### 6. Observables & You!

### 7. Understanding Operators
![](../root/img/2019-11-23-16-02-35.png)
```ts
this.firstObsSubscription = customIntervalObservable.pipe(filter(data
 => {
      return data > 0;
    }), map((data: number) => {
      return 'Round: ' + (data + 1);
    })).subscribe(data => {
      console.log(data);
    }, error => {
      console.log(error);
      alert(error.message);
    }, () => {
      console.log('Completed!');
    });

```
https://www.academind.com/learn/javascript/understanding-rxjs/

https://www.learnrxjs.io/
### 8. Subjects
user.component.html
```html
<p>User with <strong>ID {{ id }}</strong> was loaded</p>
<button class="btn btn-primary" (click)="onActivate()">Activate</button>

```
user.component.ts
```ts
constructor(private route: ActivatedRoute, private userService: UserSe
rvice) {
  }

  ngOnInit() {
    this.route.params.subscribe((params: Params) => {
      this.id = +params.id;
    });
  }

  onActivate() {
    // emit(true)
    this.userService.activatedEmitter.next(true);
  }
```
user.service.ts
```ts
import { Injectable } from '@angular/core';
import { Subject } from 'rxjs';

@Injectable({providedIn: 'root'})
export class UserService {
  // new EvenEmitter<boolean>();
  activatedEmitter = new Subject<boolean>();
}


```
app.component.ts
```ts
export class AppComponent implements OnInit, OnDestroy {
  userActivated = false;
  private activatedSub: Subscription;

  constructor(private userService: UserService) {
  }

  ngOnInit() {
    this.activatedSub = this.userService.activatedEmitter.subscribe(didActivate => {
      this.userActivated = didActivate;
    });
  }

  ngOnDestroy(): void {
    this.activatedSub.unsubscribe();
  }
}

```
![](../root/img/2019-11-23-16-22-39.png)
=> 
Recommend
If use @Output not use Subject
### 9. Wrap Up

## 14. Course Project - Observables
EventEmitter push new info from A to B
Vào app.component.ts vaf .html xóa hàm onNavigate

shopping-list
```ts
export class ShoppingListService {
  // add
  ingredientsChanged = new Subject<Ingredient[]>();
  ```
 thay hết emit => next

shopping-list.component.ts
```ts
export class ShoppingListComponent implements OnInit, OnDestroy {
  ingredients: Ingredient[];
  private igChangeSub: Subscription;

  constructor(private slService: ShoppingListService) {
  }

  ngOnInit() {
    this.ingredients = this.slService.getIngredients();
    this.igChangeSub = this.slService.ingredientsChanged
      .subscribe(
        (ingredients: Ingredient[]) => {
          this.ingredients = ingredients;
        }
      );
  }

// Add
  ngOnDestroy(): void {
    this.igChangeSub.unsubscribe();
  }
}

 xóa recipeSelected = new EventEmitter<Recipe>(); trong service và 
recipes component

```
Xem lai recipes.component.ts xoa vi da add routing in item-recipe
### 1. Improving the Reactive Service with Observables (Subjects)

### 2. Changed the Subscription Name.html
Don't wonder - I changed the igChangeSub property to just subscription. So if you see that name change in code in future videos, that's why. Other than that, nothing changed!
## 15. Handling Forms in Angular Apps

### 1. Module Introduction

### 2. Why do we Need Angular's Help

### 3. Template-Driven (TD) vs Reactive Approach
![](../root/img/2019-11-23-21-58-25.png)

### 4. An Example Form

### 5. TD Creating the Form and Registering the Controls
Import FormsModule
```ts
import { AppComponent } from './app.component';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    // Add
    FormsModule,
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }

```
Sau đó vào thẻ input thêm ngModel(is not two-way data binding) và name attr in HTML
```html
<input
              type="email"
              id="email"
              class="form-control"
              ngModel
              name="email">

```
ngModel tell angular this is a control, not two-way data binding
### 6. TD Submitting and Using the Form
File html
ngSubmit is directive
ngForm tell angular please help me can access the form
```html
      <form (ngSubmit)="onSubmit()" #f="ngForm">

```
`#f="ngForm">` : cho phép truy cập vào form
Nếu để #f thì phải truyền như tham số vào hàm onSubmit, ghi log ra để xem

app.component.ts
```ts
  // step 1
  // <form (ngSubmit)="onSubmit(f)" #f>
  // onSubmit(f: HTMLFormElement) {   Nếu để #f
  //   console.log(f);
  // }
  
  onSubmit(form: NgForm) {
    // form.value
    console.log(form);
  }

```
### 7. TD Understanding Form State
dirty, value, valid, controls
### 8. TD Accessing the Form with @ViewChild
Nếu không truyền tham số vào hàm thì sử dụng @ViewChild => access local ref
```ts

  @ViewChild('f', { static: false }) signupForm: NgForm;

  onSubmit() {
    this.submitted = true;
    this.user.username = this.signupForm.value.userData.username;
    this.user.email = this.signupForm.value.userData.email;
    this.user.secretQuestion = this.signupForm.value.secret;
    this.user.answer = this.signupForm.value.questionAnswer;
    this.user.gender = this.signupForm.value.gender;

    this.signupForm.reset();
  }

```
### 9. TD Adding Validation to check User Input
Thêm require, email => nhập giá trị hợp lên ghi log ra console giá trị valid = true và F12 để kiểm tra angular sẽ thêm các class
email la 1 directive
### 10. Built-in Validators & Using HTML5 Validation.html
Which Validators do ship with Angular? 

Check out the Validators class: https://angular.io/api/forms/Validators - these are all built-in validators, though that are the methods which actually get executed (and which you later can add when using the reactive approach).

For the template-driven approach, you need the directives. You can find out their names, by searching for "validator" in the official docs: https://angular.io/api?type=directive - everything marked with "D" is a directive and can be added to your template.

Additionally, you might also want to enable HTML5 validation (by default, Angular disables it). You can do so by adding the ngNativeValidate  to a control in your template.
### 11. TD Using the Form State
```html
<button
          class="btn btn-primary"
          type="submit"
          [disabled]="!f.valid">Submit</button>

```
File css
```cs
input.ng-invalid.ng-touched {
  border: 1px solid red;
}

```
.ng-touched assure user had clicked in it
### 12. TD Outputting Validation Error Messages
```html
<input
              type="email"
              id="email"
              class="form-control"
              ngModel
              name="email"
              required
              email
              #email="ngModel">
<span class="help-
block" *ngIf="!email.valid && email.touched">Please enter a valid email!</span>

```
Thêm local reference #email=”ngModel”
ngModel is a directive
### 13. TD Set Default Values with ngModel Property Binding
Thêm biến defaultQuestion ở file ts và để ngModel trong dấu [] là prop binding
```html
<div class="form-group">
          <label for="secret">Secret Questions</label>
          <select
            id="secret"
            class="form-control"
            [ngModel]="defaultQuestion"
            name="secret">
            <option value="pet">Your first Pet?</option>
            <option value="teacher">Your first teacher?</option>
          </select>
        </div>

```
### 14. TD Using ngModel with Two-Way-Binding
add html
```html
<div class="form-group">
          <textarea
            name="questionAnswer"
            rows="3"
            class="form-control"
            [(ngModel)]="answer"></textarea>
        </div>
        <p>Your reply: {{ answer }}</p>
```

```ts
defaultQuestion = 'teacher';
  answer = '';

```
3 type:
- No binding: is a control
- One way binding
- Two way binding
### 15. TD Grouping Form Controls
Sử dụng ngModelGroup để group sau này truy cập ra phải .userData
userData is local reference
```html
 <div
          id="user-data"
          // Add
          ngModelGroup="userData"
          #userData="ngModelGroup"> // like  email
          <div class="form-group">
            <label for="username">Username</label>
            <input
              type="text"
              id="username"
              class="form-control"
              ngModel
              name="username"
              required>
          </div>
          <button
            class="btn btn-default"
            type="button"
            (click)="suggestUserName()">Suggest an Username</button>
          <div class="form-group">
            <label for="email">Mail</label>
            <input
              type="email"
              id="email"
              class="form-control"
              ngModel
              name="email"
              required
              email
              #email="ngModel">
            <span class="help-block" *ngIf="!email.valid && email.touched">Please enter a valid email!</span>
          </div>
        </div>
<!--add-->
<p *ngIf="!userData.valid && userData.touched">User Data is invalid!</p>

```

### 16. TD Handling Radio Buttons
  genders = ['male', 'female'];

```html
<div class="radio" *ngFor="let gender of genders">
          <label>
            <input
              type="radio"
              name="gender"
              ngModel
              [value]="gender"
              required>
            {{ gender }}
          </label>
        </div>

```
### 17. TD Setting and Patching Form Values
```ts
suggestUserName() {
    const suggestedName = 'Superuser';
    // this.signupForm.setValue({
    //   userData: {
    //     username: suggestedName,
    //     email: ''
    //   },
    //   secret: 'pet',
    //   questionAnswer: '',
    //   gender: 'male'
    // });

// cách này k ghi đè giá trị da chon
    this.signupForm.form.patchValue({
      userData: {
        username: suggestedName
      }
    });
  }

```
### 18. TD Using Form Data
```html
<div class="row" *ngIf="submitted">
    <div class="col-xs-12">
      <h3>Your Data</h3>
      <p>Username: {{ user.username }}</p>
      <p>Mail: {{ user.email }}</p>
      <p>Secret Question: Your first {{ user.secretQuestion }}</p>
      <p>Answer: {{ user.answer }}</p>
      <p>Gender: {{ user.gender }}</p>
    </div>
  </div>
```

### 19. TD Resetting Forms
```ts
this.signupForm.reset();
// can use set value with obj you want
```
### 20. Practicing Template-Driven Forms.html

### 21. Introduction to the Reactive Approach

### 22. Reactive Setup
```ts
export class AppComponent implements OnInit {
  genders = ['male', 'female'];
  signupForm: FormGroup;

```
khai báo ReactiveFormsModule 
```ts
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { ReactiveFormsModule } from '@angular/forms';

import { AppComponent } from './app.component';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    // Add
    ReactiveFormsModule
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }

```
### 23. Reactive Creating a Form in Code
Sử dụng hàm onInit before render
```ts
ngOnInit() {
    // create control
    this.signupForm = new FormGroup({
      'userData': new FormGroup({
        'username': new FormControl(null, Validators.required),
        'email': new FormControl(null, [Validators.required, Validators.email])
      }),
      'gender': new FormControl('male')
    });
  }

```
New FormControl nhận 2 tham số, thứ nhất là giá trị khởi tạo, in form, tham số thứ 2 là single validator, tham số thứ 3 là potential async validator

### 24. Reactive Syncing HTML and Form
Thông báo sử dụng directive formGroup tham chiếu đến signupForm bằng cách thêm vào thẻ form
Sử dụng directive formControlName thay cho name
Có thể sử dụng [formControlName]="'username'" thay cho formControlName="username"

```html
 <form [formGroup]="signupForm" (ngSubmit)="onSubmit()">
        <div formGroupName="userData">
          <div class="form-group">
            <label for="username">Username</label>
            <input
              type="text"
              id="username"
              formControlName="username"
              class="form-control">
          </div>
          <div class="form-group">
            <label for="email">email</label>
            <input
              type="text"
              id="email"
              formControlName="email"
              class="form-control">
          </div>
        </div>
 <div class="radio" *ngFor="let gender of genders">
          <label>
            <input
              type="radio"
              formControlName="gender"
              [value]="gender">{{ gender }}
          </label>
        </div>

```

### 25. Reactive Submitting the Form
Để submit thì thêm hàm (ngSubmit)="onSubmit()
```ts
onSubmit() {
    console.log(this.signupForm);
    this.signupForm.reset();
  }

```
### 26. Reactive Adding Validation
Nếu muốn config tham số thì truyền tham số ở file ts
```ts
ngOnInit() {
    // create control
    this.signupForm = new FormGroup({
      'userData': new FormGroup({
        'username': new FormControl(null, Validators.required),
        'email': new FormControl(null, [Validators.required, Validators.email])
      }),
      'gender': new FormControl('male')
    });
  }

```
### 27. Reactive Getting Access to Controls
```html
          <span
              *ngIf="!signupForm.get('userData.username').valid && signupForm.get('userData.username').touched"
              class="help-block">
              <!-- <span *ngIf="signupForm.get('userData.username').errors['nameIsForbidden']">This name is invalid!</span>
              <span *ngIf="signupForm.get('userData.username').errors['required']">This field is required!</span> -->
              Invalid name
            </span>

        <span
          *ngIf="!signupForm.valid && signupForm.touched"
          class="help-block">Please enter valid data!</span>
        <button class="btn btn-primary" type="submit">Submit</button>
```

Add css class
```css
input.ng-invalid.ng-touched {
  border: 1px solid red;
}


```
### 28. Reactive Grouping Controls
Tạo form Group để chứa form control 
```html
        <div formGroupName="userData"> </div>

```
### Fixing a Bug
In the next lecture, we'll add some code to access the controls of our form array:

```ts
*ngFor="let hobbyControl of signupForm.get('hobbies').controls; let i = index"

```
This code will fail as of the latest Angular version.

You can fix it easily though. Outsource the "get the controls" logic into a method of your component code (the .ts file):

```ts
getControls() {
  return (<FormArray>this.signupForm.get('hobbies')).controls;
}

```
In the template, you can then use:

```ts
*ngFor="let hobbyControl of getControls(); let i = index"

```
Alternatively, you can set up a getter and use an alternative type casting syntax:

```ts
get controls() {
  return (this.signupForm.get('hobbies') as FormArray).controls;
}

```
and then in the template:

```ts
*ngFor="let hobbyControl of controls; let i = index"

```
This adjustment is required due to the way TS works and Angular parses your templates (it doesn't understand TS there).
### 29. Reactive Arrays of Form Controls (FormArray)
```ts
      'hobbies': new FormArray([])
---

onAddHobby() {
    const control = new FormControl(null, Validators.required);
    (<FormArray>this.signupForm.get('hobbies')).push(control);
  }

```
File html: formArrayName="hobbies" connect
```html
<div formArrayName="hobbies">
          <h4>Your Hobbies</h4>
          <button
            class="btn btn-default"
            type="button"
            (click)="onAddHobby()">Add Hobby</button>
          <div
            class="form-group"
            *ngFor="let hobbyControl of signupForm.get('hobbies').controls; let i = index">
            <input type="text" class="form-control" [formControlName]="i">
          </div>
        </div>

```

### 30. Reactive Creating Custom Validators
```ts
  forbiddenUsernames = ['Chris', 'Anna'];

forbiddenNames(control: FormControl): {[s: string]: boolean} {
    if (this.forbiddenUsernames.indexOf(control.value) !== -1) {
      return {'nameIsForbidden': true};
    }
    return null;
  }


this.signupForm = new FormGroup({
      'userData': new FormGroup({
        'username': new FormControl(null, [Validators.required, 
        // this.forbiddenEmails.bind(this) refers this classthis.forbiddenNames.bind(this)]),
        'email': new FormControl(null, [Validators.required, Validators.email], 
        
        this.forbiddenEmails)
      }),
      'gender': new FormControl('male'),
      'hobbies': new FormArray([])
    });

```
Phải có bind this nó mới hiểu this trong hàm kia
[s: string]: boolean => mean: key: value; key is a string
### 31. Reactive Using Error Codes
```html
<span
              *ngIf="!signupForm.get('userData.username').valid && signupForm.get('userData.username').touched"
              class="help-block">
              <span *ngIf="signupForm.get('userData.username').errors['nameIsForbidden']">This name is invalid!</span>
              <span *ngIf="signupForm.get('userData.username').errors['required']">This field is required!</span>

            </span>

```
F12/ FormGroup/ controls/ userData/ controls/ username/ error
### 32. Reactive Creating a Custom Async Validator
```ts
forbiddenEmails(control: FormControl): Promise<any> | Observable<any> 
{
    const promise = new Promise<any>((resolve, reject) => {
      setTimeout(() => {
        if (control.value === 'test@test.com') {
          resolve({'emailIsForbidden': true});
        } else {
          resolve(null);
        }
      }, 1500);
    });
    return promise;
  }

```
### 33. Reactive Reacting to Status or Value Changes
Try it
```ts
ngOnInit() {
    // add
    // this.signupForm.valueChanges.subscribe(
    //   (value) => console.log(value)
    // );
    this.signupForm.statusChanges.subscribe(
      (status) => console.log(status)
    );
}
```
### 34. Reactive Setting and Patching Values
```ts
// intitial
this.signupForm.setValue({
      'userData': {
        'username': 'Max',
        'email': 'max@test.com'
      },
      'gender': 'male',
      'hobbies': []
    });
    // only set this field
    this.signupForm.patchValue({
      'userData': {
        'username': 'Anna',
      }
    });

// cách 2
    this.signupForm.reset();
có thẻ chỉ rõ field cần reset in oject in reset({}) to don't clear radio button

```
### 35. Practicing Reactive Forms.html

### 36. [OPTIONAL] Assignment Solution
```html
 <form [formGroup]="projectForm" (ngSubmit)="onSaveProject()">
        <div class="form-group">
          <label for="name">Project Name</label>
          <input
            type="text"
            id="name"
            formControlName="projectName"
            class="form-control">
        </div>
        <div class="form-group">
          <label for="email">Mail</label>
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-control">
        </div>
        <div class="form-group">
          <label for="status">Projectstatus</label>
          <select
            id="status"
            formControlName="projectStatus"
            class="form-control">
            <option value="stable">Stable</option>
            <option value="critical">Critical</option>
            <option value="finished">Finished</option>
          </select>
        </div>
        <button class="btn btn-primary" type="submit">Create Project</button>
      </form>
```
ts
```ts
ngOnInit() {
    this.projectForm = new FormGroup({
      'projectName': new FormControl(
        null,
        [Validators.required, CustomValidators.invalidProjectName],
        CustomValidators.asyncInvalidProjectName
      ),
      'email': new FormControl(null, [Validators.required, Validators.email]),
      'projectStatus': new FormControl('critical')
    });
  }
```
## 16. Course Project - Forms

### 1. Introduction
### 2. TD Adding the Shopping List Form
shopping-edit.component.html
Nhớ khai báo FormModule trước
Không cần sử dụng local ref như cũ thêm ngForm và name
```html
<form (ngSubmit)="onSubmit(f)" #f="ngForm">
      <div class="row">
        <div class="col-sm-5 form-group">
          <label for="name">Name</label>
          <input
            type="text"
            id="name"
            class="form-control"
            name="name"
            ngModel
          >
        </div>
        <div class="col-sm-2 form-group">
          <label for="amount">Amount</label>
          <input
            type="number"
            id="amount"
            class="form-control"
            name="amount"
            ngModel
          >
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <button
            class="btn btn-success"
            type="submit"
            [disabled]="!f.valid">{{ editMode ? 'Update' : 'Add' }}</button>
          
        </div>
      </div>
    </form>

```
shopping-edit.component.ts
```ts
onSubmit(form: NgForm) {
    const value = form.value;
    const newIngredient = new Ingredient(value.name, value.amount);

```
### 3. Adding Validation to the Form
```html
<div class="col-sm-2 form-group">
          <label for="amount">Amount</label>
          <input
            type="number"
            id="amount"
            class="form-control"
            name="amount"
            ngModel
            <!-- add -->
            required
            pattern="^[1-9]+[0-9]*$"
          >
        </div>

```
Check số dương bằng pattern
### 4. Allowing the Selection of Items in the List
shopping-list.component.html thêm event onEditItem
```html
<a
        class="list-group-item"
        style="cursor: pointer"
        *ngFor="let ingredient of ingredients; let i = index"
        (click)="onEditItem(i)"
      >
        {{ ingredient.name }} ({{ ingredient.amount }})
      </a>

```
shopping-list.component.ts
```ts
onEditItem(index: number) {
    this.slService.startedEditing.next(index); // emit event
  }

```
shopping-list.service.ts 
Thêm   `startedEditing = new Subject<number>();`

shopping-edit.component.ts lắng nghe lấy ra item mà click đổ data vào form
```ts
  @ViewChild('f', { static: false }) slForm: NgForm; // local ref
  subscription: Subscription;
  editMode = false;
  editedItemIndex: number;
  editedItem: Ingredient;

  constructor(private slService: ShoppingListService) { }

  ngOnInit() {
    this.subscription = this.slService.startedEditing
      .subscribe(
        (index: number) => {
          this.editedItemIndex = index;
          this.editMode = true;
          this.editedItem = this.slService.getIngredient(index);
          // set value to form
          this.slForm.setValue({
            name: this.editedItem.name,
            amount: this.editedItem.amount
          })
        }
      );
  }

  ngOnDestroy() {
    this.subscription.unsubscribe();
  }

```
### 5. Loading the Shopping List Items into the Form
shopping-list.service.ts 
```ts
getIngredient(index: number) {
    return this.ingredients[index];
  }

```
### 6. Updating existing Items
Hiển thị đúng tên btn khi edit
```html
<button
            class="btn btn-success"
            type="submit"
            [disabled]="!f.valid">{{ editMode ? 'Update' : 'Add' }}</button>

```
Service
```ts
updateIngredient(index: number, newIngredient: Ingredient) {
    this.ingredients[index] = newIngredient;
    this.ingredientsChanged.next(this.ingredients.slice());
  }

```
shopping-edit.component.ts
```ts
onSubmit(form: NgForm) {
    const value = form.value;
    const newIngredient = new Ingredient(value.name, value.amount);
    if (this.editMode) {
      // add
      this.slService.updateIngredient(this.editedItemIndex, newIngredient);
    } else {
      this.slService.addIngredient(newIngredient);
    }
    this.editMode = false;
    form.reset();
  }

```
### 7. Resetting the Form
Hàm add
```ts
    this.editMode = false;    
    form.reset(); // clear

```
### 8. Allowing the the User to Clear (Cancel) the Form
```ts
onClear() {
    this.slForm.reset();
    this.editMode = false;
  }

```
### 9. Allowing the Deletion of Shopping List Items
```html
<button
            class="btn btn-danger"
            type="button"
            (click)="onDelete()"
            <!-- add -->
            *ngIf="editMode">Delete</button>

```
```ts
onDelete() {
    this.slService.deleteIngredient(this.editedItemIndex);
    this.onClear();
  }

 // Service
deleteIngredient(index: number) {
    this.ingredients.splice(index, 1);
    this.ingredientsChanged.next(this.ingredients.slice());
  }

```
### 10. Creating the Template for the (Reactive) Recipe Edit Form
Cách 2
recipe-edit.component.html tạo template bình thường
Nhớ khai báo ReactiveFormModule

### 11. Creating the Form For Editing Recipes
Tạo hàm init
```ts
private initForm() {
    let recipeName = '';
    let recipeImagePath = '';
    let recipeDescription = '';
    let recipeIngredients = new FormArray([]);

    if (this.editMode) {
      const recipe = this.recipeService.getRecipe(this.id);
      recipeName = recipe.name;
      recipeImagePath = recipe.imagePath;
      recipeDescription = recipe.description;
	// thêm sau
      if (recipe['ingredients']) {
        for (let ingredient of recipe.ingredients) {
          recipeIngredients.push(
            new FormGroup({
              'name': new FormControl(ingredient.name, Validators.required),
              'amount': new FormControl(ingredient.amount, [
                Validators.required,
                Validators.pattern(/^[1-9]+[0-9]*$/)
              ])
            })
          );
        }
      }
    }

    this.recipeForm = new FormGroup({
      'name': new FormControl(recipeName, Validators.required),
      'imagePath': new FormControl(recipeImagePath, Validators.required),
      'description': new FormControl(recipeDescription, Validators.required),
      'ingredients': recipeIngredients
    });
  }

```
### 12. Syncing HTML with the Form
import ReactiveFormsModule
Thêm FormControlName, FormGroup vào file html
### 13. Adding Ingredient Controls to a Form Array
```html
<div class="row">
        <div class="col-xs-12" formArrayName="ingredients">
          <div
            class="row"
            *ngFor="let ingredientCtrl of recipeForm.get('ingredients').controls; let i = index"
            [formGroupName]="i"
            style="margin-top: 10px;">
            <div class="col-xs-8">
              <input
                type="text"
                class="form-control"
                formControlName="name">
            </div>
            <div class="col-xs-2">
              <input
                type="number"
                class="form-control"
                formControlName="amount">
            </div>
            <div class="col-xs-2">
              <button
                type="button"
                class="btn btn-danger"
                (click)="onDeleteIngredient(i)">X</button>
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-xs-12">
              <button
                type="button"
                class="btn btn-success"
                (click)="onAddIngredient()">Add Ingredient</button>
            </div>
          </div>
        </div>
      </div>
```
### 14. Fixing a Bug.html
Fixing a Bug
In the next lecture, we'll add some code to access the controls of our form array:

```ts
*ngFor="let ingredientCtrl of recipeForm.get('ingredients').controls; let i = index"

```
This code will fail with the latest Angular version.

You can fix it easily though. Outsource the "get the controls" logic into a getter of your component code (the .ts file):

```ts
get controls() { // a getter!
  return (<FormArray>this.recipeForm.get('ingredients')).controls;
}

```
In the template, you can then use:

```ts
*ngFor="let ingredientCtrl of controls; let i = index"

```
This adjustment is required due to the way TS works and Angular parses your templates (it doesn't understand TS there).
### 15. Adding new Ingredient Controls
```ts
onAddIngredient() {
    (<FormArray>this.recipeForm.get('ingredients')).push(
      new FormGroup({
        'name': new FormControl(null, Validators.required),
        'amount': new FormControl(null, [
          Validators.required,
          Validators.pattern(/^[1-9]+[0-9]*$/)
        ])
      })
    );
  }

```
### 16. Validating User Input
File css
```css
input.ng-invalid.ng-touched,
textarea.ng-invalid.ng-touched {
  border: 1px solid red;
}

```
### 17. Submitting the Recipe Edit Form
recipe-edit.component.ts
```ts
onSubmit() {
    // const newRecipe = new Recipe(
    //   this.recipeForm.value['name'],
    //   this.recipeForm.value['description'],
    //   this.recipeForm.value['imagePath'],
    //   this.recipeForm.value['ingredients']);
    if (this.editMode) {
      this.recipeService.updateRecipe(this.id, this.recipeForm.value);
    } else {
      this.recipeService.addRecipe(this.recipeForm.value);
    }
    this.onCancel();
  }

```
Service
```ts
  recipesChanged = new Subject<Recipe[]>();

addRecipe(recipe: Recipe) {
    this.recipes.push(recipe);
    this.recipesChanged.next(this.recipes.slice());
  }

  updateRecipe(index: number, newRecipe: Recipe) {
    this.recipes[index] = newRecipe;
    this.recipesChanged.next(this.recipes.slice());
  }

  deleteRecipe(index: number) {
    this.recipes.splice(index, 1);
    this.recipesChanged.next(this.recipes.slice());
  }

```
recipe-list.component.ts
```ts
ngOnInit() {
    this.subscription = this.recipeService.recipesChanged
      .subscribe(
        (recipes: Recipe[]) => {
          this.recipes = recipes;
        }
      );
    this.recipes = this.recipeService.getRecipes();
  }

```
### 18. Adding a Delete and Clear (Cancel) Functionality
recipe-detail
```ts
onDeleteRecipe() {
    this.recipeService.deleteRecipe(this.id);
    this.router.navigate(['/recipes']);
  }

```
recipe-edit
```ts
// after submit call this.onCancel();
onCancel() {
    this.router.navigate(['../'], {relativeTo: this.route});
  }

```
### 19. Redirecting the User (after Deleting a Recipe)


### 20. Adding an Image Preview
Thêm local ref imagePath; truy cập imagePath.value
```html
<div class="row">
        <div class="col-xs-12">
          <div class="form-group">
            <label for="imagePath">Image URL</label>
            <input
              type="text"
              id="imagePath"
              formControlName="imagePath"
              class="form-control"
              <!-- add -->
              #imagePath>
          </div>
        </div>
      </div>
      <!-- add -->
      <div class="row">
        <div class="col-xs-12">
          <img [src]="imagePath.value" class="img-responsive">
        </div>
      </div>

```
### 21. Providing the Recipe Service Correctly
Khai báo service trong module để đảm bảo có 1 instance được tạo k khia bao trong recipes vi di chuyen qua shopping list se mat
```ts
  providers: [ShoppingListService, RecipeService],

```
### 22. Deleting Ingredients and Some Finishing Touches
recipe-edit.component
```ts
onDeleteIngredient(index: number) {
    (<FormArray>this.recipeForm.get('ingredients')).removeAt(index);
  }

```
Thêm recipe-list.component
```ts
ngOnDestroy() {
    this.subscription.unsubscribe();
  }

```
### 23. Deleting all Items in a FormArray.html
Deleting all Items in a FormArray
As of Angular 8, there's a new way of clearing all items in a FormArray.

```ts
(<FormArray>this.recipeForm.get('ingredients')).clear();

```
The clear() method automatically loops through all registered FormControls (or FormGroups) in the FormArray and removes them.

It's like manually creating a loop and calling removeAt() for every item.

## 17. Using Pipes to Transform Output

### 1. Introduction & Why Pipes are Useful

Pipe: Transform output value to out template
### 2. Using Pipes
Thay đổi
```html
<strong>{{ server.name | shorten:15 }}</strong> |
          {{ server.instanceType | uppercase }} |
          {{ server.started | date:'fullDate' | uppercase }}

```
### 3. Parametrizing Pipes
**date:'fullDate'**

https://angular.io/guide/pipes
https://angular.io/api?query=pipe

### 4. Where to learn more about Pipes

### 5. Chaining Multiple Pipes
Lưu ý thứ tự từ trái qua phải
### 6. Creating a Custom Pipe
Tạo file shorten.pipe.ts
```ts
import { Pipe, PipeTransform } from '@angular/core';

@Pipe({
  name: 'shorten'
})
export class ShortenPipe implements PipeTransform {
  transform(value: any, limit: number) {
    if (value.length > limit) {
      return value.substr(0, limit) + ' ...';
    }
    return value;
  }
}

```

Khai báo
```ts
declarations: [
    AppComponent,
    ShortenPipe,
    FilterPipe
  ],

```
### 7. Parametrizing a Custom Pipe
Neu nhieu tham so: shorten:15:12
### 8. Example Creating a Filter Pipe
```html
      <input type="text" [(ngModel)]="filteredStatus">

```
Gõ
```ts
ng generate pipe filter
ng g p filter

```
filter.pipe.ts
```ts
import { Pipe, PipeTransform } from '@angular/core';

@Pipe({
  name: 'filter',
  pure: false
})
export class FilterPipe implements PipeTransform {

  transform(value: any, filterString: string, propName: string): any {
    if (value.length === 0 || filterString === '') {
      return value;
    }
    const resultArray = [];
    for (const item of value) {
      if (item[propName] === filterString) {
        resultArray.push(item);
      }
    }
    return resultArray;
  }

}

```
Must import
```html
<li
          class="list-group-item"
          *ngFor="let server of servers | filter:filteredStatus:'status'"
          [ngClass]="getStatusClasses(server)">

```
### 9. Pure and Impure Pipes (or How to fix the Filter Pipe)
Khi thêm mới server khi bam nut ADD, filter sẽ không update nên cần thêm  pure: false nó sẽ tính toán lại khi bất cứ thay đổi nào happen => affect performance NG

```ts
@Pipe({
  name: 'filter',
  pure: false
})
// Update array or object doesn't trigger it
```
### 10. Understanding the async Pipe
app.component.ts
```ts
appStatus = new Promise((resolve, reject) => {
    setTimeout(() => {
      resolve('stable');
    }, 2000);
  });

```
```html
<!-- Print data after 2s -->
      <h2>App Status: {{ appStatus | async}}</h2>

```
### 11. Practicing Pipes.html

## 18. Making Http Requests

### 1. A New IDE

### 3. How Does Angular Interact With Backends

![](../root/img/2019-11-25-21-29-49.png)
https://academind.com/learn/javascript/hide-javascript-code/
https://academind.com/learn/node-js/building-a-restful-api-with/

### 3.1 Securing JS Code.html

### 3.2 Building a REST API.html

### 4. The Anatomy of a Http Request
![](../root/img/2019-11-25-21-27-24.png)

### 5. Backend (Firebase) Setup
https://console.firebase.google.com/?pli=1

Create project/ input name ng-complete-guide
![](../root/img/2019-11-25-21-55-17.png)  
![](../root/img/2019-11-25-21-56-23.png)

Vao tab database(It's a complete back-end service)
![](../root/img/2019-11-25-21-58-49.png)

Vào mục database/ real time db/ Chọn start in test mode
![](../root/img/2019-11-25-21-59-14.png)
https://ng-complete-guide-35524.firebaseio.com/

https://console.firebase.google.com/project/ng-complete-guide-35524/database/ng-complete-guide-35524/data

### 6. Sending a POST Request
6.1 http-02-post-requests.zip
```ts
  constructor(private http: HttpClient) {}

onCreatePost(postData: { title: string; content: string }) {
    // Send Http request
    this.http
      .post(
        'https://ng-complete-guide-c56d3.firebaseio.com/posts.json',
        postData
      )
      .subscribe(responseData => {
        console.log(responseData);
      });
  }
// neu k subscribe, no se k gui request
// F12 OPTIONS check post req allow
```
Import HttpClientModule
```ts
@NgModule({
  declarations: [AppComponent],
  imports: [BrowserModule, FormsModule, HttpClientModule],
  providers: [],
  bootstrap: [AppComponent]
})

```
F12 vào tab network để check, hàm post return a Observable 

### 7. GETting Data
Fetch data làm như post
```ts
private fetchPosts() {
    this.http
      .get('https://ng-complete-guide-c56d3.firebaseio.com/posts.json')
      .subscribe(posts => {
        // ...
        console.log(posts);
      });
  }
}
```
### 8. Using RxJS Operators to Transform Response Data
```ts
private fetchPosts() {
    this.http
      .get('https://ng-complete-guide-c56d3.firebaseio.com/posts.json')
      .pipe(  // add
        map(responseData => {
          const postsArray = [];
          for (const key in responseData) {
            if (responseData.hasOwnProperty(key)) {
              postsArray.push({ ...responseData[key], id: key });
            }
          }
          return postsArray;
        })
      )
      .subscribe(posts => {
        // ...
        console.log(posts);
      });
  }

```
### 9. Using Types with the HttpClient
model
```ts
export interface Post {
  title: string;
  content: string;
  id?: string;
}
```

```ts
.get<{ [key: string]: Post }> 
// nghĩa là 1 key có kiểu string sẽ có gtri là Post

this.http
      .post<{ name: string }>
```
### 10. Outputting Posts
```ts
 <div class="col-xs-12 col-md-6 col-md-offset-3">
      <p *ngIf="loadedPosts.length < 1 && !isFetching">No posts available!</p>
      <ul class="list-group" *ngIf="loadedPosts.length >= 1 && !isFetching">
        <li class="list-group-item" *ngFor="let post of loadedPosts">
          <h3>{{ post.title }}</h3>
          <p>{{ post.content }}</p>
        </li>
      </ul>
      <p *ngIf="isFetching">Loading...</p>
    </div>
```
### 11. Showing a Loading Indicator
```ts
<p *ngIf="loadedPosts.length < 1 && !isFetching">No posts available!
</p>

```
### 12. Using a Service for Http Requests
posts.service.ts
```ts
@Injectable({ providedIn: 'root' })
export class PostsService {
  error = new Subject<string>();

  constructor(private http: HttpClient) {}

  createAndStorePost(title: string, content: string) {
    const postData: Post = { title: title, content: content };
    this.http
      .post<{ name: string }>(
        'https://ng-complete-guide-c56d3.firebaseio.com/posts.json',
        postData
      )
      .subscribe(
        responseData => {
          console.log(responseData);
        }
      );
  }

  fetchPosts() {
    let searchParams = new HttpParams();
    searchParams = searchParams.append('print', 'pretty');
    searchParams = searchParams.append('custom', 'key');
    return this.http
      .get<{ [key: string]: Post }>(
        'https://ng-complete-guide-c56d3.firebaseio.com/posts.json'
      )
      .pipe(
        map(responseData => {
          const postsArray: Post[] = [];
          for (const key in responseData) {
            if (responseData.hasOwnProperty(key)) {
              postsArray.push({ ...responseData[key], id: key });
            }
          }
          return postsArray;
        })
      );
  }

----

```
//
 lost connection between data from service and template
### 13. Services & Components Working Together
```ts
constructor(private http: HttpClient, private postsService: 
PostsService) {}

  onFetchPosts() {
    // Send Http request
    this.isFetching = true;
    this.postsService.fetchPosts().subscribe(
      posts => {
        this.isFetching = false;
        this.loadedPosts = posts;
      },
      error => {
        this.error = error.message;
        console.log(error);
      }
    );
  }
```
### 14. Sending a DELETE Request
```ts
onClearPosts() {
    // Send Http request
    this.postsService.deletePosts().subscribe(() => {
      this.loadedPosts = [];
    });
  }

----
// Service
deletePosts() {
    return this.http
      .delete('https://ng-complete-guide-c56d3.firebaseio.com/posts.json');
}

```
### 15. Handling Errors
![](../root/img/2019-11-26-00-30-02.png)
read : false
```ts
ngOnInit() {
    this.isFetching = true;
    this.postsService.fetchPosts().subscribe(
      posts => {
        this.isFetching = false;
        this.loadedPosts = posts;
      },
      // Add
      error => {
        this.isFetching = false;
        this.error = error.message;
        console.log(error);
      }
    );
  }
```
### 16. Using Subjects for Error Handling
service
```ts
error = new Subject<string>();
  createAndStorePost(title: string, content: string) {
    const postData: Post = { title: title, content: content };
    this.http
      .post<{ name: string }>(
        'https://ng-complete-guide-c56d3.firebaseio.com/posts.json',
        postData,
        {
          observe: 'response'
        }
      )
      .subscribe(
        responseData => {
          console.log(responseData);
        },
        // Add
        error => {
          this.error.next(error.message);
        }
      );
  }
```

app.component.ts
```ts
// Add trong ham onInit
this.errorSub = this.postsService.error.subscribe(errorMessage => {
      this.error = errorMessage;
    });
// Destroy
```
### 17. Using the catchError Operator
service
```ts
fetchPosts() {
    // let searchParams = new HttpParams();
    // searchParams = searchParams.append('print', 'pretty');
    // searchParams = searchParams.append('custom', 'key');
    return this.http
      .get<{ [key: string]: Post }>(
        'https://ng-complete-guide-c56d3.firebaseio.com/posts.json',
        // {
        //   headers: new HttpHeaders({ 'Custom-Header': 'Hello' }),
        //   params: searchParams,
        //   responseType: 'json'
        // }
      )
      .pipe(
        map(responseData => {
          const postsArray: Post[] = [];
          for (const key in responseData) {
            if (responseData.hasOwnProperty(key)) {
              postsArray.push({ ...responseData[key], id: key });
            }
          }
          return postsArray;
        }),
        // add
        catchError(errorRes => {
          // Send to analytics server
          return throwError(errorRes);
        })
      );
  }

```

### 18. Error Handling & UX
app
```ts
onFetchPosts() {
    // Send Http request
    this.isFetching = true;
    this.postsService.fetchPosts().subscribe(
      posts => {
        this.isFetching = false;
        this.loadedPosts = posts;
      },
      
      // Add
      error => {
        this.isFetching = false;
        this.error = error.message;
        console.log(error);
      }
    );
  }

onHandleError() {
    this.error = null;
  }
```
### 19. Setting Headers
```ts
 let searchParams = new HttpParams();
    searchParams = searchParams.append('print', 'pretty');
    searchParams = searchParams.append('custom', 'key');
return this.http
      .get<{ [key: string]: Post }>(
        'https://ng-complete-guide-c56d3.firebaseio.com/posts.json',
        {
          headers: new HttpHeaders({ 'Custom-Header': 'Hello' }),
          params: searchParams,
          responseType: 'json'
        }
      )
```
### 20. Adding Query Params

### 21. Observing Different Types of Responses
Có thể observe là body để chỉ nhận body, response để xem nhiều thứ khác như stt code
```ts
this.http
      .post<{ name: string }>(
        'https://ng-complete-guide-c56d3.firebaseio.com/posts.json',
        postData,
        {
          observe: 'response'  // 'body'
        }
      )
      // convert to js object

deletePosts() {
    return this.http
      .delete('https://ng-complete-guide-c56d3.firebaseio.com/posts.json', {
        observe: 'events',
        responseType: 'text'
      })
      .pipe(
        // execute without altering the response
        tap(event => {
          console.log(event);
          if (event.type === HttpEventType.Sent) {
            // ...
          }
          if (event.type === HttpEventType.Response) {
            console.log(event.body);
          }
        })
      );
  }
```
### 22. Changing the Response Body Type

### 23. Introducing Interceptors
auth-interceptor.service
```ts
import { HttpInterceptor, HttpRequest, HttpHandler } from '@angular/co
mmon/http';

export class AuthInterceptorService implements HttpInterceptor {
  intercept(req: HttpRequest<any>, next: HttpHandler) {
    console.log('Request is on its way');
    // let req continue run
    return next.handle(req);
  }
}


```
Chay truoc khi req leave app => send
Khai báo:
```ts
providers: [
    {
      provide: HTTP_INTERCEPTORS, // this is a token
      useClass: AuthInterceptorService,
      multi: true // not replace exist intercepters
    }
  ],

```
### 24. Manipulating Request Objects
Khi muốn thay đổi request obj 
```ts
export class AuthInterceptorService implements HttpInterceptor {
  intercept(req: HttpRequest<any>, next: HttpHandler) {
    const modifiedRequest = req.clone({
      headers: req.headers.append('Auth', 'xyz')
    });
    console.log(req.url);
    return next.handle(modifiedRequest);
  }
}
```
### 25. Response Interceptors
Có thể thay đổi response
![](../root/img/2019-11-26-01-43-47.png)
### 26. Multiple Interceptors
Tạo file logging-intercepter.service.ts
```ts
import {
  HttpInterceptor,
  HttpRequest,
  HttpHandler,
  HttpEventType
} from '@angular/common/http';
import { tap } from 'rxjs/operators';

export class LoggingInterceptorService implements HttpInterceptor {
  intercept(req: HttpRequest<any>, next: HttpHandler) {
    console.log('Outgoing request');
    console.log(req.url);
    console.log(req.headers);
    return next.handle(req).pipe(
      tap(event => {
        if (event.type === HttpEventType.Response) {
          console.log('Incoming response');
          console.log(event.body);
        }
      })
    );
  }
}

// Add - Luu y thu tu
providers: [
    {
      provide: HTTP_INTERCEPTORS,
      useClass: LoggingInterceptorService,
      multi: true
    },
    {
      provide: HTTP_INTERCEPTORS,
      useClass: AuthInterceptorService,
      multi: true
    }
  ],
```
### 27. Wrap Up

### 28. Useful Resources & Links.html

## 19. Course Project - Http

### 1. Module Introduction
SAVE AND FETCH in header
### 2. Backend (Firebase) Setup
Project name: ng-course-recipe-book / real time db
### 3. Setting Up the DataStorage Service

### 4. Storing Recipes
data-storage.service.ts ở header active 2 button
```ts
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { map } from 'rxjs/operators';

import { Recipe } from '../recipes/recipe.model';
import { RecipeService } from '../recipes/recipe.service';

@Injectable({ providedIn: 'root' })
export class DataStorageService {
  constructor(private http: HttpClient, private recipeService: RecipeService) {}

  storeRecipes() {
    const recipes = this.recipeService.getRecipes();
    this.http
      .put(
        'https://ng-course-recipe-book-65f10.firebaseio.com/recipes.json',
        recipes
      )
      .subscribe(response => {
        console.log(response);
      });
  }

  fetchRecipes() {
    this.http
      .get<Recipe[]>(
        'https://ng-course-recipe-book-65f10.firebaseio.com/recipes.json'
      )
      // add => always have ingredients
      .pipe(
        map(recipes => {
          // map step2 is an arraya func
          return recipes.map(recipe => {
            return {
              ...recipe,
              ingredients: recipe.ingredients ? recipe.ingredients : []
            };
          });
        })
      )
      // end add
      .subscribe(recipes => {
        this.recipeService.setRecipes(recipes);
      });
  }
}

```

Nhớ import HttpClientModule

recipe.service.ts
```ts
private recipes: Recipe[] = [];

setRecipes(recipes: Recipe[]) {
    this.recipes = recipes;
    this.recipesChanged.next(this.recipes.slice());
  }
```
### 5. Fetching Recipes

### 6. Transforming Response Data

### 7. Resolving Data Before Loading
O page detail an reload => fail
boi vi khi k an nut FETCH DATA thi khi data empty o page detail => reload detail => fail
recipes-resolver.service
```ts
import { Injectable } from '@angular/core';
import {
  Resolve,
  ActivatedRouteSnapshot,
  RouterStateSnapshot
} from '@angular/router';

import { Recipe } from './recipe.model';
import { DataStorageService } from '../shared/data-storage.service';
import { RecipeService } from './recipe.service';

@Injectable({ providedIn: 'root' })
export class RecipesResolverService implements Resolve<Recipe[]> {
  constructor(
    private dataStorageService: DataStorageService,
    private recipesService: RecipeService
  ) {}

  resolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot) {
    const recipes = this.recipesService.getRecipes();

    if (recipes.length === 0) {
      // Always get new one step 8
      return this.dataStorageService.fetchRecipes();
    } else {
      return recipes;
    }
  }
}


```
data-storage.service.ts
```ts
fetchRecipes() {
    return this.http
      .get<Recipe[]>(
        'https://ng-course-recipe-book-65f10.firebaseio.com/recipes.json'
      )
      .pipe(
        map(recipes => {
          return recipes.map(recipe => {
            return {
              ...recipe,
              ingredients: recipe.ingredients ? recipe.ingredients : []
            };
          });
        }),
        // add
        tap(recipes => {
          this.recipeService.setRecipes(recipes);
        })
      )
  }

  // header.component.ts
  onFetchData() {
    this.dataStorageService.fetchRecipes().subscribe();
  }
```
routing
```ts
children: [
      { path: '', component: RecipeStartComponent },
      { path: 'new', component: RecipeEditComponent },
      {
        path: ':id',
        component: RecipeDetailComponent,
        resolve: [RecipesResolverService]
      },
      {
        path: ':id/edit',
        component: RecipeEditComponent,
        resolve: [RecipesResolverService]
      }
    ]

```
### 8. Fixing a Bug with the Resolver
edit not save
## 20. Authentication & Route Protection in Angular

### 1. Module Introduction

### 2. How Authentication Works
Happen in the server not client 
Traditional web using session but in angular we will handle with angular and its router, Server is Rest API  
Server and client is decouple

RestAPI là stateless vì vậy server không quan tâm đến client nên session không được sử dụng => token: string được mã hóa và giải mã bởi client, token được tạo ra ở server và mã hóa bằng thuật toán chỉ có server biết
Chỉ có server có thể validate incoming token 
![](../root/img/2019-11-26-23-19-19.png)

### 3. Adding the Auth Page
auth.component.html
```html
<div class="row">
  <div class="col-xs-12 col-md-6 col-md-offset-3">
    <form>
      <div class="form-group">
        <label for="email">E-Mail</label>
        <input type="email" id="email" class="form-control" />
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" id="password" class="form-control" />
      </div>
      <div>
        <button class="btn btn-primary">Sign Up</button> |
        <button class="btn btn-primary">Switch to Login</button>
      </div>
    </form>
  </div>
</div>

```

auth.component.ts
```ts
import { Component } from '@angular/core';

@Component({
  selector: 'app-auth',
  templateUrl: './auth.component.html'
})
export class AuthComponent {}

```

Nhớ khai báo component
Routing
```ts
  { path: 'shopping-list', component: ShoppingListComponent },
  { path: 'auth', component: AuthComponent }

```
Vào header thêm
```html
<li routerLinkActive="active">
          <a routerLink="/auth">Authenticate</a>
        </li>

```
### 4. Switching Between Auth Modes
```ts
export class AuthComponent {
  isLoginMode = true;

  onSwitchMode() {
    this.isLoginMode = !this.isLoginMode;
  }

  onSubmit(form: NgForm) {
    console.log(form.value);
    form.reset();
  }
}

```
File auth.component.html
```html
<form #authForm="ngForm" (ngSubmit)="onSubmit(authForm)">
      <div class="form-group">
        <label for="email">E-Mail</label>
        <input
          type="email"
          id="email"
          class="form-control"
          ngModel
          name="email"
          required
          email
        />
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input
          type="password"
          id="password"
          class="form-control"
          ngModel
          name="password"
          required
          minlength="6"
        />
      </div>
      <div>
        <button
          class="btn btn-primary"
          type="submit"
          [disabled]="!authForm.valid"
        >
          {{ isLoginMode ? 'Login' : 'Sign Up' }}
        </button>
        |
        <button class="btn btn-primary" (click)="onSwitchMode()" type="button">
          Switch to {{ isLoginMode ? 'Sign Up' : 'Login' }}
        </button>
      </div>
    </form>

```
### 5. Handling Form Input

### 6. Preparing the Backend
Vao database/ rule/ 
```js
{
  "read": "auth != null",
  "write": "auth != null"
}

```
![](../root/img/2019-11-27-00-25-19.png)

Authen... / set up the sign in method
![](../root/img/2019-11-27-00-37-11.png)
SAVE sau do vao tab USER

### 7. Make sure you got Recipes in your backend!.html
Make sure you got Recipes in your backend!
In order to continue with this module and send successful authenticated requests, you need to ensure that you got recipes stored in your backend database.

So in case you deleted those (or never added any), make sure you do add some recipes before you turn on protection as shown in the last lecture!
### 8. Preparing the Signup Request
GG: firebase auth rest api
https://firebase.google.com/docs/reference/rest/auth/

Xem Endpoint

### 9. Sending the Signup Request
auth-03-signup-request
Sign up with email / password
![](../root/img/2019-11-27-00-45-22.png)
get key from Project setting copy web api key paste vào url
auth.service.ts
```ts
interface AuthResponseData {
  kind: string;
  idToken: string;
  email: string;
  refreshToken: string;
  expiresIn: string;
  localId: string;
}

@Injectable({ providedIn: 'root' })
export class AuthService {
  constructor(private http: HttpClient) {}

  signup(email: string, password: string) {
    return this.http
      .post<AuthResponseData>(
        'https://www.googleapis.com/identitytoolkit/v3/relyingparty/signupNewUser?key=[API_KEY]',
        {
          email: email,
          password: password,
          returnSecureToken: true
        }
      );
  }
}

```
auth.component.ts
```ts
onSubmit(form: NgForm) {
    if (!form.valid) {
      return;
    }
    const email = form.value.email;
    const password = form.value.password;

    this.isLoading = true;
    if (this.isLoginMode) {
      // ...
    } else {
      this.authService.signup(email, password).subscribe(
        resData => {
          console.log(resData);
          this.isLoading = false;
        },
        errorMessage => {
          console.log(errorMessage);
          this.error = errorMessage;
          this.isLoading = false;
        }
      );
    }

    form.reset();
  }
```


### 10. Adding a Loading Spinner & Error Handling Logic
GG: css loading spinner
https://loading.io/css/
Vào share tạo folder loading tạo component loading va Khai bao
auth.component.html
```html
  <div class="alert alert-danger" *ngIf="error">
      <p>{{ error }}</p>
    </div>
    <div *ngIf="isLoading" style="text-align: center;">
      <app-loading-spinner></app-loading-spinner>
    </div>
    <form #authForm="ngForm" (ngSubmit)="onSubmit(authForm)" *ngIf="!isLoading">

```
### 11. Improving Error Handling
Xem lại thêm auth-03-signup-request
Hàm sign up auth.service.ts
```ts
signup(email: string, password: string) {
    return this.http
      .post<AuthResponseData>(
        'https://www.googleapis.com/identitytoolkit/v3/relyingparty/signupNewUser?key=AIzaSyDb0xTaRAoxyCgvaDF3kk5VYOsTwB_3o7Y',
        {
          email: email,
          password: password,
          returnSecureToken: true
        }
      )
      .pipe(
        catchError(errorRes => {
          // Ban dau dat trong auth.component.ts ham subscribe
          let errorMessage = 'An unknown error occurred!';
          if (!errorRes.error || !errorRes.error.error) {
            return throwError(errorMessage);
          }
          switch (errorRes.error.error.message) {
            case 'EMAIL_EXISTS':
              errorMessage = 'This email exists already';
          }
          return throwError(errorMessage);
        })
      );
  }

```
auth.component.ts
```ts
if (this.isLoginMode) {
      // ...
    } else {
      this.authService.signup(email, password).subscribe(
        resData => {
          console.log(resData);
          this.isLoading = false;
        },
        errorMessage => {
          console.log(errorMessage);
          this.error = errorMessage;
          this.isLoading = false;
        }
      );
    }

```
### 12. Sending Login Requests
service
```ts
  login(email: string, password: string) {
    return this.http
      .post<AuthResponseData>(
        'https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=AIzaSyDb0xTaRAoxyCgvaDF3kk5VYOsTwB_3o7Y',
        {
          email: email,
          password: password,
          returnSecureToken: true
        }
      )
      .pipe(
        catchError(this.handleError),
        tap(resData => {
          this.handleAuthentication(
            resData.email,
            resData.localId,
            resData.idToken,
            +resData.expiresIn
          );
        })
      );
  }
```
auth.component.ts
```ts
// Add
    let authObs: Observable<AuthResponseData>;

    this.isLoading = true;

    if (this.isLoginMode) {
      authObs = this.authService.login(email, password);
    } else {
      authObs = this.authService.signup(email, password);
    }

    authObs.subscribe(
      resData => {
        console.log(resData);
        this.isLoading = false;
      },
      errorMessage => {
        console.log(errorMessage);
        this.error = errorMessage;
        this.isLoading = false;
      }
    );
    // run meet error
```
### 13. Login Error Handling
sevice
```ts
private handleError(errorRes: HttpErrorResponse) {
    let errorMessage = 'An unknown error occurred!';
    if (!errorRes.error || !errorRes.error.error) {
      return throwError(errorMessage);
    }
    switch (errorRes.error.error.message) {
      case 'EMAIL_EXISTS':
        errorMessage = 'This email exists already';
        break;
      case 'EMAIL_NOT_FOUND':
        errorMessage = 'This email does not exist.';
        break;
      case 'INVALID_PASSWORD':
        errorMessage = 'This password is not correct.';
        break;
    }
    return throwError(errorMessage);
  }

  // add
  .pipe(
        catchError(this.handleError)
      );
```
### 14. Creating & Storing the User Data
Tạo file user.model
```ts
export class User {
  constructor(
    public email: string,
    public id: string,
    private _token: string,
    private _tokenExpirationDate: Date
  ) {}

  get token() { // getter
  // !this._tokenExpirationDate : not exist
    if (!this._tokenExpirationDate || new Date() > this._tokenExpirationDate) {
      return null;
    }
    return this._token;
  }
}
```

auth.service.ts
```ts
  user = new BehaviorSubject<User>(null);


Thêm hàm tap: thực hiện action mà k change response

private handleAuthentication(
    email: string,
    userId: string,
    token: string,
    expiresIn: number
  ) {
    const expirationDate = new Date(new Date().getTime() + expiresIn * 1000); // milisecond
    const user = new User(email, userId, token, expirationDate);
    this.user.next(user);
  }

----
// Add ham signup and login
      .pipe(
        catchError(this.handleError),
        tap(resData => {
          this.handleAuthentication(
            resData.email,
            resData.localId,
            resData.idToken,
            +resData.expiresIn
          );
        })
      );
```

### 15. Reflecting the Auth State in the UI
auth-05-added-token-to-requests
auth.component.ts
```ts
authObs.subscribe(
      resData => {
        console.log(resData);
        this.isLoading = false;
        // Add
        this.router.navigate(['/recipes']);
      },
      errorMessage => {
        console.log(errorMessage);
        this.error = errorMessage;
        this.isLoading = false;
      }
    );
```
Thêm button log out
header.component.ts
```ts
ngOnInit() {
    this.userSub = this.authService.user.subscribe(user => {
      this.isAuthenticated = !!user; // ? false: true
      console.log(!user);
      console.log(!!user);
    });
  }

```
Hien an button fetch...
### 16. Adding the Token to Outgoing Requests
Khi an FETCH DATA gap loi vi firebase cannot know we have a valid token
auth.service.ts
```ts
  user = new BehaviorSubject<User>(null);
  // The difference is that behavior subjects gives subscribers immediate access to the previously emitted value even if they haven't subscribed at the point of time the value was emitted => get lastest user token even if user logged


```

data-storage.service.ts
```ts
fetchRecipes() {
    return this.authService.user.pipe(
      take(1), //take once value from observable and auto unsubcribes
      // exhaustMap is return observable
      exhaustMap(user => {
        return this.http.get<Recipe[]>(
          'https://ng-course-recipe-book-65f10.firebaseio.com/recipes.json',
          {
            params: new HttpParams().set('auth', user.token)
          }
        );
      }),
      map(recipes => {
        return recipes.map(recipe => {
          return {
            ...recipe,
            ingredients: recipe.ingredients ? recipe.ingredients : []
          };
        });
      }),
      tap(recipes => {
        this.recipeService.setRecipes(recipes);
      })
    );
  }
```
### 17. Attaching the Token with an Interceptor
auth-06-logout

Add auth-interceptor.service.ts
```ts
import { Injectable } from '@angular/core';
import {
  HttpInterceptor,
  HttpRequest,
  HttpHandler,
  HttpParams
} from '@angular/common/http';
import { take, exhaustMap } from 'rxjs/operators';

import { AuthService } from './auth.service';

@Injectable()
export class AuthInterceptorService implements HttpInterceptor {
  constructor(private authService: AuthService) {}

  intercept(req: HttpRequest<any>, next: HttpHandler) {
    // this.authService.user is an observable
    return this.authService.user.pipe(
      take(1),
      exhaustMap(user => {
        // if user null cannot access token
        if (!user) {
          return next.handle(req);
        }
        const modifiedReq = req.clone({
          params: new HttpParams().set('auth', user.token)
        });
        // this is an observable
        return next.handle(modifiedReq);
      })
    );
  }
}

```
Khai bao
```ts
providers: [
    ShoppingListService,
    RecipeService,
    // Add
    {
      provide: HTTP_INTERCEPTORS,
      useClass: AuthInterceptorService,
      multi: true
    }
  ],
```

Sau do sua ham fetch data

### 18. Adding Logout
auth.service.ts
```ts
logout() {
    this.user.next(null);
    this.router.navigate(['/auth']);
  }
  // Vao header sua them ham logout
```
### 19. Adding Auto-Login
When we re load a page the app will be reload => use local storage or cookie

auth.service.ts
```ts
// handleAuthentication
// convert to string
localStorage.setItem('userData', JSON.stringify(user));

//
autoLogin() {
    const userData: {
      email: string;
      id: string;
      _token: string;
      _tokenExpirationDate: string;
    } = JSON.parse(localStorage.getItem('userData'));
    if (!userData) {
      return;
    }

    const loadedUser = new User(
      userData.email,
      userData.id,
      userData._token,
      new Date(userData._tokenExpirationDate)
    );

    if (loadedUser.token) {
      this.user.next(loadedUser);
      // end
      const expirationDuration =
        new Date(userData._tokenExpirationDate).getTime() -
        new Date().getTime();
      this.autoLogout(expirationDuration);
    }
  }


```
app.component.ts
```ts
ngOnInit() {
    this.authService.autoLogin();
  }
```
app.component.html
```html
<app-header></app-header>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
```
### 20. Adding Auto-Logout
auth.service.ts
```ts
 private tokenExpirationTimer: any;
logout() {
    this.user.next(null);
    this.router.navigate(['/auth']);

    // Clear
    localStorage.removeItem('userData');
    // when click button logout
    if (this.tokenExpirationTimer) {
      clearTimeout(this.tokenExpirationTimer);
    }
    this.tokenExpirationTimer = null;
  }

autoLogout(expirationDuration: number) {
    this.tokenExpirationTimer = setTimeout(() => {
      this.logout();
    }, expirationDuration); // thya expirationDuration  = 2000 de xem khi log in co log out after 2s
  }
  
// handleAuthentication
// add
this.autoLogout(expiresIn * 1000);
    localStorage.setItem('userData', JSON.stringify(user));
// add autoLogin
```
### 21. Adding an Auth Guard
auth-08-finished
auth.guard.ts
```ts
import {
  CanActivate,
  ActivatedRouteSnapshot,
  RouterStateSnapshot,
  Router,
  UrlTree
} from '@angular/router';
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';
import { map, tap, take } from 'rxjs/operators';

import { AuthService } from './auth.service';

@Injectable({ providedIn: 'root' })
export class AuthGuard implements CanActivate {
  constructor(private authService: AuthService, private router: Router) {}

  canActivate(
    route: ActivatedRouteSnapshot,
    router: RouterStateSnapshot
  ):
    | boolean
    | UrlTree
    | Promise<boolean | UrlTree>
    | Observable<boolean | UrlTree> {
    return this.authService.user.pipe(
      take(1), // take the lastest user them unsubcribed => don't need listen
      map(user => {
        const isAuth = !!user;
        if (isAuth) {
          return true;
        }
        return this.router.createUrlTree(['/auth']);
      })
      // tap(isAuth => {
      //   if (!isAuth) {
      //     this.router.navigate(['/auth']);
      //   }
      // })
    );
  }
}

```
routing
```ts
{
    path: 'recipes',
    component: RecipesComponent,
    // add
    canActivate: [AuthGuard],
    children: [
      { path: '', component: RecipeStartComponent },
      { path: 'new', component: RecipeEditComponent },
      {
        path: ':id',
        component: RecipeDetailComponent,
        resolve: [RecipesResolverService]
      },
      {
        path: ':id/edit',
        component: RecipeEditComponent,
        resolve: [RecipesResolverService]
      }
    ]
  }
```
### 22. Wrap Up

### 23. Useful Resources & Links.html
Useful Resources & Links
Useful Docs:

Firebase Auth REST API Docs: https://firebase.google.com/docs/reference/rest/auth

More on JWT: https://jwt.io

## 21. Dynamic Components

### 1. Module Introduction

### 10. Useful Resources & Links.html
Useful Resources:

Official Docs: https://angular.io/guide/dynamic-component-loader
### 2. Adding an Alert Modal Component
Vào folder share tại component alert
alert.component.html
```html
<div class="backdrop" (click)="onClose()"></div>
<div class="alert-box">
  <p>{{ message }}</p>
  <div class="alert-box-actions">
    <button class="btn btn-primary" (click)="onClose()">Close</button>
  </div>
</div>

```
nho khai bao modules
alert.component.ts
```ts
@Component({
  selector: 'app-alert',
  templateUrl: './alert.component.html', // xem css
  styleUrls: ['./alert.component.css']
})
export class AlertComponent {
  @Input() message: string;
  @Output() close = new EventEmitter<void>();

  onClose() {
    this.close.emit();
  }
}

```
css
```css
.backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.75);
  z-index: 50;
}

.alert-box {
  position: fixed;
  top: 30vh;
  left: 20vw;
  width: 60vw;
  padding: 16px;
  z-index: 100;
  background: white;
  box-shadow: 0 2px 8px rbga(0, 0, 0, 0.26);
}

.alert-box-actions {
  text-align: right;
}

```
auth.component.html
```html
<app-alert
      [message]="error"
      *ngIf="error"
      (close)="onHandleError()"
    ></app-alert>

```
### 3. Understanding the Different Approaches
![](../root/img/2019-11-30-01-49-08.png)
### 4. Using ngIf
auth.component.ts
```ts
onHandleError() {
    this.error = null;
  }
```
### 5. Preparing Programmatic Creation
auth.component.ts
```ts
error: string = null;
// give angular a ref, a pointer to the place in the DOM
  @ViewChild(PlaceholderDirective, { static: false }) alertHost: PlaceholderDirective;

  private closeSub: Subscription;
constructor(
    private authService: AuthService,
    private router: Router,
    private componentFactoryResolver: ComponentFactoryResolver
  ) {}

private showErrorAlert(message: string) {
    // const alertCmp = new AlertComponent(); =>ts will fail
    // create component for you
    const alertCmpFactory = this.componentFactoryResolver.resolveComponentFactory(
      AlertComponent
    );
    const hostViewContainerRef = this.alertHost.viewContainerRef;
    hostViewContainerRef.clear();

    const componentRef = hostViewContainerRef.createComponent(alertCmpFactory);

    componentRef.instance.message = message;
    this.closeSub = componentRef.instance.close.subscribe(() => {
      this.closeSub.unsubscribe();
      hostViewContainerRef.clear();
    });
  }

// ham onsubmit
errorMessage => {
        console.log(errorMessage);
        this.error = errorMessage;
        // Add
        this.showErrorAlert(errorMessage);
        this.isLoading = false;
      }
```
Tạo placeholder.directive.ts
```ts
import { Directive, ViewContainerRef } from '@angular/core';

@Directive({
  selector: '[appPlaceholder]'
})
export class PlaceholderDirective {
  //inject
  constructor(public viewContainerRef: ViewContainerRef) {}
}

```

### 6. Creating a Component Programmatically
auth.component.html
```html
<ng-template appPlaceholder></ng-template>
```
### 7. Understanding entryComponents
Meet strange error
module
```ts
 bootstrap: [AppComponent],
 // declare without routing and selector
  entryComponents: [
    AlertComponent
  ]
```
auth.component.ts
```ts
// Add closeSub
ngOnDestroy() {
    if (this.closeSub) {
      this.closeSub.unsubscribe();
    }
  }
```
### 8. Data Binding & Event Binding

### 9. Wrap Up

## 22. Angular Modules & Optimizing Angular Apps

### 1. Module Introduction

### 2. What are Modules
![](../root/img/2019-11-30-15-57-21.png)
### 3. Analyzing the AppModule
![](../root/img/2019-11-30-16-08-07.png)

### 4. Getting Started with Feature Modules
Tạo file recipes.module
```ts
@NgModule({
  declarations: [
    RecipesComponent,
    RecipeListComponent,
    RecipeDetailComponent,
    RecipeItemComponent,
    RecipeStartComponent,
    RecipeEditComponent
  ],
  // fix next
  imports: [RouterModule, CommonModule, ReactiveFormsModule],
  exports: [
    RecipesComponent,
    RecipeListComponent,
    RecipeDetailComponent,
    RecipeItemComponent,
    RecipeStartComponent,
    RecipeEditComponent
  ]
})
export class RecipesModule {}

```
vào app
```ts
imports: [
    BrowserModule,
    FormsModule,
    ReactiveFormsModule,
    HttpClientModule,
    AppRoutingModule,
    // Add import
    RecipesModule
  ],

```
CommonModule fix lỗi cho ngIf, ngfor

### 5. Splitting Modules Correctly

### 6. Adding Routes to Feature Modules
create new file, cut from routing to here
recipes-routing.module.ts

```ts
import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';

import { RecipesComponent } from './recipes.component';
import { AuthGuard } from '../auth/auth.guard';
import { RecipeStartComponent } from './recipe-start/recipe-start.component';
import { RecipeEditComponent } from './recipe-edit/recipe-edit.component';
import { RecipeDetailComponent } from './recipe-detail/recipe-detail.component';
import { RecipesResolverService } from './recipes-resolver.service';

const routes: Routes = [
  {
    path: 'recipes',
    component: RecipesComponent,
    canActivate: [AuthGuard],
    children: [
      { path: '', component: RecipeStartComponent },
      { path: 'new', component: RecipeEditComponent },
      {
        path: ':id',
        component: RecipeDetailComponent,
        resolve: [RecipesResolverService]
      },
      {
        path: ':id/edit',
        component: RecipeEditComponent,
        resolve: [RecipesResolverService]
      }
    ]
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class RecipesRoutingModule {}

```

Khai bao trong Module moi
```ts
imports: [
    RouterModule,
    CommonModule,
    ReactiveFormsModule,
    RecipesRoutingModule // add
  ],


```
### 7. Component Declarations
Because using routing recipe internal so you can remove it
```ts
exports: [
    RecipesComponent,
    RecipeListComponent,
    RecipeDetailComponent,
    RecipeItemComponent,
    RecipeStartComponent,
    RecipeEditComponent
  ]
```
### 8. The ShoppingList Feature Module
```ts
@NgModule({
  declarations: [ShoppingListComponent, ShoppingEditComponent],
  imports: [
    FormsModule,
    RouterModule.forChild([
      { path: 'shopping-list', component: ShoppingListComponent },
    ]),
    SharedModule // add next
  ]
})
export class ShoppingListModule {}
// Sau do vao AppModule khai bao
```
### 9. Understanding Shared Modules
shared.module.ts
```ts
import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';

import { AlertComponent } from './alert/alert.component';
import { LoadingSpinnerComponent } from './loading-spinner/loading-spinner.component';
import { PlaceholderDirective } from './placeholder/placeholder.directive';
import { DropdownDirective } from './dropdown.directive';

@NgModule({
  declarations: [
    AlertComponent,
    LoadingSpinnerComponent,
    PlaceholderDirective,
    DropdownDirective
  ],
  imports: [CommonModule],
  exports: [
    AlertComponent,
    LoadingSpinnerComponent,
    PlaceholderDirective,
    DropdownDirective,
    CommonModule
  ],
  entryComponents: [AlertComponent]
})
export class SharedModule {}

```
use in app.modules.ts
### 10. Understanding the Core Module
![](../root/img/2019-11-30-22-56-11.png)
Nen sử dụng @Injectable({ providedIn: 'root' }) thay vì khai báo trong 
app.modules

core.module.ts
```ts
@NgModule({
  providers: [
    ShoppingListService,
    RecipeService,
    {
      provide: HTTP_INTERCEPTORS,
      useClass: AuthInterceptorService,
      multi: true
    }
  ]
})
export class CoreModule {}

```
app.module.ts
```ts
@NgModule({
  declarations: [AppComponent, HeaderComponent, AuthComponent],
  imports: [
    BrowserModule,
    FormsModule,
    ReactiveFormsModule,
    HttpClientModule,
    AppRoutingModule,
    RecipesModule,
    ShoppingListModule,
    SharedModule,
    // Add new
    CoreModule
  ],
```
### 11. Adding an Auth Feature Module
auth.module.ts

```ts
@NgModule({
  declarations: [AuthComponent],
  imports: [
    CommonModule,
    FormsModule,
    RouterModule.forChild([{ path: '', component: AuthComponent }]),
    SharedModule // error loading spiner
  ]
})
export class AuthModule {}

```
### 12. Understanding Lazy Loading
![](../root/img/2019-11-30-23-10-48.png)
Chỉ load những gì mình cần root route content, xóa url ở file con
Khi reload F12 o tab network a bunch of files were downloaded

---
recipes-routing.module.ts
```ts
 path: '', // replace recipes with ''
    component: RecipesComponent,
    canActivate: [AuthGuard]
```

app-routing.module.ts
```ts
const appRoutes: Routes = [
  { path: '', redirectTo: '/recipes', pathMatch: 'full' },
  // Add
  { path: 'recipes', loadChildren: './recipes/recipes.module#RecipesModule' },
  {
    path: 'shopping-list',
    loadChildren: './shopping-list/shopping-list.module#ShoppingListModule'
  },
  {
    path: 'auth',
    loadChildren: './auth/auth.module#AuthModule'
  }
];
 // => only download bunch of code that you need it
```

app.modules
```ts
@NgModule({
  declarations: [AppComponent, HeaderComponent],
  // Delete RecipeModule
  imports: [
    BrowserModule,
    HttpClientModule,
    AppRoutingModule,
    SharedModule,
    CoreModule
  ],
  bootstrap: [AppComponent]
})

```
### 13. Implementing Lazy Loading

### 14. Alternative Lazy Loading Syntax.html
If you're using Angular 8+, you can use an alternative syntax for specifying lazy-loaded routes:

Instead of

```ts
const routes: Routes = [{
  path: 'your-path',
  loadChildren: './your-module-path/module-name.module#ModuleName'
}];

```
you can use

```ts
const routes: Routes = [{
  path: 'your-path',
  loadChildren: () => import('./your-module-path/module-name.module').then(m => m.ModuleName)
}];

```
Please note, that you need to ensure that in your tsconfig.json file, you use

```ts
"module": "esnext",

```
instead of

```ts
"module": "es2015",

```
Why would you use this syntax? In the future, it'll replace the "string-only" approach (i.e. the first alternative mentioned here). It also will give you better IDE support.

### 15. More Lazy Loading
shopping list
Add and delete path in file module.ts
```ts
@NgModule({
  declarations: [ShoppingListComponent, ShoppingEditComponent],
  imports: [
    FormsModule,
    RouterModule.forChild([
      // modify
      { path: '', component: ShoppingListComponent },
    ]),
    SharedModule
  ]
})
export class ShoppingListModule {}
```
app.module.ts
Xoa ShoppingListModule 
### 16. Preloading Lazy-Loaded Code
Avoid delay because internet...
app-routing
```ts
@NgModule({
  imports: [
    RouterModule.forRoot(appRoutes, { preloadingStrategy: PreloadAllModules })
  ],
  exports: [RouterModule]
  // add preloadingStrategy prepare to load
})

```

### 17. Modules & Services
![](../root/img/2019-11-30-23-56-50.png)
### 18. Loading Services Differently
Tạo file logging.service.ts
```ts
import { Injectable } from '@angular/core';

// @Injectable({ providedIn: 'root' })
export class LoggingService {
  lastlog: string;

  printLog(message: string) {
    console.log(message);
    console.log(this.lastlog);
    this.lastlog = message;
  }
}

```
Thêm   // providers: [LoggingService] ở module để test
File shopping list module thì khác instance

### 19. Ahead-of-Time Compilation

### 21. Useful Resources & Links.html


## 23. Deploying an Angular App

### 1. Module Introduction

### 2. Deployment Preparation & Steps

### 3. Using Environment Variables

### 4. Deployment Example Firebase Hosting

### 5. Server Routing vs Browser Routing.html

## 24. Bonus Working with NgRx in our Project

### 1. Module Introduction

### 10. Multiple Actions

### 11. Preparing Update & Delete Actions

### 12. Updating & Deleting Ingredients

### 13. Expanding the State

### 14. Managing More State via NgRx

### 15. Removing Redundant Component State Management

### 16. First Summary & Clean Up

### 17. One Root State

### 18. Setting Up Auth Reducer & Actions

### 19. Dispatching Auth Actions

### 2. What is Application State

### 20. Auth Finished (For Now...)

### 21. And Important Note on Actions

### 22. Exploring NgRx Effects

### 23. Defining the First Effect

### 24. Effects & Error Handling

### 25. Login via NgRx Effects

### 26. Managing UI State in NgRx

### 27. Finishing the Login Effect

### 28. Preparing Other Auth Actions

### 29. Adding Signup

### 3. What is NgRx

### 30. Further Auth Effects

### 31. Adding Auto-Login with NgRx

### 32. Adding Auto-Logout

### 33. Finishing the Auth Effects

### 34. Using the Store Devtools

### 35. The Router Store

### 36. Getting Started with NgRx for Recipes

### 37. Fetching Recipe Detail Data

### 38. Fetching Recipes & Using the Resolver

### 39. Fixing the Auth Redirect

### 4. Getting Started with Reducers

### 40. Update, Delete and Add Recipes

### 41. Storing Recipes via Effects

### 42. Cleanup Work

### 43. Wrap Up

### 44. Useful Resources & Links.html

### 45. MUST READ The [LEGACY] Lectures.html

### 46. [LEGACY] Module Introduction

### 47. [LEGACY] Important Angular 6, RxJS 6 and this section!.html

### 48. [LEGACY] State Challenges

### 49. [LEGACY] Getting Started with Reducers

### 5. Adding Logic to the Reducer

### 50. [LEGACY] Adding Actions

### 51. [LEGACY] Finishing the First Reducer

### 52. [LEGACY] Registering the Application Store

### 53. [LEGACY] Selecting Data from State

### 54. [LEGACY] Dispatch Actions

### 55. [LEGACY] More Actions and Adding Ingredients

### 56. [LEGACY] Dispatching Update and Deleting Shopping List Actions

### 57. [LEGACY] Expanding App State

### 58. [LEGACY] Editing the Shopping-List via NgRx

### 59. [LEGACY] Managing all Relevant State

### 6. Understanding & Adding Actions

### 60. [LEGACY] Authentication and Side Effects - Introduction

### 61. [LEGACY] Setting up the Auth Store Files

### 62. [LEGACY] The Reducer

### 63. [LEGACY] Adding Reducer Logic & Actions

### 64. [LEGACY] Adjusting the App Module Setup

### 65. [LEGACY] Using Authentication

### 66. [LEGACY] Dispatch Actions

### 67. [LEGACY] Getting State Access in Http Interceptor

### 68. [LEGACY] Handling the Auth Token

### 69. [LEGACY] Only React to Actions Once via take(1)

### 7. Setting Up the NgRx Store

### 70. [LEGACY] A Closer Look at Effects

### 71. [LEGACY] Auth Effects and Actions

### 72. [LEGACY] Using NgRx Effects with NgRx = 7.html

### 73. [LEGACY] Effects - How they Work

### 74. [LEGACY] Adding Auth Signup

### 75. [LEGACY] Adding Auth Signin

### 76. [LEGACY] Navigation as a Side Effect

### 77. [LEGACY] Handling Logout via NgRx

### 78. [LEGACY] Additional Fixes

### 79. [LEGACY] Redirecting Upon Logout

### 8. Selecting State

### 80. [LEGACY] What's Next

### 81. [LEGACY] The Router Store Package

### 82. [LEGACY] Store Devtools

### 83. [LEGACY] Lazy Load and Dynamic Injection

### 84. [LEGACY] Adding Recipe Actions

### 85. [LEGACY] Adding Recipe Reducers

### 86. [LEGACY] Dispatching and Selecting State

### 87. [LEGACY] Viewing and Deleting Recipes via NgRx

### 88. [LEGACY] Editing and Updating Recipes via NgRx

### 89. [LEGACY] Recipes Side Effects - Fetching from Server

### 9. Dispatching Actions

### 90. [LEGACY] Recipes Side Effects - Storing Recipes on Server

### 91. [LEGACY] Cleaning Up

### 92. [LEGACY] Updating to RxJS 6+

### 93. [LEGACY] Wrap Up

### 94. [LEGACY] Useful Resources & Links.html

## 25. Bonus Angular Universal

### 1. Module Introduction

### 2. Important Official Docs & Starting Project.html

### 3. Getting Started with Angular Universal

### 4. Working on the App Module

### 5. Adding a Server-Side Build Workflow

### 6. Adding a NodeJS Server

### 7. Pre-Rendering the App on the Server

### 8. Next Steps

### 9. Angular Universal Gotchas.html

## 26. Angular Animations

### 1. Making Animations Work with Angular 4+.html

### 10. Using Keyframes for Animations

### 11. Grouping Transitions

### 12. Using Animation Callbacks

### 2. Introduction

### 3. Setting up the Starting Project

### 4. Animations Triggers and State

### 5. Switching between States

### 6. Transitions

### 7. Advanced Transitions

### 8. Transition Phases

### 9. The void State

## 27. Adding Offline Capabilities with Service Workers

### 1. Module Introduction

### 2. Adding Service Workers

### 3. Caching Assets for Offline Use

### 4. Caching Dynamic Assets & URLs

### 5. Further Links & Resources.html

## 28. A Basic Introduction to Unit Testing in Angular Apps

### 1. About this Section.html

### 10. Isolated vs Non-Isolated Tests

### 11. Further Resources & Where to Go Next.html

### 2. Introduction

### 3. Why Unit Tests

### 4. Analyzing the Testing Setup (as created by the CLI)

### 5. Running Tests (with the CLI)

### 6. Adding a Component and some fitting Tests

### 7. Testing Dependencies Components and Services

### 8. Simulating Async Tasks

### 9. Using fakeAsync and tick

## 29. Angular Changes & New Features

### 1. What's New with Angular 8

### 2. What's New & How to Update.html

## 30. Course Roundup

### 1. Course Roundup

### 2. Bonus More Content!.html

## 31. Custom Project & Workflow Setup

### 1. Introduction

### 10. Finishing & Using the Development Workflow

### 11. Setting up a Production Workflow

### 12. Adding Types & Fixing Bugs

### 13. Finishing Touches

### 2. Initializing the Project

### 3. Setting up the Basic Project Files

### 4. Installing the Core Dependencies

### 5. Filling the Project Files with Some Life

### 6. index.html & Polyfills

### 6. index.html & Polyfills.vtt

### 7. Installing Development Dependencies

### 8. Setting up a Development Workflow

### 9. Updating to Angular 6 + Webpack 4.html

## 32. Bonus TypeScript Introduction (for Angular 2 Usage)

### 1. Introduction

### 2. Using Types

### 3. Classes

### 4. Interfaces

### 5. Generics

### 6. Wrap up & Modules

### 7. Deep dive into TypeScript.html

Angular nghiep
https://www.youtube.com/watch?v=H6IjqFs6Q9o&list=PLJ5qtRQovuENHYHqlQP5XT7zwbCA5Q5He
